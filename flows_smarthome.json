[
    {
        "id": "1c11632f.f206fd",
        "type": "tab",
        "label": "Google Home",
        "disabled": false,
        "info": "# Node-RED Flow Description\r\n\r\nThis document provides a textual representation of a Node-RED flow for converting text to Google Format and sending it to various Google Home devices using the Castv2 protocol.\r\n\r\n## Flow Overview\r\n\r\nThe Node-RED flow consists of multiple components, including subflows, functions, and Castv2 sender nodes. The primary purpose of this flow is to convert text into a format suitable for Google Home devices and then send it to specific devices.\r\n\r\n### Subflow: Convert Text to GoogleFormat\r\n\r\nThis subflow converts text into a format compatible with Google Home devices. It takes an input message containing text and transforms it into a message with the required format. The resulting message includes information such as the application, type, text content, speed, language, and metadata.\r\n\r\n### Main Flow\r\n\r\nThe main flow involves several Castv2 sender nodes connected to different Google Home devices. Each Castv2 sender node is associated with a specific Google Home device and is responsible for sending the formatted text to that device.\r\n\r\n## Flow Diagram\r\n\r\nThe following sequence diagram illustrates the flow of messages in this Node-RED flow:\r\n\r\n```mermaid\r\nsequenceDiagram\r\n    participant User\r\n    participant ConvertText\r\n    participant GoogleHomeDevice\r\n\r\n    User->>ConvertText: Input Text Message\r\n    ConvertText->>ConvertText: Convert Text to GoogleFormat\r\n    ConvertText-->>GoogleHomeDevice: Send Formatted Message"
    },
    {
        "id": "aa0ae7ae.75d228",
        "type": "tab",
        "label": "Lys",
        "disabled": false,
        "info": ""
    },
    {
        "id": "8b99f8fe.7b27b8",
        "type": "tab",
        "label": "Smarthome_MODE",
        "disabled": false,
        "info": ""
    },
    {
        "id": "1b14ec1b.20ab54",
        "type": "tab",
        "label": "Happy (DOG) ",
        "disabled": false,
        "info": ""
    },
    {
        "id": "605ae98f.8a9998",
        "type": "tab",
        "label": "Bedroom",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a7af161f.d5ece8",
        "type": "tab",
        "label": "Deconz Connections",
        "disabled": false,
        "info": ""
    },
    {
        "id": "1c88039c.df631c",
        "type": "tab",
        "label": "Basement",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a9a601907d96eb09",
        "type": "tab",
        "label": "Bathroom",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "81eedfe27e202b5a",
        "type": "tab",
        "label": "Bathroom",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "021cd6ea3e90db93",
        "type": "tab",
        "label": "Stairs",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "15652aa.fd5c4d5",
        "type": "tab",
        "label": "Strøm og Tibber ",
        "disabled": false,
        "info": ""
    },
    {
        "id": "c83f14cc3d9b8395",
        "type": "tab",
        "label": "Remote Content",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "daf28d0f20b236a4",
        "type": "tab",
        "label": "Robot vacuum",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "55bef9f81591ce2e",
        "type": "tab",
        "label": "Node-Red Controll",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "6a77c00f79a19693",
        "type": "tab",
        "label": "Presence Detection",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "2153cce4d74e8cba",
        "type": "tab",
        "label": "FH MQTT",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "19a61e2a.75f152",
        "type": "tab",
        "label": "Tømmekalender",
        "disabled": false,
        "info": ""
    },
    {
        "id": "61f713462b422a81",
        "type": "tab",
        "label": "Dashboard GUI",
        "disabled": false,
        "info": "Error: Request failed with status code 401"
    },
    {
        "id": "visitor_mode_tab",
        "type": "tab",
        "label": "Visitor Mode Scheduler",
        "disabled": false,
        "info": "Scheduled activation and deactivation of visitor mode for vacation house sitter scenario",
        "env": []
    },
    {
        "id": "5f6e89b4b8794e08",
        "type": "tab",
        "label": "TemperatureContorllV2",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "94ff8f0f.02c5a",
        "type": "subflow",
        "name": "Deconz  Movement",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 420,
                "y": 200,
                "wires": [
                    {
                        "id": "a2ca5e419e4f16a4"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1380,
                "y": 200,
                "wires": [
                    {
                        "id": "a2ca5e419e4f16a4",
                        "port": 0
                    },
                    {
                        "id": "d34750618f80b518",
                        "port": 1
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "Name",
                "type": "str",
                "value": "default"
            },
            {
                "name": "ETG",
                "type": "str",
                "value": "1"
            },
            {
                "name": "ignore_state",
                "type": "bool",
                "value": "false"
            }
        ],
        "meta": {},
        "color": "#DDAA99",
        "status": {
            "x": 640,
            "y": 140,
            "wires": [
                {
                    "id": "94ff8f0f.02c5a",
                    "port": 0
                }
            ]
        }
    },
    {
        "id": "5bd36af.4ea5494",
        "type": "subflow",
        "name": "Timer",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 180,
                "y": 180,
                "wires": [
                    {
                        "id": "89e42a76.f6f2f8"
                    },
                    {
                        "id": "64d46e65.a7d2e"
                    },
                    {
                        "id": "2603e6d2.f1973a"
                    },
                    {
                        "id": "cdb73747.3ca6b8"
                    },
                    {
                        "id": "d3ba4ca2.8554d"
                    },
                    {
                        "id": "7e546c3.3eb7794"
                    },
                    {
                        "id": "4bded5f5.5e225c"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1120,
                "y": 200,
                "wires": [
                    {
                        "id": "c907fe20.72aa6",
                        "port": 0
                    },
                    {
                        "id": "10faff0a.197481",
                        "port": 0
                    },
                    {
                        "id": "14bc3937.ad4257",
                        "port": 0
                    },
                    {
                        "id": "ee0cac1c.3b7c3",
                        "port": 0
                    },
                    {
                        "id": "1732dcca.1a2903",
                        "port": 0
                    },
                    {
                        "id": "acc8dc6a.4246f",
                        "port": 0
                    },
                    {
                        "id": "56324a59.cc82b4",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99",
        "status": {
            "x": 1320,
            "y": 240,
            "wires": [
                {
                    "id": "27e86256.4bd24e",
                    "port": 0
                }
            ]
        }
    },
    {
        "id": "c99beb5f.614cb8",
        "type": "subflow",
        "name": "Light Enabeled",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 80,
                "wires": [
                    {
                        "id": "d21593f0.281a6"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 540,
                "y": 80,
                "wires": [
                    {
                        "id": "976640e9.63cfd",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "color": "#DDAA99",
        "status": {
            "x": 580,
            "y": 180,
            "wires": [
                {
                    "id": "4fdcf2d1.2bd64c",
                    "port": 0
                }
            ]
        }
    },
    {
        "id": "c8930ccb.6e912",
        "type": "subflow",
        "name": "Change BTN Color",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 120,
                "wires": [
                    {
                        "id": "dbfcd776.f2b518"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 680,
                "y": 60,
                "wires": [
                    {
                        "id": "a3eda9d235c81ee5",
                        "port": 0
                    }
                ]
            },
            {
                "x": 690,
                "y": 120,
                "wires": [
                    {
                        "id": "03c892d1c9e7927b",
                        "port": 0
                    }
                ]
            },
            {
                "x": 690,
                "y": 180,
                "wires": [
                    {
                        "id": "ac1716b4df2e163a",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99",
        "outputLabels": [
            "ON",
            "OFF",
            "AUTO"
        ]
    },
    {
        "id": "95167fef.b6134",
        "type": "subflow",
        "name": "Lights",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 140,
                "y": 140,
                "wires": [
                    {
                        "id": "e7c7e2aa.37a72"
                    },
                    {
                        "id": "ab9063bb.93cdb"
                    },
                    {
                        "id": "e6f595a8.bbe788"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1740,
                "y": 200,
                "wires": [
                    {
                        "id": "998943e2.e0d0f",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "room",
                "type": "str",
                "value": "room"
            },
            {
                "name": "illumenance",
                "type": "num",
                "value": "200"
            }
        ],
        "color": "#DDAA99",
        "status": {
            "x": 1740,
            "y": 520,
            "wires": [
                {
                    "id": "7c2eceab.3f7bf",
                    "port": 0
                },
                {
                    "id": "d40dbe57.f0a9c",
                    "port": 0
                },
                {
                    "id": "12e98816.16dea8",
                    "port": 0
                },
                {
                    "id": "91a7fb27.153388",
                    "port": 0
                },
                {
                    "id": "7619e08.a8fb32",
                    "port": 0
                },
                {
                    "id": "efc9c5a8.94ff98",
                    "port": 0
                },
                {
                    "id": "4e96a6d5.febc48",
                    "port": 0
                }
            ]
        }
    },
    {
        "id": "beb2c07c77748830",
        "type": "subflow",
        "name": "Subflow 2",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 80,
                "wires": [
                    {
                        "id": "3db5fa316d693b26"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 340,
                "y": 80,
                "wires": [
                    {
                        "id": "3db5fa316d693b26",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "text",
                "type": "str",
                "value": "Default text"
            }
        ],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "c15399232bac2ca3",
        "type": "subflow",
        "name": "Light Controll",
        "info": "",
        "category": "LightControll",
        "in": [
            {
                "x": 80,
                "y": 260,
                "wires": [
                    {
                        "id": "d672dd5902ab9ae0"
                    },
                    {
                        "id": "5e0d8112.7e4fc"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1890,
                "y": 120,
                "wires": [
                    {
                        "id": "2543e4c5.28612c",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "room",
                "type": "str",
                "value": "room"
            },
            {
                "name": "LightTreshold",
                "type": "num",
                "value": "110"
            },
            {
                "name": "delay",
                "type": "num",
                "value": "10",
                "ui": {
                    "icon": "font-awesome/fa-times-circle-o",
                    "label": {
                        "en-US": "Delay Minutes"
                    },
                    "type": "input",
                    "opts": {
                        "types": [
                            "num"
                        ]
                    }
                }
            },
            {
                "name": "useTime",
                "type": "bool",
                "value": "false"
            },
            {
                "name": "startTime",
                "type": "str",
                "value": "06:00"
            },
            {
                "name": "endTime",
                "type": "str",
                "value": "07:00"
            },
            {
                "name": "startTimeWeekend",
                "type": "str",
                "value": "22:00"
            },
            {
                "name": "endTimeWeekend",
                "type": "str",
                "value": "08:00"
            },
            {
                "name": "useWeekend",
                "type": "bool",
                "value": "false"
            }
        ],
        "meta": {},
        "color": "#FFCC66",
        "inputLabels": [
            "Movement"
        ],
        "outputLabels": [
            "set light state"
        ],
        "icon": "node-red/light.svg",
        "status": {
            "x": 1840,
            "y": 640,
            "wires": [
                {
                    "id": "94fa43d7a18c8a2a",
                    "port": 0
                },
                {
                    "id": "d672dd5902ab9ae0",
                    "port": 0
                },
                {
                    "id": "d672dd5902ab9ae0",
                    "port": 1
                },
                {
                    "id": "29f9c1a39ca382a2",
                    "port": 0
                },
                {
                    "id": "853ea5b8d8ea2b6f",
                    "port": 0
                },
                {
                    "id": "655558dcb1297f85",
                    "port": 0
                },
                {
                    "id": "eafc57181190cefc",
                    "port": 0
                }
            ]
        }
    },
    {
        "id": "deda2575970f5ca9",
        "type": "subflow",
        "name": "Convert Text to GoogleFormat",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "3da24c902e74a5dd"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 600,
                "y": 80,
                "wires": [
                    {
                        "id": "949ef7eeffd33778",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "language",
                "type": "str",
                "value": "en"
            }
        ],
        "meta": {},
        "color": "#3FADB5"
    },
    {
        "id": "9fbb2608fbbaf87a",
        "type": "subflow",
        "name": "Set btn color",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 320,
                "y": 180,
                "wires": [
                    {
                        "id": "e3d7434244f5dc5c"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 780,
                "y": 180,
                "wires": [
                    {
                        "id": "9ce931d26a18e856",
                        "port": 0
                    },
                    {
                        "id": "c33c8265cc4368a5",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "presence",
                "type": "str",
                "value": "B-Presence"
            }
        ],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "05933d2d8abb4be7",
        "type": "subflow",
        "name": "Manualmode",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 120,
                "y": 120,
                "wires": [
                    {
                        "id": "0192a61aa7f0df95"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 540,
                "y": 160,
                "wires": [
                    {
                        "id": "0192a61aa7f0df95",
                        "port": 1
                    }
                ]
            },
            {
                "x": 550,
                "y": 100,
                "wires": [
                    {
                        "id": "0192a61aa7f0df95",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99",
        "outputLabels": [
            "NO",
            "YES"
        ]
    },
    {
        "id": "e54013575c240491",
        "type": "subflow",
        "name": "Subflow 3",
        "info": "",
        "in": [],
        "out": []
    },
    {
        "id": "4764ba70f833e4a9",
        "type": "group",
        "z": "aa0ae7ae.75d228",
        "name": "Bedroom",
        "style": {
            "label": true
        },
        "nodes": [
            "50b0d259.df502c",
            "18b93929.bea567",
            "876c799e.859a08",
            "6e1a0143.f51f8",
            "a4afb1bbd79c5da6",
            "d3daac16ab6cdf92",
            "c0a924816dea4ee8",
            "4b0510cde2a3bfff"
        ],
        "x": 124,
        "y": 1159,
        "w": 1002,
        "h": 162
    },
    {
        "id": "a7b26502af3b65e3",
        "type": "group",
        "z": "aa0ae7ae.75d228",
        "name": "Hallway",
        "style": {
            "label": true
        },
        "nodes": [
            "dcf434ce.e89888",
            "b05e450967f5da8d",
            "87d1ce3c19202d34",
            "4ce3539c5f7a0ca7",
            "f9450bda48f83deb",
            "f539323231f77776",
            "b9eed7dde8000c3e",
            "0a13e388cbc5a023"
        ],
        "x": 824,
        "y": 479,
        "w": 682,
        "h": 182
    },
    {
        "id": "172b4292bafc68a7",
        "type": "group",
        "z": "aa0ae7ae.75d228",
        "name": "Basement",
        "style": {
            "label": true
        },
        "nodes": [
            "f66e7e24.aca9d",
            "7a4a01ee.c97e",
            "21c80566.d9201a",
            "183c95c7745f2ea4",
            "6fb6663e779c4bed",
            "bc57e78aaf68965d",
            "2cb600ab1cf6c9f0",
            "df0d0e357f912ecb",
            "53b8c66e905a41c3"
        ],
        "x": 124,
        "y": 939,
        "w": 1202,
        "h": 202
    },
    {
        "id": "ff7ca7f8980ed0b1",
        "type": "group",
        "z": "aa0ae7ae.75d228",
        "name": "Kitchen/Livingroom",
        "style": {
            "label": true
        },
        "nodes": [
            "2cc83436.3fa25c",
            "e2d7c57f5c31b977",
            "be2ad471.d9c448",
            "d17d889454f3d3a1",
            "ca9cda18826d54da",
            "ed863371775575ab",
            "60b2567222677770",
            "a26b85b9381b87e5",
            "c1cdd26489314e43",
            "7b175354f8d58739",
            "a0287f6dea869c13",
            "d434dc021a16f48a"
        ],
        "x": 134,
        "y": 739,
        "w": 1362,
        "h": 182
    },
    {
        "id": "9bb3180dbbe92370",
        "type": "group",
        "z": "021cd6ea3e90db93",
        "name": "Bluetooth group",
        "style": {
            "fill": "#7fb7df",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "23e030a9e19f898b",
            "8981156258330374",
            "711accb21e6923cb",
            "8cd527805b016174",
            "8a70081184fd9d2f",
            "d6258c7d724e2714",
            "915e541148107f9f",
            "7079d27f6152cac0",
            "ae12affc3eb4dc45",
            "1f50ac0d5a21f7ce",
            "277f89239aa44fc7"
        ],
        "x": 474,
        "y": 1339,
        "w": 1112,
        "h": 242
    },
    {
        "id": "e91b0b088ffed19b",
        "type": "group",
        "z": "aa0ae7ae.75d228",
        "name": "Office Light",
        "style": {
            "label": true
        },
        "nodes": [
            "28f356670a5a6dc9",
            "f2e0ac31e202a4e3",
            "ca59d875951bc88c",
            "d3afa1ea39895105",
            "8360c95b413918e1"
        ],
        "x": 144,
        "y": 479,
        "w": 622,
        "h": 142
    },
    {
        "id": "21fab955d3f1b60e",
        "type": "group",
        "z": "1c11632f.f206fd",
        "name": "Google Home",
        "style": {
            "fill": "#7fb7df",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "dd227924.f03a78",
            "15d28c99.680783",
            "50a60792.19b3e8",
            "e1a25373.858cb",
            "8a1f0fa2c013ae33",
            "5cfbdbd83670143c",
            "662ff2faf119d193",
            "d3abaa0d9a3b75d3",
            "278706f49dd302bf",
            "7a81f7e1.38f6f8",
            "0474769cb5224aaa",
            "e0341eb15cd222dc",
            "4bd1b046091aabaf",
            "705040e9aa814bf0",
            "a0b5830a5e5ee232",
            "2018f76d019e4576"
        ],
        "x": 134,
        "y": 99,
        "w": 712,
        "h": 382
    },
    {
        "id": "10af9586a4a889ef",
        "type": "group",
        "z": "55bef9f81591ce2e",
        "name": "Restart Node-Red",
        "style": {
            "label": true
        },
        "nodes": [
            "817f1df1.c5f98",
            "aecb8d48.af66f"
        ],
        "x": 34,
        "y": 51.5,
        "w": 412,
        "h": 97
    },
    {
        "id": "5e9ef91ad1457c49",
        "type": "group",
        "z": "aa0ae7ae.75d228",
        "name": "Set Off Delay",
        "style": {
            "fill": "#ffefbf",
            "label": true
        },
        "nodes": [
            "ed122137.eed21",
            "bd26ed9a.5daa7",
            "69f4a103.cfabb",
            "8d389ebc.22cbb",
            "e578725c1a2aec32",
            "a0e66a252b3dae2e"
        ],
        "x": 134,
        "y": 39,
        "w": 472,
        "h": 202
    },
    {
        "id": "750228718f0f7746",
        "type": "group",
        "z": "aa0ae7ae.75d228",
        "name": "Movement Controll",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "ac728ff70c911726",
            "7284606e.34aff",
            "0ab1d40d25d12428",
            "e17d0a43.b0e048",
            "56a9a0de058b39ee"
        ],
        "x": 764,
        "y": 99,
        "w": 432,
        "h": 122
    },
    {
        "id": "dabbbe0f6cfeecac",
        "type": "group",
        "z": "aa0ae7ae.75d228",
        "name": "Presence",
        "style": {
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "99ed1ce4.90a0c",
            "c825f67d.b5dba8",
            "76c860b3.3a25c",
            "9253d22c.17587",
            "d7f5cfb64ad22ad0",
            "885fc820467d8739"
        ],
        "x": 244,
        "y": 299,
        "w": 352,
        "h": 162
    },
    {
        "id": "8da8f3a9a56fc7ee",
        "type": "group",
        "z": "aa0ae7ae.75d228",
        "name": "Allow/Block Lights",
        "style": {
            "label": true,
            "fill": "#ff7f7f"
        },
        "nodes": [
            "7c9078bb.3bd958",
            "fabdb6a9.b22598",
            "429f76d8.f44498",
            "56d97603.6cdfe8",
            "952977f1.2f4798",
            "ff0e4529.8db608",
            "f2786c6b.d98eb",
            "ef6b84bd.139bb8",
            "f7029354.44404",
            "e54806fb.80a248",
            "1aceef23.4fc291",
            "641555a3.3a90ec",
            "3ceb6365.4b21bc",
            "99bb192c.9613d8",
            "b6d05acd6b922f83",
            "7c376eb857a4e46f"
        ],
        "x": 764,
        "y": 239,
        "w": 882,
        "h": 202
    },
    {
        "id": "f36c921c7f424de5",
        "type": "group",
        "z": "6a77c00f79a19693",
        "name": "To Get device mac, based on known IP",
        "style": {
            "fill": "#bfc7d7",
            "label": true,
            "label-position": "n",
            "color": "#000000"
        },
        "nodes": [
            "f76dc950e201b13c",
            "923123cf470fc3e4",
            "1860791aaa644301"
        ],
        "x": 434,
        "y": 539,
        "w": 432,
        "h": 82
    },
    {
        "id": "58a01d02b4619b46",
        "type": "group",
        "z": "6a77c00f79a19693",
        "name": "Dog Sitter Mode",
        "style": {
            "fill": "#7fb7df",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "38519274c0551bb7",
            "ed4c1dbd7e3c8218",
            "d8cc8d6cd6ac5ca8",
            "77e202e1f7cb4c98",
            "99e34fb7e0972e1e",
            "e4188f47293e43df",
            "6504b75c810f8995",
            "9ab71bb708f19c1b",
            "3fc79d5f33bafedc",
            "2f576cac154fabea",
            "7f851e060826def4",
            "092abfe4f694d244",
            "b6a29855cdae995e",
            "5f39989d186eff71",
            "9bd4ae83dda03a5e",
            "2269200b466aa112",
            "ef6ae4e981532ef3",
            "10e22a1e9cb69adb",
            "fbc0b4b628c8de0f",
            "87845e6165a9844d",
            "bb4c524ddea9d903",
            "cc6d1b5c216b0f73",
            "8a959998326ddd98"
        ],
        "x": 314,
        "y": 19,
        "w": 1252,
        "h": 322
    },
    {
        "id": "12605644788902fd",
        "type": "group",
        "z": "2153cce4d74e8cba",
        "name": "Set Mode FH",
        "style": {
            "label": true
        },
        "nodes": [
            "0890fca55df81357",
            "f7ac0d2fc376810c",
            "e0f3fa373c92533a",
            "4bfb43cc5c725dfa",
            "8d9ebcf8551eea4b",
            "b3f9adc55b666094",
            "f27df5b9f6840243",
            "9a51081d9dca2356",
            "1683544e57ff8fa9",
            "06a76cb3da5742c4"
        ],
        "x": 1854,
        "y": -1,
        "w": 552,
        "h": 202
    },
    {
        "id": "a3172e532d882fe7",
        "type": "group",
        "z": "2153cce4d74e8cba",
        "name": "LIGHTS",
        "style": {
            "label": true
        },
        "nodes": [
            "502f4e884cac3140",
            "2dc40524a1b11e11",
            "feaccb063046e633",
            "e9c6b977279a9ace",
            "36d041fc10d198e1",
            "39f321390ee435bd",
            "a70594b76501cf94",
            "eca75607ec15506a",
            "69f22820e9552291",
            "fc74b8e441ba36bb",
            "da8d02b690681002",
            "3586e46bbd0e53af"
        ],
        "x": 174,
        "y": 659,
        "w": 1352,
        "h": 222
    },
    {
        "id": "90a2ae744f3f1a15",
        "type": "group",
        "z": "2153cce4d74e8cba",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "f6e9c846c1dd7c91",
            "d4a6b225ba8ed179",
            "09f1aab9bbdc8dc3",
            "e39012b8700bad76",
            "e5671f21a115e942",
            "6ad1052a6188fbc4",
            "2544b14f26361464",
            "79e1877f01b1e9dd"
        ],
        "x": 154,
        "y": 179,
        "w": 672,
        "h": 242
    },
    {
        "id": "a498e3e25a476808",
        "type": "group",
        "z": "2153cce4d74e8cba",
        "name": "Movement",
        "style": {
            "fill": "#c8e7a7",
            "label": true
        },
        "nodes": [
            "60b992e02d33fa6b",
            "9b9c69bdb290d6e6",
            "ecf544e90fa509b5",
            "6fe45e94bb1611c0",
            "e9771f214776e51e",
            "87d84f08c959923a",
            "03af9b4d41bd40d1"
        ],
        "x": 174,
        "y": 459,
        "w": 832,
        "h": 162
    },
    {
        "id": "429d0786e75351cd",
        "type": "group",
        "z": "8b99f8fe.7b27b8",
        "name": "SLEEP",
        "style": {
            "fill": "#b797cf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "1329b56.bea634b",
            "55a1471c.7ca3e8",
            "61ee7057.5df1f",
            "fdbf838e.f9e58",
            "e1dcab5a.66f5f8",
            "2e0d79f5.69a796",
            "d1068875.e54d18",
            "c9b7d9c6.2c46e8",
            "477666d4.b53928",
            "73129a34755245fc",
            "f13b82bef847d1cd",
            "ebfc5adc.7672f8",
            "5ca10b6218e10f1a",
            "b3ea9a13d1f2b71d",
            "bba74b7af0063e94",
            "6e2a6b2335a9dc23",
            "772f9c1b8b6b7713",
            "4cb805cbab89b41b"
        ],
        "x": 154,
        "y": 479,
        "w": 1382,
        "h": 282
    },
    {
        "id": "0a0b0609692fe022",
        "type": "group",
        "z": "8b99f8fe.7b27b8",
        "name": "manualmode",
        "style": {
            "fill": "#9363b7",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "e67e0c77.93b2c",
            "07c3245eb0c7f6a4",
            "f2c61516d13e4a6a",
            "8ec3d0adcf1c105a",
            "137603dc312c04a3",
            "9ff137671de44e2d",
            "a834552d0be27f3a"
        ],
        "x": 154,
        "y": 119,
        "w": 652,
        "h": 182
    },
    {
        "id": "0dc9ec7306f46565",
        "type": "group",
        "z": "8b99f8fe.7b27b8",
        "name": "Home&Away",
        "style": {
            "fill": "#3f93cf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "247260f.c82dca",
            "fc4fe81e.444628",
            "1d2eacde.d050c3",
            "3e6914e6.deefec",
            "77b78689.5eac68",
            "a5d3065e.5a0698",
            "29d24b09.012634",
            "dc33a268.a0933",
            "1e1f56fa524173df",
            "9ab9f797bec97d04",
            "4241a94a84740929",
            "8ebc2701b1ba1795",
            "72a46790.043618",
            "9e9814a999c69457",
            "0f55237f3acf03e4",
            "c61133f02b5c38b9",
            "9a32b6d26ea58f65",
            "0f11f6ab1cb7a7dc",
            "aaf5b9532af1fbac",
            "d13df963babc7388",
            "d8ddcd9494c894c6",
            "2d89c6f3277b5730",
            "886397ee88c4a44f"
        ],
        "x": 934,
        "y": -1,
        "w": 1202,
        "h": 382
    },
    {
        "id": "07a89de28d307ce8",
        "type": "group",
        "z": "61f713462b422a81",
        "name": "LightControll",
        "style": {
            "fill": "#ffff7f",
            "label": true
        },
        "nodes": [
            "82d4deea0f5d146b",
            "0a0229165450e20b",
            "be0766449f34157c",
            "2b75c1c39c22e878",
            "3d752044a6901bba",
            "be78e95a54ad258e",
            "b59fc37200ad0559",
            "1063cb701ba3a9ac",
            "d6f63ee6ae47b993",
            "ee0928a7625436ab",
            "d2b50c1ddfab828c",
            "7e5753e9fb0410a3",
            "706c4e8e62a2175f"
        ],
        "x": 1184,
        "y": 119,
        "w": 902,
        "h": 402
    },
    {
        "id": "87210300141eb4cc",
        "type": "group",
        "z": "61f713462b422a81",
        "name": "Tv Status",
        "style": {
            "fill": "#dbcbe7",
            "label": true
        },
        "nodes": [
            "0f8a013e0153fbd5",
            "99923aedde97df0f",
            "0cdeb3068b8c43dc",
            "e747302ab0cd4829",
            "77b0a7f7334d846a"
        ],
        "x": 214,
        "y": 379,
        "w": 512,
        "h": 122
    },
    {
        "id": "a4a9170e6f87bab8",
        "type": "group",
        "z": "61f713462b422a81",
        "name": "Movement",
        "style": {
            "fill": "#3f93cf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "ee65e366a035b490",
            "86476bd49731fa2c",
            "dcc90d5280e1aeb8",
            "1dcdfd1b4bbd46e1",
            "aa0430d69264a383",
            "48ec96b07e81e728",
            "8859702d4e0dda25",
            "32a3ea9d827e0d64",
            "6ad7524469d27c5e",
            "ad963eccab3159c2",
            "54f7718144729c48",
            "1107db891bfcee07",
            "135724c94b4da9e3",
            "014cc1262b6a5534",
            "81fda15dc62d9a91",
            "c3d029127d9b687e",
            "9980b08f3c9badd5"
        ],
        "x": 214,
        "y": 539,
        "w": 632,
        "h": 362
    },
    {
        "id": "0cc1d007b784b6ed",
        "type": "group",
        "z": "61f713462b422a81",
        "name": "Button LIght Controll",
        "style": {
            "fill": "#ffdf7f",
            "label": true
        },
        "nodes": [
            "817926c433169913",
            "e006a76904b60354",
            "51ccf992e760cfb4",
            "aa65f6a826960c6e",
            "38a6473ae1b8cb4d",
            "ec8e67587eb60111",
            "8051cc3693513a78",
            "bbb00f8bf1437a19",
            "f3c851ce3f4bb01f",
            "c55131d2170d2058",
            "48b8d712fc1ea0fb",
            "290b787a2e6cab17",
            "798ec501490403d7",
            "ce96471538f6565a",
            "105bf0cf1d973ec9",
            "126c90c96c81b86b",
            "b83132c1d2f38f5d",
            "6d896087b5e899ac",
            "5db5024050114fe3",
            "8d85a587153a5563",
            "cf21cfba7f910c8f",
            "bdf5318dd87b3dfa",
            "5a5aa2c2317b2730",
            "731a1f20b5c89507",
            "0f094dee2e4348c9",
            "e36e9d4f8caf4e7c",
            "6a2e573bd6e53025",
            "f267683663f2dca9",
            "8ce548c3e4cefcd9"
        ],
        "x": 1134,
        "y": 539,
        "w": 912,
        "h": 582
    },
    {
        "id": "53115130f657b882",
        "type": "group",
        "z": "61f713462b422a81",
        "name": " Status",
        "style": {
            "label": true
        },
        "nodes": [
            "0259d792f5b75f52",
            "9eea7aeb43d074a3",
            "b8d1aea9ca80ad0d",
            "8456ad2c.7b492",
            "2b18f71498965dd7",
            "42dcb01a8a2dd3b0",
            "631efbfdf57fe8fc"
        ],
        "x": 664,
        "y": 99,
        "w": 462,
        "h": 242
    },
    {
        "id": "1f543c3859db0ffb",
        "type": "group",
        "z": "61f713462b422a81",
        "name": "Person Status",
        "style": {
            "fill": "#bfc7d7",
            "label": true
        },
        "nodes": [
            "d871d736.d19838",
            "84abded8.462ac",
            "f4cc46fb.79d698",
            "fe7d3938.a5fd88",
            "5f74b04523ff3784",
            "d80abf17ba04b0a2"
        ],
        "x": 194,
        "y": 119,
        "w": 392,
        "h": 122
    },
    {
        "id": "833beeaf82e34801",
        "type": "group",
        "z": "2153cce4d74e8cba",
        "name": "Change Light State",
        "style": {
            "label": true
        },
        "nodes": [
            "0f1c18c6959cd496",
            "c9f8d6dac8d4ba6d",
            "04b5d65f2356f4ba",
            "3f0facfb8ecb6309",
            "7b748d84badce752",
            "169eb382584dea9a",
            "9b29720688f4f892",
            "5581b9e705bd930b",
            "32b87da33debbea7",
            "fa9eb39dc8d1ab43",
            "57f6d41542bec600",
            "f5414ebf88c0dd29",
            "e8a10173e53f4a16",
            "3e5515ba1d6c857c",
            "935ba8da4c403144",
            "6635faf90a4a38ac",
            "fb7b621287bb03dc",
            "eae7f9bdc1f64e43",
            "0cdeb110cc9cbe87",
            "913fb4c226869e79",
            "fa037bf9c192d1d3",
            "1d5ad1bb7efafd0d",
            "e580148cb6b2ecc0",
            "cf4286d760897c48",
            "56156f4a5dc995ed",
            "9554f5c971a0df0e",
            "8981429cc9d0e3c8",
            "1a7dad7a9bee2cbb",
            "e46130fd001328ba",
            "33feae6a920e0c12",
            "16df02f3eb3587ef",
            "d1864239e50a53f6",
            "910130f6c7a85723",
            "701322a59ecb3a3d",
            "34fedf56c6a998e5",
            "5009a3c5bb74d022"
        ],
        "x": 34,
        "y": 1219,
        "w": 1992,
        "h": 462
    },
    {
        "id": "ba9650ca3526ed06",
        "type": "group",
        "z": "2153cce4d74e8cba",
        "name": "Set Global Mode",
        "style": {
            "label": true
        },
        "nodes": [
            "7461442f9ce7e50e",
            "f6577fe9cc641a4b",
            "655d1a811ae2bfbd",
            "ff4854b4e81f1a8a",
            "5c5afd3abb577912",
            "8ca977fa2d6c3f23",
            "77555cd20a73894f",
            "43e8b3bc5eb993e3",
            "7be94949b0599c5f",
            "312c76cd73591b09",
            "42a4c8da879f2e30"
        ],
        "x": 794,
        "y": 19,
        "w": 1002,
        "h": 142
    },
    {
        "id": "f47df439800601fb",
        "type": "group",
        "z": "5f6e89b4b8794e08",
        "name": "Inputs",
        "style": {
            "fill": "#c8e7a7",
            "label": true
        },
        "nodes": [
            "c5143baa6f42424a",
            "c5312556de1c1814",
            "743270c506954acb",
            "467c6dd614d1b0b2",
            "f931fb38293f9459",
            "5006051d4b49212f",
            "6a5b52aba9f3ece5",
            "cfea2d055c08f19c",
            "9eeb81e767f51acc",
            "1449198c82b3b119",
            "53679c15849cd0c8",
            "06ebc71a4ab3f5f7",
            "52bd0ca5bdbd2508",
            "62f0f4d01db09a70",
            "4f925d17b1ea8d73",
            "d52401a79cb512dd",
            "1869abf7f9728544",
            "74aa829f48fc2100",
            "bb8a6a517e03101b",
            "23a0a23e83bb2272",
            "15d4b4feb7098d7e",
            "1475022137865372",
            "bc012315bdc1402b",
            "89039e1970a0a5d1",
            "cc4503be27c747c6",
            "121734b2adcf737b",
            "4612eef7681e0d1a",
            "9f623d1ae551f25d"
        ],
        "x": 2274,
        "y": 739,
        "w": 1012,
        "h": 362
    },
    {
        "id": "f71cc26218871cfd",
        "type": "group",
        "z": "5f6e89b4b8794e08",
        "name": "BEDTIME",
        "style": {
            "fill": "#0070c0",
            "label": true
        },
        "nodes": [
            "40f942f5d83d58fa",
            "05655572c95c865b",
            "02b52a19fb9a94a8",
            "88b2a7e6a183531d",
            "e649ec85d54ffc64",
            "79507ddcefcbb384",
            "f40935489ff9f776",
            "1eed1292708f5cdc",
            "ce73bb0b0b9d3fe1"
        ],
        "x": 74,
        "y": 1039,
        "w": 822,
        "h": 242
    },
    {
        "id": "450973d0c0bd450b",
        "type": "group",
        "z": "5f6e89b4b8794e08",
        "name": "TV CONTROLL/Shield",
        "style": {
            "label": true
        },
        "nodes": [
            "b14ce65dd4d93e88",
            "38d2ddc12814d3d4",
            "5ac0b196c60ad0dc",
            "b8843fd017841e94",
            "1348ee29e0af4c71",
            "3652a03fbf49da8d",
            "bacc30e8d43df5d6",
            "aab04bacfe6565e6",
            "c27277fd9ecc9863",
            "38e99d1fa9c9fc8d"
        ],
        "x": 1014,
        "y": 819,
        "w": 642,
        "h": 262
    },
    {
        "id": "73335ee4571578d7",
        "type": "group",
        "z": "5f6e89b4b8794e08",
        "name": "Mill OVn",
        "style": {
            "fill": "#ffffff",
            "label": true
        },
        "nodes": [
            "7901c75255cd967d",
            "4b488f47e0f68614",
            "06e536f2bf6e0268",
            "e90cdd3f58fa4665",
            "51fab1af45e1f20e",
            "0ac81ceb0e89f5ed",
            "0d106dc05c444d7d",
            "6b7e4bb182923447",
            "eba3a34ba3d25266"
        ],
        "x": 1044,
        "y": 619,
        "w": 722,
        "h": 182
    },
    {
        "id": "df69d6023cecf206",
        "type": "group",
        "z": "5f6e89b4b8794e08",
        "name": "Modes",
        "style": {
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "8c495f7925e167e4",
            "764b200b3cf0e394",
            "54bc3157303b989c",
            "ea220f9a35ae94f7",
            "f4659f50d862b4c5",
            "00cfb10ade246cfb",
            "59f358e36608bc4a",
            "da2e7da80004f2df",
            "be40615f64952ea5",
            "2b67f1929a03d2e8",
            "e3586fc03b33a4af",
            "7c316b4844045fd5",
            "7f8b8eb11fcf513c",
            "cd17276995992e32"
        ],
        "x": 14,
        "y": 539,
        "w": 1002,
        "h": 262
    },
    {
        "id": "f7fdebd4481aa8ea",
        "type": "group",
        "z": "5f6e89b4b8794e08",
        "name": "Parameters",
        "style": {
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "601ddd0174583052",
            "4cb1f9254274a35d",
            "60cf4012aaea24e4",
            "caab8e5848de50c4",
            "258215825cf08f1e",
            "10442ba043aac34e",
            "0ec58e082421413e",
            "c2b2bf251a83974e",
            "a63ed48c79d99436",
            "9676c78aafc21bfd",
            "338a3e6fe35e806d",
            "457692128ee23e46",
            "785f69e7629bfe8b",
            "195a3609997039ef",
            "aee0f1c4f42880d2",
            "226c751b587383e1",
            "3094a65eb53406e6",
            "75e44db55cd595f3",
            "27eca8d90a2153db"
        ],
        "x": 1114,
        "y": 1139,
        "w": 1062,
        "h": 282
    },
    {
        "id": "aaf5b9532af1fbac",
        "type": "junction",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "x": 1760,
        "y": 260,
        "wires": [
            [
                "fc4fe81e.444628",
                "4241a94a84740929"
            ]
        ]
    },
    {
        "id": "d13df963babc7388",
        "type": "junction",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "x": 1740,
        "y": 140,
        "wires": [
            [
                "247260f.c82dca",
                "29d24b09.012634",
                "8ebc2701b1ba1795"
            ]
        ]
    },
    {
        "id": "3467f3008929627e",
        "type": "junction",
        "z": "19a61e2a.75f152",
        "x": 280,
        "y": 720,
        "wires": [
            [
                "d392f04b755ddf0c"
            ]
        ]
    },
    {
        "id": "f267683663f2dca9",
        "type": "junction",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "x": 1740,
        "y": 880,
        "wires": [
            [
                "f3c851ce3f4bb01f"
            ]
        ]
    },
    {
        "id": "5009a3c5bb74d022",
        "type": "junction",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "x": 1120,
        "y": 1420,
        "wires": [
            [
                "c9f8d6dac8d4ba6d",
                "0f1c18c6959cd496"
            ]
        ]
    },
    {
        "id": "1475022137865372",
        "type": "junction",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "x": 2700,
        "y": 800,
        "wires": [
            [
                "53679c15849cd0c8",
                "6a5b52aba9f3ece5",
                "cfea2d055c08f19c",
                "9eeb81e767f51acc",
                "62f0f4d01db09a70",
                "d52401a79cb512dd",
                "bb8a6a517e03101b",
                "74aa829f48fc2100"
            ]
        ]
    },
    {
        "id": "862863a9.265f3",
        "type": "castv2-connection",
        "name": "Entry",
        "target": "Entryway speaker",
        "host": "",
        "port": "8009"
    },
    {
        "id": "639afec7.a73a3",
        "type": "castv2-connection",
        "name": "",
        "target": "music",
        "host": "",
        "port": "8009"
    },
    {
        "id": "1744610e.18ab3f",
        "type": "castv2-connection",
        "name": "",
        "target": "Stue",
        "host": "",
        "port": "8009"
    },
    {
        "id": "41e681f.e420d8",
        "type": "mqtt-broker",
        "name": "FutureHomeHub",
        "broker": "192.168.1.50",
        "port": "1884",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "compatmode": false,
        "protocolVersion": "5",
        "keepalive": "360",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "4dd42f71.91823",
        "type": "castv2-connection",
        "name": "Kjeller",
        "target": "Basement speaker",
        "host": "",
        "port": "8009"
    },
    {
        "id": "5d47569e31e42f22",
        "type": "mqtt-broker",
        "name": "localhost",
        "broker": "localhost",
        "port": "1884",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "autoUnsubscribe": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "36091c060c8a72d5",
        "type": "castv2-connection",
        "name": "Office",
        "target": "Office speaker",
        "host": "",
        "port": "8009"
    },
    {
        "id": "3d2f09b6c7faaec7",
        "type": "tibber-api-endpoint",
        "queryUrl": "https://api.tibber.com/v1-beta/gql",
        "feedTimeout": "60",
        "name": "Heggland"
    },
    {
        "id": "490ac6e2a74abc7d",
        "type": "global-config",
        "env": []
    },
    {
        "id": "7f0c45a9432dc256",
        "type": "ui-base",
        "name": "UI Base",
        "path": "/dashboard",
        "includeClientData": true,
        "acceptsClientConfig": [
            "ui-control",
            "ui-notification"
        ],
        "showPathInSidebar": false,
        "headerContent": "page",
        "navigationStyle": "default",
        "titleBarStyle": "default",
        "showReconnectNotification": true,
        "notificationDisplayTime": 5,
        "showDisconnectNotification": true,
        "allowInstall": true
    },
    {
        "id": "4d021bd33834978e",
        "type": "castv2-connection",
        "name": "SHIELD",
        "target": "SHIELD",
        "host": "192.168.1.61",
        "port": "8009"
    },
    {
        "id": "8500b44945f22748",
        "type": "sensibo-config",
        "senAPI": "55wTDKNXVkZ5jNpgWv8cafwRNGZR2R"
    },
    {
        "id": "12895ae7.9c6bf5",
        "type": "deconz-server",
        "name": "Gateway",
        "config_version": 1,
        "ip": "localhost",
        "port": "80",
        "ws_port": "443",
        "secure": false,
        "polling": "15"
    },
    {
        "id": "b257c3b61872d5b6",
        "type": "light-scheduler-settings",
        "name": "Home",
        "latitude": "58.8713",
        "longitude": " 5.7168"
    },
    {
        "id": "f8a9cdbf31cc2082",
        "type": "miio-roborock-server",
        "name": "Roborock S7",
        "ip": "192.168.1.188",
        "token": "6e4447635453797766334e624f597566",
        "polling": "30"
    },
    {
        "id": "028d12e70ba38637",
        "type": "ui-theme",
        "name": "Default Theme",
        "colors": {
            "surface": "#ffffff",
            "primary": "#0094CE",
            "bgPage": "#eeeeee",
            "groupBg": "#ffffff",
            "groupOutline": "#cccccc"
        },
        "sizes": {
            "pagePadding": "12px",
            "groupGap": "12px",
            "groupBorderRadius": "4px",
            "widgetGap": "12px"
        }
    },
    {
        "id": "fa9cafe49c4e6dd3",
        "type": "ui-page",
        "name": "Dashboard",
        "ui": "7f0c45a9432dc256",
        "path": "/",
        "icon": "dashboard",
        "layout": "flex",
        "theme": "028d12e70ba38637",
        "order": 2,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "f9c985920afe1003",
        "type": "ui-group",
        "name": "Temperature",
        "page": "fa9cafe49c4e6dd3",
        "width": "4",
        "height": "1",
        "order": 2,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "c8d8b6d992397cb8",
        "type": "server",
        "name": "Home Assistant",
        "version": 6,
        "addon": false,
        "rejectUnauthorizedCerts": true,
        "ha_boolean": [
            "y",
            "yes",
            "true",
            "on",
            "home",
            "open"
        ],
        "connectionDelay": true,
        "cacheJson": true,
        "heartbeat": false,
        "heartbeatInterval": "30",
        "areaSelector": "friendlyName",
        "deviceSelector": "friendlyName",
        "entitySelector": "friendlyName",
        "statusSeparator": ": ",
        "statusYear": "hidden",
        "statusMonth": "short",
        "statusDay": "numeric",
        "statusHourCycle": "default",
        "statusTimeFormat": "h:m",
        "enableGlobalContextStore": false
    },
    {
        "id": "5fe53e8035ad1fab",
        "type": "noraf-config",
        "name": "nora config",
        "group": "Bathroom",
        "twofactor": "off",
        "twofactorpin": "",
        "localexecution": true,
        "structure": "",
        "storeStateInContext": false,
        "disableValidationErrors": false,
        "sendDeviceNameAndLocation": false
    },
    {
        "id": "3f286b473c9966df",
        "type": "ui-group",
        "name": "House",
        "page": "fa9cafe49c4e6dd3",
        "width": "6",
        "height": "1",
        "order": 1,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "e63aca3c0dabe7de",
        "type": "ui-group",
        "name": "SøppelTømming",
        "page": "fa9cafe49c4e6dd3",
        "width": "3",
        "height": "1",
        "order": 3,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "true"
    },
    {
        "id": "205ec56154dae157",
        "type": "ui-group",
        "name": "Kjøkken",
        "page": "fa9cafe49c4e6dd3",
        "width": 3,
        "height": "1",
        "order": 4,
        "showTitle": true,
        "visible": true,
        "disabled": false
    },
    {
        "id": "20e9e3a35362262a",
        "type": "ui-group",
        "name": "Kjellerstue",
        "page": "fa9cafe49c4e6dd3",
        "width": 3,
        "height": "1",
        "order": 5,
        "showTitle": true,
        "visible": true,
        "disabled": false
    },
    {
        "id": "9d9a284bf5ce86d3",
        "type": "ui-group",
        "name": "Office",
        "page": "fa9cafe49c4e6dd3",
        "width": "2",
        "height": "1",
        "order": 7,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "e53a9dd93e589b2e",
        "type": "ui-group",
        "name": "Soverom",
        "page": "fa9cafe49c4e6dd3",
        "width": 3,
        "height": "1",
        "order": 6,
        "showTitle": true,
        "visible": true,
        "disabled": false
    },
    {
        "id": "403670954d105a2d",
        "type": "ui-group",
        "name": "Gang",
        "page": "fa9cafe49c4e6dd3",
        "width": 2,
        "height": "1",
        "order": 9,
        "showTitle": true,
        "visible": true,
        "disabled": false
    },
    {
        "id": "c68075e9d91b3588",
        "type": "ui-group",
        "name": "K-Office",
        "page": "fa9cafe49c4e6dd3",
        "width": 2,
        "height": "1",
        "order": 8,
        "showTitle": true,
        "visible": true,
        "disabled": false
    },
    {
        "id": "1257d664fb2a5f32",
        "type": "ui-group",
        "name": "Bathroom",
        "page": "fa9cafe49c4e6dd3",
        "width": "4",
        "height": "1",
        "order": 10,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false",
        "groupType": "default"
    },
    {
        "id": "2742573c1afc3a9d",
        "type": "ui-group",
        "name": "Closet",
        "page": "fa9cafe49c4e6dd3",
        "width": 2,
        "height": "1",
        "order": 12,
        "showTitle": true,
        "className": "",
        "visible": true,
        "disabled": false
    },
    {
        "id": "2c9e91a26ccc554d",
        "type": "ui-group",
        "name": "Vakserom",
        "page": "fa9cafe49c4e6dd3",
        "width": 2,
        "height": "1",
        "order": 11,
        "showTitle": true,
        "className": "",
        "visible": true,
        "disabled": false
    },
    {
        "id": "5917da18bf053368",
        "type": "yr-config",
        "api": "https://api.met.no/weatherapi/locationforecast/2.0",
        "debug": false
    },
    {
        "id": "0d0d065d61741579",
        "type": "ui-page",
        "name": "Vacation/Away Scheduler",
        "ui": "7f0c45a9432dc256",
        "path": "/scheduler",
        "icon": "home",
        "layout": "grid",
        "theme": "028d12e70ba38637",
        "breakpoints": [
            {
                "name": "Default",
                "px": "0",
                "cols": "3"
            },
            {
                "name": "Tablet",
                "px": "576",
                "cols": "6"
            },
            {
                "name": "Small Desktop",
                "px": "768",
                "cols": "9"
            },
            {
                "name": "Desktop",
                "px": "1024",
                "cols": "12"
            }
        ],
        "order": 1,
        "className": "",
        "visible": "true",
        "disabled": "false"
    },
    {
        "id": "38fdc7977d890ccd",
        "type": "ui-group",
        "name": "Group Name",
        "page": "0d0d065d61741579",
        "width": 6,
        "height": 1,
        "order": 1,
        "showTitle": true,
        "className": "",
        "visible": "true",
        "disabled": "false",
        "groupType": "default"
    },
    {
        "id": "a2ca5e419e4f16a4",
        "type": "switch",
        "z": "94ff8f0f.02c5a",
        "name": "ignore_state",
        "property": "ignore_state",
        "propertyType": "env",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 710,
        "y": 200,
        "wires": [
            [],
            [
                "d34750618f80b518"
            ]
        ]
    },
    {
        "id": "d34750618f80b518",
        "type": "switch",
        "z": "94ff8f0f.02c5a",
        "name": "manualmode?",
        "property": "manualmode",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 880,
        "y": 240,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "2603e6d2.f1973a",
        "type": "time-range-switch",
        "z": "5bd36af.4ea5494",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "10:00",
        "endTime": "16:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 410,
        "y": 200,
        "wires": [
            [
                "14bc3937.ad4257"
            ],
            []
        ]
    },
    {
        "id": "cdb73747.3ca6b8",
        "type": "time-range-switch",
        "z": "5bd36af.4ea5494",
        "name": "Ettermiddag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "16:00",
        "endTime": "19:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 430,
        "y": 240,
        "wires": [
            [
                "ee0cac1c.3b7c3"
            ],
            []
        ]
    },
    {
        "id": "d3ba4ca2.8554d",
        "type": "time-range-switch",
        "z": "5bd36af.4ea5494",
        "name": "Kveld",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "19:00",
        "endTime": "21:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 410,
        "y": 280,
        "wires": [
            [
                "1732dcca.1a2903"
            ],
            []
        ]
    },
    {
        "id": "89e42a76.f6f2f8",
        "type": "time-range-switch",
        "z": "5bd36af.4ea5494",
        "name": "TIdlig Morgen",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:30",
        "endTime": "08:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 440,
        "y": 120,
        "wires": [
            [
                "c907fe20.72aa6"
            ],
            []
        ]
    },
    {
        "id": "64d46e65.a7d2e",
        "type": "time-range-switch",
        "z": "5bd36af.4ea5494",
        "name": "Morgen",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "08:00",
        "endTime": "10:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 420,
        "y": 160,
        "wires": [
            [
                "10faff0a.197481"
            ],
            []
        ]
    },
    {
        "id": "c907fe20.72aa6",
        "type": "change",
        "z": "5bd36af.4ea5494",
        "name": "5 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "300000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "tidlig",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 120,
        "wires": [
            [
                "27e86256.4bd24e"
            ]
        ]
    },
    {
        "id": "1732dcca.1a2903",
        "type": "change",
        "z": "5bd36af.4ea5494",
        "name": "5 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "300000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "kveld",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 280,
        "wires": [
            [
                "27e86256.4bd24e"
            ]
        ]
    },
    {
        "id": "ee0cac1c.3b7c3",
        "type": "change",
        "z": "5bd36af.4ea5494",
        "name": "20 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "1800000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ettermiddag",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 240,
        "wires": [
            [
                "27e86256.4bd24e"
            ]
        ]
    },
    {
        "id": "14bc3937.ad4257",
        "type": "change",
        "z": "5bd36af.4ea5494",
        "name": "5 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "300000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "dag",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 200,
        "wires": [
            [
                "27e86256.4bd24e"
            ]
        ]
    },
    {
        "id": "10faff0a.197481",
        "type": "change",
        "z": "5bd36af.4ea5494",
        "name": "15 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "900000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "morgen",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 160,
        "wires": [
            [
                "27e86256.4bd24e"
            ]
        ]
    },
    {
        "id": "27e86256.4bd24e",
        "type": "change",
        "z": "5bd36af.4ea5494",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "topic",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1180,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "7e546c3.3eb7794",
        "type": "time-range-switch",
        "z": "5bd36af.4ea5494",
        "name": "Sen Kveld",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "21:00",
        "endTime": "23:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 430,
        "y": 320,
        "wires": [
            [
                "acc8dc6a.4246f"
            ],
            []
        ]
    },
    {
        "id": "acc8dc6a.4246f",
        "type": "change",
        "z": "5bd36af.4ea5494",
        "name": "1 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "60000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "sen kveld",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 320,
        "wires": [
            [
                "27e86256.4bd24e"
            ]
        ]
    },
    {
        "id": "4bded5f5.5e225c",
        "type": "time-range-switch",
        "z": "5bd36af.4ea5494",
        "name": "Natt",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "23:00",
        "endTime": "06:30",
        "startOffset": 0,
        "endOffset": 0,
        "x": 410,
        "y": 360,
        "wires": [
            [
                "56324a59.cc82b4"
            ],
            []
        ]
    },
    {
        "id": "56324a59.cc82b4",
        "type": "change",
        "z": "5bd36af.4ea5494",
        "name": "Natt",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "natt",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 360,
        "wires": [
            [
                "27e86256.4bd24e"
            ]
        ]
    },
    {
        "id": "d21593f0.281a6",
        "type": "switch",
        "z": "c99beb5f.614cb8",
        "name": "Light Enabelde",
        "property": "Enabeled",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 200,
        "y": 80,
        "wires": [
            [
                "976640e9.63cfd"
            ],
            [
                "728e655.258b19c"
            ]
        ]
    },
    {
        "id": "976640e9.63cfd",
        "type": "subflow:5bd36af.4ea5494",
        "z": "c99beb5f.614cb8",
        "name": "TID",
        "env": [],
        "x": 410,
        "y": 80,
        "wires": [
            [
                "4fdcf2d1.2bd64c"
            ]
        ]
    },
    {
        "id": "728e655.258b19c",
        "type": "switch",
        "z": "c99beb5f.614cb8",
        "name": "false",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 230,
        "y": 120,
        "wires": [
            [
                "976640e9.63cfd"
            ]
        ]
    },
    {
        "id": "4fdcf2d1.2bd64c",
        "type": "function",
        "z": "c99beb5f.614cb8",
        "name": "",
        "func": "msg.payload = \"Light:\"+ msg.Enabeled +\"  Time:\"+ msg.topic+\"\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 470,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "dbfcd776.f2b518",
        "type": "function",
        "z": "c8930ccb.6e912",
        "name": "",
        "func": "let green = {\"buttonColor\": \"light-green\"};\nlet orange = {\"buttonColor\": \"orange\"};\nlet grey = {\"buttonColor\": \"grey\"};\nlet red = {\"buttonColor\": \"red-darken-1\"};\nswitch(msg.payload) {\n  case true:\n    return [green, grey,grey];\n    \n  case false:\n     return [grey, red,grey];\n   \n   default:\n     return [grey, grey, orange];\n}\n\nreturn msg;",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 160,
        "y": 120,
        "wires": [
            [
                "a3eda9d235c81ee5"
            ],
            [
                "03c892d1c9e7927b"
            ],
            [
                "ac1716b4df2e163a"
            ]
        ],
        "outputLabels": [
            "ON",
            "OFF",
            "AUTO"
        ]
    },
    {
        "id": "a3eda9d235c81ee5",
        "type": "change",
        "z": "c8930ccb.6e912",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ui_update.buttonColor",
                "pt": "msg",
                "to": "buttonColor",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "03c892d1c9e7927b",
        "type": "change",
        "z": "c8930ccb.6e912",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ui_update.buttonColor",
                "pt": "msg",
                "to": "buttonColor",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "ac1716b4df2e163a",
        "type": "change",
        "z": "c8930ccb.6e912",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "ui_update.buttonColor",
                "pt": "msg",
                "to": "buttonColor",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "26870d78.89b472",
        "type": "traffic",
        "z": "95167fef.b6134",
        "name": "Block Light",
        "property_allow": "payload",
        "filter_allow": "GO",
        "ignore_case_allow": false,
        "negate_allow": false,
        "send_allow": false,
        "property_stop": "payload",
        "filter_stop": "stop",
        "ignore_case_stop": true,
        "negate_stop": false,
        "send_stop": false,
        "default_start": true,
        "differ": false,
        "x": 450,
        "y": 180,
        "wires": [
            [
                "13778892.2a0ed7"
            ]
        ]
    },
    {
        "id": "a11a91da.5ad24",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "Reset",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 100,
        "wires": [
            [
                "938ec30b.4297f",
                "fb3a9993.6269b8",
                "91a7fb27.153388"
            ]
        ]
    },
    {
        "id": "938ec30b.4297f",
        "type": "trigger",
        "z": "95167fef.b6134",
        "name": "ON",
        "op1": "true",
        "op2": "",
        "op1type": "bool",
        "op2type": "nul",
        "duration": "0",
        "extend": false,
        "overrideDelay": false,
        "units": "min",
        "reset": "false",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1250,
        "y": 200,
        "wires": [
            [
                "a85cb1de.b2ab"
            ]
        ]
    },
    {
        "id": "fb3a9993.6269b8",
        "type": "trigger",
        "z": "95167fef.b6134",
        "name": "OFF",
        "op1": "",
        "op2": "false",
        "op1type": "nul",
        "op2type": "bool",
        "duration": "5",
        "extend": true,
        "overrideDelay": true,
        "units": "s",
        "reset": "true",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1270,
        "y": 240,
        "wires": [
            [
                "50aa8aad.14fbf4"
            ]
        ]
    },
    {
        "id": "998943e2.e0d0f",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "room",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "room",
                "tot": "env"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1570,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "d9c60a4a.f09e68",
        "type": "time-range-switch",
        "z": "95167fef.b6134",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "10:00",
        "endTime": "16:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 730,
        "y": 400,
        "wires": [
            [
                "26699996.18eb86"
            ],
            [
                "6893d036.80a4c"
            ]
        ]
    },
    {
        "id": "6893d036.80a4c",
        "type": "time-range-switch",
        "z": "95167fef.b6134",
        "name": "Ettermiddag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "16:00",
        "endTime": "20:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 710,
        "y": 440,
        "wires": [
            [
                "983ec0ae.1da1d"
            ],
            [
                "1409254b.a545db",
                "983ec0ae.1da1d"
            ]
        ]
    },
    {
        "id": "1409254b.a545db",
        "type": "time-range-switch",
        "z": "95167fef.b6134",
        "d": true,
        "name": "Kveld",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "20:00",
        "endTime": "21:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 730,
        "y": 480,
        "wires": [
            [
                "74c885f8.41bd8c"
            ],
            [
                "c1a57d04.02dd2",
                "73c4a487.cd543c"
            ]
        ]
    },
    {
        "id": "b2a9199c.b4fc38",
        "type": "time-range-switch",
        "z": "95167fef.b6134",
        "name": "TIdlig Morgen",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:30",
        "endTime": "08:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 700,
        "y": 320,
        "wires": [
            [
                "ba2cd27b.bb893"
            ],
            [
                "353f5328.0939bc"
            ]
        ]
    },
    {
        "id": "353f5328.0939bc",
        "type": "time-range-switch",
        "z": "95167fef.b6134",
        "name": "Morgen",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "08:00",
        "endTime": "10:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 720,
        "y": 360,
        "wires": [
            [
                "160da951.9f50e7"
            ],
            [
                "d9c60a4a.f09e68"
            ]
        ]
    },
    {
        "id": "ba2cd27b.bb893",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "5 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "300000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "tidlig",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 340,
        "wires": [
            [
                "fb3a9993.6269b8",
                "7c2eceab.3f7bf"
            ]
        ]
    },
    {
        "id": "74c885f8.41bd8c",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "5 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "300000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "kveld",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 500,
        "wires": [
            [
                "fb3a9993.6269b8",
                "7c2eceab.3f7bf"
            ]
        ]
    },
    {
        "id": "983ec0ae.1da1d",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "20 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "1800000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "ettermiddag",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 460,
        "wires": [
            [
                "fb3a9993.6269b8",
                "7c2eceab.3f7bf"
            ]
        ]
    },
    {
        "id": "26699996.18eb86",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "5 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "300000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "dag",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 420,
        "wires": [
            [
                "fb3a9993.6269b8",
                "7c2eceab.3f7bf"
            ]
        ]
    },
    {
        "id": "160da951.9f50e7",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "15 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "900000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "morgen",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 380,
        "wires": [
            [
                "fb3a9993.6269b8",
                "7c2eceab.3f7bf"
            ]
        ]
    },
    {
        "id": "73c4a487.cd543c",
        "type": "time-range-switch",
        "z": "95167fef.b6134",
        "d": true,
        "name": "Sen Kveld",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "21:00",
        "endTime": "23:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 730,
        "y": 520,
        "wires": [
            [
                "e147de11.45dc6"
            ],
            []
        ]
    },
    {
        "id": "e147de11.45dc6",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "1 min",
        "rules": [
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "60000",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "sen kveld",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 580,
        "wires": [
            [
                "fb3a9993.6269b8",
                "7c2eceab.3f7bf"
            ]
        ]
    },
    {
        "id": "c1a57d04.02dd2",
        "type": "time-range-switch",
        "z": "95167fef.b6134",
        "d": true,
        "name": "Natt",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "21:00",
        "endTime": "06:30",
        "startOffset": 0,
        "endOffset": 0,
        "x": 730,
        "y": 560,
        "wires": [
            [
                "9a4c1b75.c30428"
            ],
            [
                "e147de11.45dc6"
            ]
        ]
    },
    {
        "id": "9a4c1b75.c30428",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "Natt",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "natt",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "delay",
                "pt": "msg",
                "to": "3000",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 540,
        "wires": [
            [
                "fb3a9993.6269b8",
                "7c2eceab.3f7bf"
            ]
        ]
    },
    {
        "id": "13778892.2a0ed7",
        "type": "switch",
        "z": "95167fef.b6134",
        "name": "Status",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 180,
        "wires": [
            [
                "1320f8a5.4784c7"
            ],
            [
                "49d59fdb.c8f13"
            ]
        ]
    },
    {
        "id": "7c2eceab.3f7bf",
        "type": "function",
        "z": "95167fef.b6134",
        "name": "Status",
        "func": "msg.payload = (msg.delay/60000) + \"Mins\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1390,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "e7c7e2aa.37a72",
        "type": "switch",
        "z": "95167fef.b6134",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "GO",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "STOP",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 350,
        "y": 120,
        "wires": [
            [
                "a11a91da.5ad24"
            ],
            [
                "56f4f77c.b52a78"
            ]
        ]
    },
    {
        "id": "56f4f77c.b52a78",
        "type": "link out",
        "z": "95167fef.b6134",
        "name": "",
        "links": [
            "d40dbe57.f0a9c"
        ],
        "x": 495,
        "y": 120,
        "wires": []
    },
    {
        "id": "d40dbe57.f0a9c",
        "type": "link in",
        "z": "95167fef.b6134",
        "name": "",
        "links": [
            "56f4f77c.b52a78"
        ],
        "x": 1455,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "12e98816.16dea8",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ON",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1570,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "91a7fb27.153388",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Reset",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "ON",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1600,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "93125ad8.268fd8",
        "type": "switch",
        "z": "95167fef.b6134",
        "name": "illumenance",
        "property": "illumenance",
        "propertyType": "flow",
        "rules": [
            {
                "t": "lt",
                "v": "illumenance",
                "vt": "env"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1030,
        "y": 160,
        "wires": [
            [
                "938ec30b.4297f",
                "fb3a9993.6269b8",
                "12e98816.16dea8"
            ],
            [
                "efc9c5a8.94ff98"
            ]
        ]
    },
    {
        "id": "ab9063bb.93cdb",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "set illumenance",
        "rules": [
            {
                "t": "set",
                "p": "illumenance",
                "pt": "flow",
                "to": "illumenance",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 180,
        "wires": [
            [
                "26870d78.89b472"
            ]
        ]
    },
    {
        "id": "e6f595a8.bbe788",
        "type": "switch",
        "z": "95167fef.b6134",
        "name": "",
        "property": "reset",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 350,
        "y": 80,
        "wires": [
            [
                "a11a91da.5ad24"
            ]
        ]
    },
    {
        "id": "49d59fdb.c8f13",
        "type": "time-range-switch",
        "z": "95167fef.b6134",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:00",
        "endTime": "21:30",
        "startOffset": 0,
        "endOffset": 0,
        "x": 730,
        "y": 160,
        "wires": [
            [
                "93125ad8.268fd8"
            ],
            [
                "7619e08.a8fb32",
                "fb3a9993.6269b8"
            ]
        ]
    },
    {
        "id": "7619e08.a8fb32",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "NightTime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1060,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "efc9c5a8.94ff98",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "BRIGHT",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "TO Bright",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1580,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "a85cb1de.b2ab",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "status",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 200,
        "wires": [
            [
                "998943e2.e0d0f"
            ]
        ]
    },
    {
        "id": "50aa8aad.14fbf4",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "status",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 240,
        "wires": [
            [
                "998943e2.e0d0f",
                "4e96a6d5.febc48"
            ]
        ]
    },
    {
        "id": "4e96a6d5.febc48",
        "type": "change",
        "z": "95167fef.b6134",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "OFF",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1570,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "1320f8a5.4784c7",
        "type": "switch",
        "z": "95167fef.b6134",
        "name": "",
        "property": "status",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 730,
        "y": 280,
        "wires": [
            [
                "b2a9199c.b4fc38",
                "938ec30b.4297f"
            ],
            [
                "b2a9199c.b4fc38",
                "938ec30b.4297f"
            ]
        ]
    },
    {
        "id": "3db5fa316d693b26",
        "type": "function",
        "z": "beb2c07c77748830",
        "name": "Connected",
        "func": "\n  \n  \n  \n  msg.payload = {\n    app: \"DefaultMediaReceiver\",\n    type: \"TTS\",\n    text: env.get(\"text\"),\n    speed: 1, // optional to adjust TTS speed, defaults to 1\n    language: \"en\", // optional to set TTS language, default to en\n    metadata: { // optional unless desired, follows normal metadata rules noted above\n      title: \"Media title\"\n    }\n  }\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 190,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "2543e4c5.28612c",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "room",
                "tot": "env"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1720,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "b7abb1c033a236e9",
        "type": "trigger",
        "z": "c15399232bac2ca3",
        "name": "OFF",
        "op1": "",
        "op2": "false",
        "op1type": "nul",
        "op2type": "bool",
        "duration": "15",
        "extend": false,
        "overrideDelay": true,
        "units": "min",
        "reset": "true",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1530,
        "y": 180,
        "wires": [
            [
                "2543e4c5.28612c",
                "853ea5b8d8ea2b6f"
            ]
        ]
    },
    {
        "id": "8d2467ba32ba6f8d",
        "type": "switch",
        "z": "c15399232bac2ca3",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 770,
        "y": 180,
        "wires": [
            [
                "adc5b3cc5fb3acb9"
            ],
            [
                "25b0ce2a287f7a88"
            ]
        ]
    },
    {
        "id": "vm_area_check",
        "type": "function",
        "z": "c15399232bac2ca3",
        "name": "Visitor Mode Area Check",
        "func": "// Check if visitor mode is active and if this room should be restricted\nconst visitorMode = global.get('VisitorMode') || {};\nconst roomName = env.get('room');\n\nif (visitorMode.enabled === true && visitorMode.restrictedAreas) {\n    // Check if current room is in restricted areas\n    const isRestricted = visitorMode.restrictedAreas.some(area => {\n        return roomName.toLowerCase().includes(area.toLowerCase());\n    });\n    \n    if (isRestricted) {\n        // Block automation in restricted areas when visitor mode active\n        node.status({fill: \"yellow\", shape: \"ring\", text: \"Restricted: Visitor Mode\"});\n        return null; // Stop message flow\n    }\n}\n\n// Allow normal operation\nnode.status({});\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 280,
        "wires": [
            [
                "426239f4d97d6c43"
            ]
        ]
    },
    {
        "id": "94fa43d7a18c8a2a",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "state On",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "ON",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1540,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "5c138fa713ff7c90",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "state OFF Countdown",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "OFF Countdown",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 480,
        "wires": [
            [
                "eafc57181190cefc"
            ]
        ]
    },
    {
        "id": "d672dd5902ab9ae0",
        "type": "switch",
        "z": "c15399232bac2ca3",
        "name": "start/stop",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "GO",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "STOP",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 340,
        "y": 580,
        "wires": [
            [
                "096fc2a5f95b7fe3"
            ],
            [
                "096fc2a5f95b7fe3"
            ]
        ]
    },
    {
        "id": "096fc2a5f95b7fe3",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1170,
        "y": 560,
        "wires": [
            [
                "b7abb1c033a236e9",
                "655558dcb1297f85"
            ]
        ]
    },
    {
        "id": "adc5b3cc5fb3acb9",
        "type": "switch",
        "z": "c15399232bac2ca3",
        "name": "LightTreshold ",
        "property": "LightTreshold",
        "propertyType": "env",
        "rules": [
            {
                "t": "eq",
                "v": "ignore",
                "vt": "str"
            },
            {
                "t": "gte",
                "v": "illum",
                "vt": "msg"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 1020,
        "y": 180,
        "wires": [
            [
                "4b6cb34a2d363e76",
                "94fa43d7a18c8a2a",
                "b7abb1c033a236e9"
            ],
            [
                "94fa43d7a18c8a2a",
                "4b6cb34a2d363e76",
                "b7abb1c033a236e9"
            ],
            [
                "29f9c1a39ca382a2",
                "096fc2a5f95b7fe3"
            ]
        ]
    },
    {
        "id": "29f9c1a39ca382a2",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "state Bright",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "To Bright",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1550,
        "y": 260,
        "wires": [
            [
                "1e32fe94992e22fa"
            ]
        ]
    },
    {
        "id": "853ea5b8d8ea2b6f",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "state off",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "OFF",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1540,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "25b0ce2a287f7a88",
        "type": "function",
        "z": "c15399232bac2ca3",
        "name": "delay",
        "func": "msg.delay = env.get(\"delay\") * 60000\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1010,
        "y": 260,
        "wires": [
            [
                "b7abb1c033a236e9",
                "5c138fa713ff7c90"
            ]
        ]
    },
    {
        "id": "4b6cb34a2d363e76",
        "type": "delay",
        "z": "c15399232bac2ca3",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 1520,
        "y": 120,
        "wires": [
            [
                "2543e4c5.28612c"
            ]
        ]
    },
    {
        "id": "1e32fe94992e22fa",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1740,
        "y": 260,
        "wires": [
            [
                "2543e4c5.28612c"
            ]
        ]
    },
    {
        "id": "578a9cae9a7c7128",
        "type": "time-range-switch",
        "z": "c15399232bac2ca3",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "00:00",
        "endTime": "00:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 750,
        "y": 460,
        "wires": [
            [
                "8d2467ba32ba6f8d"
            ],
            [
                "1646b8c2fb984a02"
            ]
        ]
    },
    {
        "id": "a762aa25693819e5",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "set Time",
        "rules": [
            {
                "t": "set",
                "p": "__config.startTime",
                "pt": "msg",
                "to": "startTime",
                "tot": "env"
            },
            {
                "t": "set",
                "p": "__config.endTime",
                "pt": "msg",
                "to": "endTime",
                "tot": "env"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 400,
        "wires": [
            [
                "578a9cae9a7c7128"
            ]
        ]
    },
    {
        "id": "426239f4d97d6c43",
        "type": "switch",
        "z": "c15399232bac2ca3",
        "name": "useTime",
        "property": "useTime",
        "propertyType": "env",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "true"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 580,
        "y": 280,
        "wires": [
            [
                "8d2467ba32ba6f8d"
            ],
            [
                "1646ae11f316bfbe"
            ]
        ]
    },
    {
        "id": "655558dcb1297f85",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "state RESET",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "RESET",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1530,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "eafc57181190cefc",
        "type": "trigger",
        "z": "c15399232bac2ca3",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "5",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1710,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "531b5b804ca44fa5",
        "type": "switch",
        "z": "c15399232bac2ca3",
        "name": "isWeekend",
        "property": "isWeekend",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 570,
        "y": 340,
        "wires": [
            [
                "6833e9065c923388"
            ],
            [
                "a762aa25693819e5"
            ]
        ]
    },
    {
        "id": "6833e9065c923388",
        "type": "change",
        "z": "c15399232bac2ca3",
        "name": "set Time Weekend",
        "rules": [
            {
                "t": "set",
                "p": "__config.startTime",
                "pt": "msg",
                "to": "startTimeWeekend",
                "tot": "env"
            },
            {
                "t": "set",
                "p": "__config.endTime",
                "pt": "msg",
                "to": "endTimeWeekend",
                "tot": "env"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 400,
        "wires": [
            [
                "578a9cae9a7c7128"
            ]
        ]
    },
    {
        "id": "1646ae11f316bfbe",
        "type": "switch",
        "z": "c15399232bac2ca3",
        "name": "useWeekend",
        "property": "useWeekend",
        "propertyType": "env",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 370,
        "y": 340,
        "wires": [
            [
                "531b5b804ca44fa5"
            ],
            [
                "a762aa25693819e5"
            ]
        ]
    },
    {
        "id": "1646b8c2fb984a02",
        "type": "switch",
        "z": "c15399232bac2ca3",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 910,
        "y": 480,
        "wires": [
            [
                "8d2467ba32ba6f8d"
            ]
        ]
    },
    {
        "id": "5e0d8112.7e4fc",
        "type": "traffic",
        "z": "c15399232bac2ca3",
        "name": "btn_block",
        "property_allow": "payload",
        "filter_allow": "go",
        "ignore_case_allow": true,
        "negate_allow": false,
        "send_allow": false,
        "property_stop": "payload",
        "filter_stop": "stop",
        "ignore_case_stop": true,
        "negate_stop": false,
        "send_stop": false,
        "default_start": true,
        "differ": false,
        "x": 180,
        "y": 240,
        "wires": [
            [
                "vm_area_check"
            ]
        ]
    },
    {
        "id": "949ef7eeffd33778",
        "type": "delay",
        "z": "deda2575970f5ca9",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 440,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "3da24c902e74a5dd",
        "type": "function",
        "z": "deda2575970f5ca9",
        "name": "converter",
        "func": "\nif (!msg.language){\n    msg.language = \"en\"\n  }\n  \n  \n  msg.payload = {\n    app: \"DefaultMediaReceiver\",\n    type: \"TTS\",\n    text: msg.text,\n    speed: 1, // optional to adjust TTS speed, defaults to 1\n    language: msg.language, // optional to set TTS language, default to en\n    metadata: { // optional unless desired, follows normal metadata rules noted above\n      title: \"Media title\"\n    }\n  }\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 200,
        "y": 80,
        "wires": [
            [
                "949ef7eeffd33778"
            ]
        ]
    },
    {
        "id": "9ce931d26a18e856",
        "type": "change",
        "z": "9fbb2608fbbaf87a",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "ui_update.buttonColor",
                "pt": "msg",
                "to": "light-green",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "c33c8265cc4368a5",
        "type": "change",
        "z": "9fbb2608fbbaf87a",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "ui_update.buttonColor",
                "pt": "msg",
                "to": "grey",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "e3d7434244f5dc5c",
        "type": "switch",
        "z": "9fbb2608fbbaf87a",
        "name": "Is Presence",
        "property": "${presence}",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 490,
        "y": 180,
        "wires": [
            [
                "9ce931d26a18e856"
            ],
            [
                "c33c8265cc4368a5"
            ]
        ]
    },
    {
        "id": "0192a61aa7f0df95",
        "type": "switch",
        "z": "05933d2d8abb4be7",
        "name": "manualmode?",
        "property": "manualmode",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 310,
        "y": 134,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "dd227924.f03a78",
        "type": "castv2-sender",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "ALLE",
        "connection": "639afec7.a73a3",
        "x": 750,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "15d28c99.680783",
        "type": "link in",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "GH: ALL NON CONVERT",
        "links": [
            "976db23e.1f8ba"
        ],
        "x": 175,
        "y": 140,
        "wires": [
            [
                "dd227924.f03a78"
            ]
        ]
    },
    {
        "id": "50a60792.19b3e8",
        "type": "castv2-sender",
        "z": "1c11632f.f206fd",
        "d": true,
        "g": "21fab955d3f1b60e",
        "name": "OFFICE",
        "connection": "36091c060c8a72d5",
        "x": 760,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "e1a25373.858cb",
        "type": "link in",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "OFFICE",
        "links": [
            "dc33a268.a0933",
            "1a0e8a5610faf0f6",
            "4e6013de2aa5c07f",
            "19242790ba73e3ef"
        ],
        "x": 175,
        "y": 320,
        "wires": [
            [
                "4bd1b046091aabaf"
            ]
        ]
    },
    {
        "id": "8a1f0fa2c013ae33",
        "type": "castv2-sender",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "Stue",
        "connection": "1744610e.18ab3f",
        "x": 770,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "5cfbdbd83670143c",
        "type": "link in",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "GH-STUE-EN",
        "links": [
            "858b8605826bec63",
            "e0f4bc77f36c022a",
            "4cf9b6efdbba67fa",
            "bb4c524ddea9d903",
            "b6a29855cdae995e",
            "a834552d0be27f3a",
            "vm_sched_announce"
        ],
        "x": 175,
        "y": 380,
        "wires": [
            [
                "705040e9aa814bf0"
            ]
        ]
    },
    {
        "id": "662ff2faf119d193",
        "type": "link in",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "ALL GH",
        "links": [
            "9c907e1d118e1133",
            "a84ac6f3a352ff80",
            "f803dc8c9371fd5f",
            "f676af51cded15ca"
        ],
        "x": 175,
        "y": 200,
        "wires": [
            [
                "0474769cb5224aaa"
            ]
        ]
    },
    {
        "id": "d3abaa0d9a3b75d3",
        "type": "castv2-sender",
        "z": "1c11632f.f206fd",
        "d": true,
        "g": "21fab955d3f1b60e",
        "name": "ENTRY",
        "connection": "862863a9.265f3",
        "x": 760,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "278706f49dd302bf",
        "type": "link in",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "Entry",
        "links": [
            "357cd3912cb4b9bf"
        ],
        "x": 175,
        "y": 260,
        "wires": [
            [
                "e0341eb15cd222dc"
            ]
        ]
    },
    {
        "id": "7a81f7e1.38f6f8",
        "type": "castv2-sender",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "Kjeller",
        "connection": "4dd42f71.91823",
        "x": 770,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "0474769cb5224aaa",
        "type": "subflow:deda2575970f5ca9",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "Convert Text to GoogleFormat",
        "x": 450,
        "y": 200,
        "wires": [
            [
                "dd227924.f03a78"
            ]
        ]
    },
    {
        "id": "e0341eb15cd222dc",
        "type": "subflow:deda2575970f5ca9",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "Convert Text to GoogleFormat",
        "x": 450,
        "y": 260,
        "wires": [
            [
                "d3abaa0d9a3b75d3"
            ]
        ]
    },
    {
        "id": "4bd1b046091aabaf",
        "type": "subflow:deda2575970f5ca9",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "Convert Text to GoogleFormat",
        "x": 450,
        "y": 320,
        "wires": [
            [
                "50a60792.19b3e8"
            ]
        ]
    },
    {
        "id": "705040e9aa814bf0",
        "type": "subflow:deda2575970f5ca9",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "Convert Text to GoogleFormat",
        "x": 450,
        "y": 380,
        "wires": [
            [
                "8a1f0fa2c013ae33"
            ]
        ]
    },
    {
        "id": "a0b5830a5e5ee232",
        "type": "subflow:deda2575970f5ca9",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "Convert Text to GoogleFormat",
        "x": 450,
        "y": 440,
        "wires": [
            [
                "7a81f7e1.38f6f8"
            ]
        ]
    },
    {
        "id": "2018f76d019e4576",
        "type": "link in",
        "z": "1c11632f.f206fd",
        "g": "21fab955d3f1b60e",
        "name": "GH-Kjeller-EN",
        "links": [],
        "x": 175,
        "y": 440,
        "wires": [
            [
                "a0b5830a5e5ee232"
            ]
        ]
    },
    {
        "id": "f4f0115853aae717",
        "type": "noraf-light",
        "z": "1c11632f.f206fd",
        "devicename": "mirror",
        "lightcolor": false,
        "brightnesscontrol": true,
        "commandonlycolor": false,
        "turnonwhenbrightnesschanges": false,
        "passthru": false,
        "errorifstateunchaged": false,
        "statepayload": true,
        "brightnessoverride": "",
        "roomhint": "",
        "name": "mirror",
        "colortype": "hsv",
        "nora": "5fe53e8035ad1fab",
        "topic": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "offvalue": "false",
        "offvalueType": "bool",
        "temperaturemin": "2700",
        "temperaturemax": "5500",
        "twofactor": "off",
        "twofactorpin": "",
        "filter": false,
        "x": 510,
        "y": 660,
        "wires": [
            [
                "28b70963f6e11da6"
            ]
        ]
    },
    {
        "id": "28b70963f6e11da6",
        "type": "link out",
        "z": "1c11632f.f206fd",
        "name": "Mirror Light",
        "mode": "link",
        "links": [
            "5663901c264f5e02"
        ],
        "x": 665,
        "y": 660,
        "wires": []
    },
    {
        "id": "6e1a0143.f51f8",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "4764ba70f833e4a9",
        "name": "",
        "mode": "link",
        "links": [],
        "x": 1085,
        "y": 1200,
        "wires": []
    },
    {
        "id": "dcf434ce.e89888",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "a7b26502af3b65e3",
        "name": "Movement Hall",
        "links": [
            "328ec247.9e5eee"
        ],
        "x": 865,
        "y": 560,
        "wires": [
            [
                "f539323231f77776",
                "b05e450967f5da8d"
            ]
        ]
    },
    {
        "id": "f66e7e24.aca9d",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "172b4292bafc68a7",
        "name": "Movement Nede",
        "links": [
            "87d84f08c959923a",
            "dc7a9dbe.e7065",
            "e92f253c.11b9b8"
        ],
        "x": 165,
        "y": 1040,
        "wires": [
            [
                "6fb6663e779c4bed"
            ]
        ]
    },
    {
        "id": "99ed1ce4.90a0c",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "dabbbe0f6cfeecac",
        "name": "Set Upstairs lights ",
        "links": [],
        "x": 285,
        "y": 340,
        "wires": [
            [
                "9253d22c.17587"
            ]
        ]
    },
    {
        "id": "c825f67d.b5dba8",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "dabbbe0f6cfeecac",
        "name": "set-downstaris lights",
        "links": [],
        "x": 285,
        "y": 380,
        "wires": [
            [
                "76c860b3.3a25c"
            ]
        ]
    },
    {
        "id": "7c9078bb.3bd958",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "Basemet Reset",
        "links": [
            "7a4a01ee.c97e"
        ],
        "x": 1605,
        "y": 360,
        "wires": []
    },
    {
        "id": "fabdb6a9.b22598",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "btn_upstairs",
        "links": [
            "bbb00f8bf1437a19"
        ],
        "x": 805,
        "y": 320,
        "wires": [
            [
                "952977f1.2f4798"
            ]
        ]
    },
    {
        "id": "429f76d8.f44498",
        "type": "switch",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "Command",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "Auto",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1090,
        "y": 360,
        "wires": [
            [
                "f2786c6b.d98eb"
            ],
            [
                "ef6b84bd.139bb8",
                "99bb192c.9613d8"
            ]
        ]
    },
    {
        "id": "56d97603.6cdfe8",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "btn_downstairs",
        "links": [
            "f3c851ce3f4bb01f"
        ],
        "x": 805,
        "y": 360,
        "wires": [
            [
                "ff0e4529.8db608"
            ]
        ]
    },
    {
        "id": "76c860b3.3a25c",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "dabbbe0f6cfeecac",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "B_illumenance",
                "pt": "flow",
                "to": "payload.illuminance",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "952977f1.2f4798",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "upstairs",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "KJØKKEN",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 910,
        "y": 320,
        "wires": [
            [
                "429f76d8.f44498"
            ]
        ]
    },
    {
        "id": "ff0e4529.8db608",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "basement",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "K-LYS",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 910,
        "y": 360,
        "wires": [
            [
                "429f76d8.f44498"
            ]
        ]
    },
    {
        "id": "f2786c6b.d98eb",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "GO",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "GO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 320,
        "wires": [
            [
                "3ceb6365.4b21bc"
            ]
        ]
    },
    {
        "id": "ef6b84bd.139bb8",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "STOP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "STOP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 400,
        "wires": [
            [
                "3ceb6365.4b21bc"
            ]
        ]
    },
    {
        "id": "50b0d259.df502c",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "4764ba70f833e4a9",
        "name": "Movement Soverom",
        "links": [
            "9ace10c4.4ce8f"
        ],
        "x": 165,
        "y": 1200,
        "wires": [
            [
                "876c799e.859a08"
            ]
        ]
    },
    {
        "id": "f7029354.44404",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "Bedroom Reset",
        "links": [],
        "x": 1605,
        "y": 400,
        "wires": []
    },
    {
        "id": "e54806fb.80a248",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "bedroom",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "S-LYS",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 910,
        "y": 400,
        "wires": [
            [
                "429f76d8.f44498"
            ]
        ]
    },
    {
        "id": "1aceef23.4fc291",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "btn_Bedroom",
        "links": [],
        "x": 805,
        "y": 400,
        "wires": [
            [
                "e54806fb.80a248"
            ]
        ]
    },
    {
        "id": "641555a3.3a90ec",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "Upstairs block",
        "links": [
            "2cc83436.3fa25c"
        ],
        "x": 1605,
        "y": 320,
        "wires": []
    },
    {
        "id": "3ceb6365.4b21bc",
        "type": "switch",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "Room",
        "property": "room",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "KJØKKEN",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "K-LYS",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "S-LYS",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": true,
        "outputs": 3,
        "x": 1430,
        "y": 360,
        "wires": [
            [
                "641555a3.3a90ec"
            ],
            [
                "7c9078bb.3bd958"
            ],
            [
                "f7029354.44404"
            ]
        ]
    },
    {
        "id": "e17d0a43.b0e048",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "750228718f0f7746",
        "name": "RESET lights",
        "links": [
            "247260f.c82dca",
            "fc4fe81e.444628",
            "a0e66a252b3dae2e"
        ],
        "x": 805,
        "y": 140,
        "wires": [
            [
                "7284606e.34aff"
            ]
        ]
    },
    {
        "id": "9253d22c.17587",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "dabbbe0f6cfeecac",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "U_illumenance",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "18b93929.bea567",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "4764ba70f833e4a9",
        "name": "STOP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "STOP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 900,
        "y": 1280,
        "wires": [
            [
                "a4afb1bbd79c5da6"
            ]
        ]
    },
    {
        "id": "876c799e.859a08",
        "type": "time-range-switch",
        "z": "aa0ae7ae.75d228",
        "g": "4764ba70f833e4a9",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "10:00",
        "endTime": "20:30",
        "startOffset": 0,
        "endOffset": 0,
        "x": 420,
        "y": 1200,
        "wires": [
            [
                "a4afb1bbd79c5da6",
                "c0a924816dea4ee8"
            ],
            [
                "4b0510cde2a3bfff"
            ]
        ]
    },
    {
        "id": "7284606e.34aff",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "750228718f0f7746",
        "name": "Reset",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "GO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 910,
        "y": 140,
        "wires": [
            [
                "ac728ff70c911726"
            ]
        ]
    },
    {
        "id": "21c80566.d9201a",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "172b4292bafc68a7",
        "name": "",
        "mode": "link",
        "links": [
            "e8a10173e53f4a16"
        ],
        "x": 1285,
        "y": 1020,
        "wires": []
    },
    {
        "id": "7a4a01ee.c97e",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "172b4292bafc68a7",
        "name": "btn:block D",
        "links": [
            "7c9078bb.3bd958"
        ],
        "x": 715,
        "y": 980,
        "wires": [
            [
                "183c95c7745f2ea4"
            ]
        ]
    },
    {
        "id": "99bb192c.9613d8",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "",
        "mode": "link",
        "links": [
            "e8a10173e53f4a16"
        ],
        "x": 1245,
        "y": 360,
        "wires": []
    },
    {
        "id": "b05e450967f5da8d",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "a7b26502af3b65e3",
        "name": "HA-Presence",
        "rules": [
            {
                "t": "set",
                "p": "HA-Presence",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 560,
        "wires": [
            [
                "4ce3539c5f7a0ca7"
            ]
        ]
    },
    {
        "id": "4d0ae664b9906d7d",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 3090,
        "y": 2120,
        "wires": [
            []
        ]
    },
    {
        "id": "87d1ce3c19202d34",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "a7b26502af3b65e3",
        "name": "",
        "mode": "link",
        "links": [
            "e8a10173e53f4a16"
        ],
        "x": 1465,
        "y": 560,
        "wires": []
    },
    {
        "id": "2cc83436.3fa25c",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "",
        "links": [
            "641555a3.3a90ec"
        ],
        "x": 1085,
        "y": 820,
        "wires": [
            [
                "d17d889454f3d3a1"
            ]
        ]
    },
    {
        "id": "e2d7c57f5c31b977",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "",
        "mode": "link",
        "links": [
            "e8a10173e53f4a16"
        ],
        "x": 1455,
        "y": 880,
        "wires": []
    },
    {
        "id": "be2ad471.d9c448",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "Movement oppe",
        "links": [
            "bc76c6da083bdd3b"
        ],
        "x": 175,
        "y": 880,
        "wires": [
            [
                "a26b85b9381b87e5",
                "c1cdd26489314e43"
            ]
        ]
    },
    {
        "id": "d17d889454f3d3a1",
        "type": "subflow:c15399232bac2ca3",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "",
        "env": [
            {
                "name": "room",
                "value": "KJØKKEN",
                "type": "str"
            },
            {
                "name": "LightTreshold",
                "value": "150",
                "type": "num"
            }
        ],
        "x": 1190,
        "y": 880,
        "wires": [
            [
                "e2d7c57f5c31b977"
            ]
        ]
    },
    {
        "id": "ca9cda18826d54da",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "illum",
                "pt": "msg",
                "to": "U_illumenance",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 870,
        "y": 880,
        "wires": [
            [
                "d17d889454f3d3a1"
            ]
        ]
    },
    {
        "id": "ed863371775575ab",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "ST-presence",
        "rules": [
            {
                "t": "set",
                "p": "ST-presence",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 880,
        "wires": [
            [
                "ca9cda18826d54da"
            ]
        ]
    },
    {
        "id": "183c95c7745f2ea4",
        "type": "subflow:c15399232bac2ca3",
        "z": "aa0ae7ae.75d228",
        "g": "172b4292bafc68a7",
        "name": "",
        "env": [
            {
                "name": "room",
                "value": "K-LYS",
                "type": "str"
            },
            {
                "name": "LightTreshold",
                "value": "ignore",
                "type": "str"
            },
            {
                "name": "delay",
                "value": "2",
                "type": "num"
            },
            {
                "name": "useTime",
                "value": "true",
                "type": "bool"
            },
            {
                "name": "startTime",
                "value": "08:00",
                "type": "str"
            },
            {
                "name": "endTime",
                "value": "21:30",
                "type": "str"
            },
            {
                "name": "startTimeWeekend",
                "value": "09:00",
                "type": "str"
            },
            {
                "name": "endTimeWeekend",
                "value": "22:00",
                "type": "str"
            },
            {
                "name": "useWeekend",
                "value": "true",
                "type": "bool"
            }
        ],
        "x": 1110,
        "y": 1020,
        "wires": [
            [
                "21c80566.d9201a"
            ]
        ]
    },
    {
        "id": "4ce3539c5f7a0ca7",
        "type": "subflow:c15399232bac2ca3",
        "z": "aa0ae7ae.75d228",
        "g": "a7b26502af3b65e3",
        "name": "",
        "env": [
            {
                "name": "room",
                "value": "G-LYS",
                "type": "str"
            },
            {
                "name": "LightTreshold",
                "value": "ignore",
                "type": "str"
            },
            {
                "name": "delay",
                "value": "6",
                "type": "num"
            }
        ],
        "x": 1340,
        "y": 560,
        "wires": [
            [
                "87d1ce3c19202d34"
            ]
        ]
    },
    {
        "id": "a4afb1bbd79c5da6",
        "type": "subflow:c15399232bac2ca3",
        "z": "aa0ae7ae.75d228",
        "g": "4764ba70f833e4a9",
        "name": "",
        "env": [
            {
                "name": "room",
                "value": "S-LYS",
                "type": "str"
            },
            {
                "name": "LightTreshold",
                "value": "ignore",
                "type": "str"
            },
            {
                "name": "delay",
                "value": "30",
                "type": "num"
            }
        ],
        "x": 940,
        "y": 1200,
        "wires": [
            [
                "6e1a0143.f51f8"
            ]
        ]
    },
    {
        "id": "d3daac16ab6cdf92",
        "type": "trigger",
        "z": "aa0ae7ae.75d228",
        "g": "4764ba70f833e4a9",
        "name": "ONCE",
        "op1": "true",
        "op2": "0",
        "op1type": "bool",
        "op2type": "str",
        "duration": "0",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 740,
        "y": 1280,
        "wires": [
            [
                "18b93929.bea567",
                "a4afb1bbd79c5da6"
            ]
        ]
    },
    {
        "id": "c0a924816dea4ee8",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "4764ba70f833e4a9",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "START",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 1260,
        "wires": [
            [
                "d3daac16ab6cdf92",
                "a4afb1bbd79c5da6"
            ]
        ]
    },
    {
        "id": "f9450bda48f83deb",
        "type": "switch",
        "z": "aa0ae7ae.75d228",
        "g": "a7b26502af3b65e3",
        "name": "is away",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "away",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 1130,
        "y": 620,
        "wires": [
            [
                "b9eed7dde8000c3e"
            ]
        ]
    },
    {
        "id": "f539323231f77776",
        "type": "switch",
        "z": "aa0ae7ae.75d228",
        "g": "a7b26502af3b65e3",
        "name": "Movement",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 980,
        "y": 620,
        "wires": [
            [
                "f9450bda48f83deb"
            ]
        ]
    },
    {
        "id": "b9eed7dde8000c3e",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "a7b26502af3b65e3",
        "name": "",
        "mode": "link",
        "links": [
            "60b2567222677770",
            "e8a10173e53f4a16"
        ],
        "x": 1235,
        "y": 620,
        "wires": []
    },
    {
        "id": "28f356670a5a6dc9",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "e91b0b088ffed19b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "O-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "movement",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "change",
                "p": "movement",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "on",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "movement",
                "pt": "msg",
                "from": "false",
                "fromt": "bool",
                "to": "off",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 520,
        "wires": [
            [
                "d3afa1ea39895105"
            ]
        ]
    },
    {
        "id": "f2e0ac31e202a4e3",
        "type": "subflow:c15399232bac2ca3",
        "z": "aa0ae7ae.75d228",
        "g": "e91b0b088ffed19b",
        "name": "O-LYS",
        "env": [
            {
                "name": "room",
                "value": "O-LYS",
                "type": "str"
            },
            {
                "name": "LightTreshold",
                "value": "ignore",
                "type": "str"
            },
            {
                "name": "delay",
                "value": "20",
                "type": "num"
            }
        ],
        "x": 330,
        "y": 520,
        "wires": [
            [
                "28f356670a5a6dc9"
            ]
        ]
    },
    {
        "id": "ca59d875951bc88c",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "e91b0b088ffed19b",
        "name": "O-LYS",
        "links": [
            "b526ea173bec8f67"
        ],
        "x": 185,
        "y": 520,
        "wires": [
            [
                "8360c95b413918e1"
            ]
        ]
    },
    {
        "id": "d3afa1ea39895105",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "e91b0b088ffed19b",
        "name": "O-LYS",
        "mode": "link",
        "links": [
            "e8a10173e53f4a16"
        ],
        "x": 725,
        "y": 520,
        "wires": []
    },
    {
        "id": "8360c95b413918e1",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "e91b0b088ffed19b",
        "name": "O-presence:T",
        "rules": [
            {
                "t": "set",
                "p": "O-presence",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 580,
        "wires": [
            [
                "f2e0ac31e202a4e3"
            ]
        ]
    },
    {
        "id": "4b0510cde2a3bfff",
        "type": "time-range-switch",
        "z": "aa0ae7ae.75d228",
        "g": "4764ba70f833e4a9",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "20:00",
        "endTime": "23:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 580,
        "y": 1220,
        "wires": [
            [
                "d3daac16ab6cdf92"
            ],
            []
        ]
    },
    {
        "id": "6fb6663e779c4bed",
        "type": "switch",
        "z": "aa0ae7ae.75d228",
        "g": "172b4292bafc68a7",
        "name": "is basement",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "m_basement",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "m_basement_stairs",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Bathroom",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Trapp",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 320,
        "y": 1040,
        "wires": [
            [
                "bc57e78aaf68965d"
            ],
            [
                "bc57e78aaf68965d"
            ],
            [
                "bc57e78aaf68965d"
            ],
            [
                "bc57e78aaf68965d"
            ]
        ]
    },
    {
        "id": "0a13e388cbc5a023",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "a7b26502af3b65e3",
        "name": "btn:block D",
        "links": [],
        "x": 1175,
        "y": 520,
        "wires": [
            [
                "4ce3539c5f7a0ca7"
            ]
        ]
    },
    {
        "id": "0ab1d40d25d12428",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "750228718f0f7746",
        "name": "STOP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "STOP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 910,
        "y": 180,
        "wires": [
            [
                "ac728ff70c911726"
            ]
        ]
    },
    {
        "id": "56a9a0de058b39ee",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "d": true,
        "g": "750228718f0f7746",
        "name": "Block LIght",
        "links": [],
        "x": 805,
        "y": 180,
        "wires": [
            [
                "0ab1d40d25d12428"
            ]
        ]
    },
    {
        "id": "b6d05acd6b922f83",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "Upstairs_block:controll",
        "links": [
            "ac728ff70c911726"
        ],
        "x": 1455,
        "y": 280,
        "wires": [
            [
                "641555a3.3a90ec"
            ]
        ]
    },
    {
        "id": "d7f5cfb64ad22ad0",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "dabbbe0f6cfeecac",
        "name": "KO-presence:T",
        "rules": [
            {
                "t": "set",
                "p": "KO-presence",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "885fc820467d8739",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "dabbbe0f6cfeecac",
        "name": "Karina OF HUE",
        "links": [],
        "x": 285,
        "y": 420,
        "wires": [
            [
                "d7f5cfb64ad22ad0"
            ]
        ]
    },
    {
        "id": "ed122137.eed21",
        "type": "inject",
        "z": "aa0ae7ae.75d228",
        "g": "5e9ef91ad1457c49",
        "name": "MORNING",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "ondimm",
                "v": "60",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "00 06 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "900000",
        "payloadType": "num",
        "x": 250,
        "y": 80,
        "wires": [
            [
                "69f4a103.cfabb"
            ]
        ]
    },
    {
        "id": "bd26ed9a.5daa7",
        "type": "inject",
        "z": "aa0ae7ae.75d228",
        "g": "5e9ef91ad1457c49",
        "name": "NIGHT",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "ondimm",
                "v": "35",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "00 20 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "300000",
        "payloadType": "num",
        "x": 240,
        "y": 160,
        "wires": [
            [
                "69f4a103.cfabb"
            ]
        ]
    },
    {
        "id": "69f4a103.cfabb",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "5e9ef91ad1457c49",
        "name": "Set offdelay",
        "rules": [
            {
                "t": "set",
                "p": "offdelay",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "ondimm",
                "pt": "flow",
                "to": "ondimm",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 140,
        "wires": [
            [
                "a0e66a252b3dae2e"
            ]
        ]
    },
    {
        "id": "8d389ebc.22cbb",
        "type": "inject",
        "z": "aa0ae7ae.75d228",
        "g": "5e9ef91ad1457c49",
        "name": "NOON",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "ondimm",
                "v": "100",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "00 12 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "900000",
        "payloadType": "num",
        "x": 240,
        "y": 120,
        "wires": [
            [
                "69f4a103.cfabb"
            ]
        ]
    },
    {
        "id": "e578725c1a2aec32",
        "type": "inject",
        "z": "aa0ae7ae.75d228",
        "g": "5e9ef91ad1457c49",
        "name": "STARTUP",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "ondimm",
                "v": "100",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "20",
        "topic": "",
        "payload": "900000",
        "payloadType": "num",
        "x": 250,
        "y": 200,
        "wires": [
            [
                "69f4a103.cfabb"
            ]
        ]
    },
    {
        "id": "bc57e78aaf68965d",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "172b4292bafc68a7",
        "name": "B-Presence",
        "rules": [
            {
                "t": "set",
                "p": "B-Presence",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 660,
        "y": 1040,
        "wires": [
            [
                "2cb600ab1cf6c9f0"
            ]
        ]
    },
    {
        "id": "a0e66a252b3dae2e",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "5e9ef91ad1457c49",
        "name": "link out 7",
        "mode": "link",
        "links": [
            "e17d0a43.b0e048"
        ],
        "x": 565,
        "y": 140,
        "wires": []
    },
    {
        "id": "ac728ff70c911726",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "g": "750228718f0f7746",
        "name": "link out 8",
        "mode": "link",
        "links": [
            "b6d05acd6b922f83",
            "7c376eb857a4e46f"
        ],
        "x": 1155,
        "y": 160,
        "wires": []
    },
    {
        "id": "a322e5db270d2e0b",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "name": "laundry",
        "links": [
            "5cb449a017a68b38"
        ],
        "x": 235,
        "y": 1340,
        "wires": [
            [
                "8144b7c822b84b76"
            ]
        ]
    },
    {
        "id": "8144b7c822b84b76",
        "type": "subflow:c15399232bac2ca3",
        "z": "aa0ae7ae.75d228",
        "name": "laundry",
        "env": [
            {
                "name": "room",
                "value": "laundry",
                "type": "str"
            },
            {
                "name": "LightTreshold",
                "value": "ignore",
                "type": "str"
            },
            {
                "name": "delay",
                "value": "3",
                "type": "num"
            }
        ],
        "x": 360,
        "y": 1340,
        "wires": [
            [
                "8bc1a1a00cecc7a6"
            ]
        ]
    },
    {
        "id": "8bc1a1a00cecc7a6",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "name": "",
        "mode": "link",
        "links": [
            "e8a10173e53f4a16"
        ],
        "x": 525,
        "y": 1340,
        "wires": []
    },
    {
        "id": "8e5562ea8e31b7b3",
        "type": "subflow:c15399232bac2ca3",
        "z": "aa0ae7ae.75d228",
        "name": "walkingCloset",
        "env": [
            {
                "name": "room",
                "value": "walkingCloset",
                "type": "str"
            },
            {
                "name": "LightTreshold",
                "value": "ignore",
                "type": "str"
            },
            {
                "name": "delay",
                "value": "5",
                "type": "num"
            }
        ],
        "x": 380,
        "y": 1400,
        "wires": [
            [
                "1deeab2413b7a99b"
            ]
        ]
    },
    {
        "id": "89ad14e36c74d6f8",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "name": "walkingCloset",
        "links": [
            "5db3412dac700df1"
        ],
        "x": 235,
        "y": 1400,
        "wires": [
            [
                "8e5562ea8e31b7b3"
            ]
        ]
    },
    {
        "id": "1deeab2413b7a99b",
        "type": "link out",
        "z": "aa0ae7ae.75d228",
        "name": "",
        "mode": "link",
        "links": [
            "e8a10173e53f4a16"
        ],
        "x": 525,
        "y": 1400,
        "wires": []
    },
    {
        "id": "60b2567222677770",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "Movement oppe",
        "links": [
            "63e9f9b.1d13608",
            "b9eed7dde8000c3e"
        ],
        "x": 335,
        "y": 840,
        "wires": [
            [
                "7b175354f8d58739"
            ]
        ]
    },
    {
        "id": "a26b85b9381b87e5",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "FP2Movement",
        "rules": [
            {
                "t": "set",
                "p": "FP2Movement",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 800,
        "wires": [
            [
                "d434dc021a16f48a"
            ]
        ]
    },
    {
        "id": "c1cdd26489314e43",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "U_illumenance",
                "pt": "flow",
                "to": "illuminance",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 880,
        "wires": [
            [
                "ed863371775575ab"
            ]
        ]
    },
    {
        "id": "7b175354f8d58739",
        "type": "switch",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "Is True",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "true"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 510,
        "y": 840,
        "wires": [
            [
                "a0287f6dea869c13"
            ],
            [
                "ed863371775575ab"
            ]
        ]
    },
    {
        "id": "a0287f6dea869c13",
        "type": "switch",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "FP2Movement",
        "property": "FP2Movement",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 700,
        "y": 840,
        "wires": [
            [
                "d434dc021a16f48a"
            ]
        ]
    },
    {
        "id": "d434dc021a16f48a",
        "type": "trigger",
        "z": "aa0ae7ae.75d228",
        "g": "ff7ca7f8980ed0b1",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "30",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "true",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 690,
        "y": 780,
        "wires": [
            [
                "ed863371775575ab"
            ]
        ]
    },
    {
        "id": "7c376eb857a4e46f",
        "type": "link in",
        "z": "aa0ae7ae.75d228",
        "g": "8da8f3a9a56fc7ee",
        "name": "BasementBlock",
        "links": [
            "ac728ff70c911726"
        ],
        "x": 1455,
        "y": 320,
        "wires": [
            [
                "7c9078bb.3bd958"
            ]
        ]
    },
    {
        "id": "2cb600ab1cf6c9f0",
        "type": "switch",
        "z": "aa0ae7ae.75d228",
        "g": "172b4292bafc68a7",
        "name": "",
        "property": "isStandBy",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 790,
        "y": 1060,
        "wires": [
            [
                "53b8c66e905a41c3"
            ],
            [
                "df0d0e357f912ecb"
            ]
        ]
    },
    {
        "id": "df0d0e357f912ecb",
        "type": "change",
        "z": "aa0ae7ae.75d228",
        "g": "172b4292bafc68a7",
        "name": "reset",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "GO",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 930,
        "y": 1100,
        "wires": [
            [
                "183c95c7745f2ea4"
            ]
        ]
    },
    {
        "id": "53b8c66e905a41c3",
        "type": "switch",
        "z": "aa0ae7ae.75d228",
        "g": "172b4292bafc68a7",
        "name": "is_playing",
        "property": "is_playing",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 920,
        "y": 1040,
        "wires": [
            [
                "df0d0e357f912ecb"
            ],
            [
                "183c95c7745f2ea4"
            ]
        ]
    },
    {
        "id": "1329b56.bea634b",
        "type": "link in",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "Night mode",
        "links": [
            "328ec247.9e5eee",
            "455faa8d.6c9aa4",
            "63e9f9b.1d13608",
            "9ace10c4.4ce8f",
            "cf3797c1e0b5c101",
            "dc7a9dbe.e7065",
            "e92f253c.11b9b8",
            "b526ea173bec8f67"
        ],
        "x": 195,
        "y": 600,
        "wires": [
            [
                "73129a34755245fc"
            ]
        ]
    },
    {
        "id": "55a1471c.7ca3e8",
        "type": "trigger",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "op1": "",
        "op2": "true",
        "op1type": "nul",
        "op2type": "bool",
        "duration": "10",
        "extend": true,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1390,
        "y": 560,
        "wires": [
            [
                "d1068875.e54d18"
            ]
        ]
    },
    {
        "id": "61ee7057.5df1f",
        "type": "time-range-switch",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:00",
        "endTime": "22:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1170,
        "y": 560,
        "wires": [
            [],
            [
                "55a1471c.7ca3e8"
            ]
        ]
    },
    {
        "id": "fdbf838e.f9e58",
        "type": "change",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1160,
        "y": 620,
        "wires": [
            [
                "55a1471c.7ca3e8"
            ]
        ]
    },
    {
        "id": "247260f.c82dca",
        "type": "link out",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "SH: HOME",
        "mode": "link",
        "links": [
            "bb323297a8af6244",
            "dd907ae5e8f3fab4",
            "e17d0a43.b0e048",
            "f27df5b9f6840243"
        ],
        "x": 1875,
        "y": 40,
        "wires": []
    },
    {
        "id": "fc4fe81e.444628",
        "type": "link out",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "SH: Away",
        "mode": "link",
        "links": [
            "6c1d6758.428808",
            "810548cd17705360",
            "b3f9adc55b666094",
            "e17d0a43.b0e048",
            "fa037bf9c192d1d3"
        ],
        "x": 1875,
        "y": 340,
        "wires": []
    },
    {
        "id": "e1dcab5a.66f5f8",
        "type": "time-range-switch",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:00",
        "endTime": "11:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 810,
        "y": 720,
        "wires": [
            [
                "2e0d79f5.69a796"
            ],
            []
        ]
    },
    {
        "id": "2e0d79f5.69a796",
        "type": "link out",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "FH: Movement Morning",
        "links": [
            "1d2eacde.d050c3"
        ],
        "x": 935,
        "y": 720,
        "wires": []
    },
    {
        "id": "1d2eacde.d050c3",
        "type": "link in",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "FH: Home Mode",
        "links": [
            "2e0d79f5.69a796"
        ],
        "x": 1495,
        "y": 60,
        "wires": [
            [
                "3e6914e6.deefec"
            ]
        ]
    },
    {
        "id": "3e6914e6.deefec",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "Mode",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "away",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "sleep",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1670,
        "y": 60,
        "wires": [
            [],
            [
                "d13df963babc7388"
            ]
        ]
    },
    {
        "id": "d1068875.e54d18",
        "type": "function",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "Sleep",
        "func": "// msg.payload = {\"mode\":\"sleep\"};\n// global.set(\"Mode\", \"sleep\")\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1350,
        "y": 620,
        "wires": [
            [
                "c9b7d9c6.2c46e8"
            ]
        ]
    },
    {
        "id": "c9b7d9c6.2c46e8",
        "type": "link out",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "sh-SLeep",
        "mode": "link",
        "links": [
            "9a51081d9dca2356"
        ],
        "x": 1495,
        "y": 620,
        "wires": []
    },
    {
        "id": "477666d4.b53928",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 670,
        "y": 600,
        "wires": [
            [
                "ebfc5adc.7672f8",
                "4cb805cbab89b41b"
            ],
            [
                "fdbf838e.f9e58",
                "b3ea9a13d1f2b71d",
                "772f9c1b8b6b7713"
            ]
        ]
    },
    {
        "id": "e67e0c77.93b2c",
        "type": "change",
        "z": "8b99f8fe.7b27b8",
        "g": "0a0b0609692fe022",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "manualmode",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 260,
        "wires": [
            [
                "9a32b6d26ea58f65"
            ]
        ]
    },
    {
        "id": "77b78689.5eac68",
        "type": "trigger",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "away",
        "op1": "true",
        "op2": "false",
        "op1type": "bool",
        "op2type": "bool",
        "duration": "15",
        "extend": false,
        "overrideDelay": false,
        "units": "min",
        "reset": "true",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1530,
        "y": 180,
        "wires": [
            [
                "0f55237f3acf03e4"
            ]
        ]
    },
    {
        "id": "a5d3065e.5a0698",
        "type": "trigger",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "home",
        "op1": "true",
        "op2": "0",
        "op1type": "bool",
        "op2type": "str",
        "duration": "0",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "false",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1530,
        "y": 140,
        "wires": [
            [
                "d13df963babc7388"
            ]
        ]
    },
    {
        "id": "29d24b09.012634",
        "type": "time-range-switch",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "08:00",
        "endTime": "21:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1930,
        "y": 100,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "dc33a268.a0933",
        "type": "link out",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "",
        "mode": "link",
        "links": [
            "e1a25373.858cb"
        ],
        "x": 2095,
        "y": 160,
        "wires": []
    },
    {
        "id": "1e1f56fa524173df",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "Present?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1260,
        "y": 140,
        "wires": [
            [
                "a5d3065e.5a0698",
                "77b78689.5eac68",
                "d8ddcd9494c894c6"
            ],
            [
                "visitor_gate_check",
                "a5d3065e.5a0698"
            ]
        ]
    },
    {
        "id": "visitor_gate_check",
        "type": "function",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "Visitor Mode Gate",
        "func": "// Check if visitor mode is active\nconst visitorMode = global.get('VisitorMode') || {};\n\nif (visitorMode.enabled === true) {\n    // Visitor mode active - block away mode trigger\n    node.status({fill: \"yellow\", shape: \"ring\", text: \"Blocked: Visitor present\"});\n    return null; // Stop message flow\n}\n\n// No visitor mode - allow normal away mode logic\nnode.status({});\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1380,
        "y": 220,
        "wires": [
            [
                "9ab9f797bec97d04"
            ]
        ]
    },
    {
        "id": "9ab9f797bec97d04",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "Mode",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1530,
        "y": 220,
        "wires": [
            [
                "77b78689.5eac68"
            ],
            [
                "aaf5b9532af1fbac"
            ]
        ]
    },
    {
        "id": "4241a94a84740929",
        "type": "change",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "System is AWAY",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "System is AWAY",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1940,
        "y": 180,
        "wires": [
            [
                "dc33a268.a0933"
            ]
        ]
    },
    {
        "id": "8ebc2701b1ba1795",
        "type": "change",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "System is HOME",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "System is HOME",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1950,
        "y": 140,
        "wires": [
            [
                "dc33a268.a0933"
            ]
        ]
    },
    {
        "id": "72a46790.043618",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "! Sleep / vacation ",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "neq",
                "v": "sleep",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1290,
        "y": 100,
        "wires": [
            [
                "1e1f56fa524173df"
            ]
        ]
    },
    {
        "id": "9e9814a999c69457",
        "type": "link in",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "Set Mode",
        "links": [
            "5c5afd3abb577912",
            "6b9eeab08f2cdd54",
            "99e34fb7e0972e1e"
        ],
        "x": 975,
        "y": 100,
        "wires": [
            [
                "0f11f6ab1cb7a7dc"
            ]
        ]
    },
    {
        "id": "0f55237f3acf03e4",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1670,
        "y": 180,
        "wires": [
            [
                "a5d3065e.5a0698",
                "aaf5b9532af1fbac"
            ],
            [
                "c61133f02b5c38b9",
                "d8ddcd9494c894c6"
            ]
        ]
    },
    {
        "id": "c61133f02b5c38b9",
        "type": "change",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "System is AWAY",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "5 Minutes Until Away Mode",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1940,
        "y": 260,
        "wires": [
            [
                "dc33a268.a0933"
            ]
        ]
    },
    {
        "id": "07c3245eb0c7f6a4",
        "type": "ui-switch",
        "z": "8b99f8fe.7b27b8",
        "g": "0a0b0609692fe022",
        "name": "Manual Mode",
        "label": "Manual Mode",
        "group": "3f286b473c9966df",
        "order": 1,
        "width": "2",
        "height": "1",
        "passthru": false,
        "decouple": false,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "layout": "row-left",
        "clickableArea": "switch",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "stop",
        "oncolor": "red",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "play",
        "offcolor": "green",
        "x": 460,
        "y": 160,
        "wires": [
            [
                "e67e0c77.93b2c"
            ]
        ]
    },
    {
        "id": "f2c61516d13e4a6a",
        "type": "link in",
        "z": "8b99f8fe.7b27b8",
        "g": "0a0b0609692fe022",
        "name": "Activate manualmode",
        "links": [
            "2269200b466aa112"
        ],
        "x": 195,
        "y": 220,
        "wires": [
            [
                "8ec3d0adcf1c105a"
            ]
        ]
    },
    {
        "id": "8ec3d0adcf1c105a",
        "type": "change",
        "z": "8b99f8fe.7b27b8",
        "g": "0a0b0609692fe022",
        "name": "Activate Manualmode",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "Manualmode Activated",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 220,
        "wires": [
            [
                "07c3245eb0c7f6a4",
                "e67e0c77.93b2c",
                "a834552d0be27f3a"
            ]
        ]
    },
    {
        "id": "137603dc312c04a3",
        "type": "link in",
        "z": "8b99f8fe.7b27b8",
        "g": "0a0b0609692fe022",
        "name": "Deactivate manualmode",
        "links": [
            "7f851e060826def4"
        ],
        "x": 195,
        "y": 260,
        "wires": [
            [
                "9ff137671de44e2d"
            ]
        ]
    },
    {
        "id": "9ff137671de44e2d",
        "type": "change",
        "z": "8b99f8fe.7b27b8",
        "g": "0a0b0609692fe022",
        "name": "Deactivate Manualmode",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "Manualmode Deactivated",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 260,
        "wires": [
            [
                "e67e0c77.93b2c",
                "07c3245eb0c7f6a4",
                "a834552d0be27f3a"
            ]
        ]
    },
    {
        "id": "9a32b6d26ea58f65",
        "type": "change",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1240,
        "y": 220,
        "wires": [
            [
                "77b78689.5eac68",
                "d8ddcd9494c894c6"
            ]
        ]
    },
    {
        "id": "73129a34755245fc",
        "type": "subflow:05933d2d8abb4be7",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "x": 330,
        "y": 600,
        "wires": [
            [
                "477666d4.b53928"
            ],
            []
        ]
    },
    {
        "id": "0f11f6ab1cb7a7dc",
        "type": "subflow:05933d2d8abb4be7",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "",
        "x": 1090,
        "y": 100,
        "wires": [
            [
                "72a46790.043618"
            ],
            []
        ]
    },
    {
        "id": "f13b82bef847d1cd",
        "type": "inject",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "01 22 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 540,
        "y": 540,
        "wires": [
            [
                "ebfc5adc.7672f8"
            ]
        ]
    },
    {
        "id": "ebfc5adc.7672f8",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "Mode",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 730,
        "y": 560,
        "wires": [
            [
                "6e2a6b2335a9dc23"
            ]
        ]
    },
    {
        "id": "5ca10b6218e10f1a",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "isStandBy",
        "property": "isStandBy",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1020,
        "y": 560,
        "wires": [
            [
                "61ee7057.5df1f"
            ]
        ]
    },
    {
        "id": "a834552d0be27f3a",
        "type": "link out",
        "z": "8b99f8fe.7b27b8",
        "g": "0a0b0609692fe022",
        "name": "link out 34",
        "mode": "link",
        "links": [
            "5cfbdbd83670143c"
        ],
        "x": 585,
        "y": 200,
        "wires": []
    },
    {
        "id": "b3ea9a13d1f2b71d",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "property": "isWeekend",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 680,
        "wires": [
            [
                "bba74b7af0063e94"
            ],
            [
                "e1dcab5a.66f5f8"
            ]
        ]
    },
    {
        "id": "bba74b7af0063e94",
        "type": "time-range-switch",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "08:00",
        "endTime": "11:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 810,
        "y": 680,
        "wires": [
            [
                "2e0d79f5.69a796"
            ],
            []
        ]
    },
    {
        "id": "b6a6386fcda0ae83",
        "type": "ui-switch",
        "z": "8b99f8fe.7b27b8",
        "name": "Visitor Mode",
        "label": "Visitor Mode",
        "group": "3f286b473c9966df",
        "order": 2,
        "width": "2",
        "height": "1",
        "passthru": false,
        "decouple": false,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "layout": "row-left",
        "clickableArea": "switch",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "account-plus",
        "oncolor": "red",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "account-minus",
        "offcolor": "green",
        "x": 290,
        "y": 400,
        "wires": [
            [
                "18e04638e536cf3d"
            ]
        ]
    },
    {
        "id": "18e04638e536cf3d",
        "type": "function",
        "z": "8b99f8fe.7b27b8",
        "name": "Set Visitor Mode",
        "func": "// Initialize or update visitor mode object\nconst visitorMode = global.get('VisitorMode') || {};\n\nif (msg.payload === true) {\n    // Activate visitor mode with defaults\n    visitorMode.enabled = true;\n    visitorMode.type = visitorMode.type || 'day_visit'; // day_visit, house_sitter, overnight\n    visitorMode.startTime = visitorMode.startTime || Date.now();\n    visitorMode.expectedEndTime = visitorMode.expectedEndTime || null;\n    visitorMode.allowedAreas = visitorMode.allowedAreas || ['kitchen', 'living_room', 'bathroom', 'hallway', 'stairs'];\n    visitorMode.restrictedAreas = visitorMode.restrictedAreas || ['bedroom', 'office'];\n    visitorMode.autoLightsEnabled = true;\n    visitorMode.climateAdjusted = true;\n    \n    node.status({fill: \"red\", shape: \"dot\", text: \"Visitor Mode: \" + visitorMode.type});\n    msg.payload = \"Visitor Mode Activated\";\n} else {\n    // Deactivate visitor mode\n    visitorMode.enabled = false;\n    visitorMode.endTime = Date.now();\n    \n    node.status({fill: \"green\", shape: \"ring\", text: \"Visitor Mode OFF\"});\n    msg.payload = \"Visitor Mode Deactivated\";\n}\n\nglobal.set('VisitorMode', visitorMode);\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 510,
        "y": 400,
        "wires": [
            [
                "vm_notify_01"
            ]
        ]
    },
    {
        "id": "vm_notify_01",
        "type": "ui-notification",
        "z": "8b99f8fe.7b27b8",
        "ui": "7f0c45a9432dc256",
        "position": "top right",
        "colorDefault": true,
        "color": "#000000",
        "displayTime": "3",
        "showCountdown": true,
        "outputs": 0,
        "allowDismiss": true,
        "dismissText": "Close",
        "raw": false,
        "x": 730,
        "y": 400,
        "wires": []
    },
    {
        "id": "6e2a6b2335a9dc23",
        "type": "switch",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "Not presence",
        "property": "presence",
        "propertyType": "global",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 870,
        "y": 560,
        "wires": [
            [
                "5ca10b6218e10f1a"
            ]
        ]
    },
    {
        "id": "772f9c1b8b6b7713",
        "type": "trigger",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "10",
        "extend": false,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 820,
        "y": 640,
        "wires": [
            [
                "b3ea9a13d1f2b71d"
            ]
        ]
    },
    {
        "id": "4cb805cbab89b41b",
        "type": "change",
        "z": "8b99f8fe.7b27b8",
        "g": "429d0786e75351cd",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 740,
        "y": 520,
        "wires": [
            [
                "772f9c1b8b6b7713"
            ]
        ]
    },
    {
        "id": "d8ddcd9494c894c6",
        "type": "trigger",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "vacation",
        "op1": "true",
        "op2": "false",
        "op1type": "bool",
        "op2type": "bool",
        "duration": "15",
        "extend": false,
        "overrideDelay": false,
        "units": "hr",
        "reset": "true",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1600,
        "y": 280,
        "wires": [
            [
                "2d89c6f3277b5730"
            ]
        ]
    },
    {
        "id": "2d89c6f3277b5730",
        "type": "link out",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "SH: Vacation",
        "mode": "link",
        "links": [
            "06a76cb3da5742c4"
        ],
        "x": 1715,
        "y": 300,
        "wires": []
    },
    {
        "id": "886397ee88c4a44f",
        "type": "link in",
        "z": "8b99f8fe.7b27b8",
        "g": "0dc9ec7306f46565",
        "name": "link in 4",
        "links": [
            "328ec247.9e5eee"
        ],
        "x": 1005,
        "y": 180,
        "wires": [
            [
                "9a32b6d26ea58f65"
            ]
        ]
    },
    {
        "id": "976db23e.1f8ba",
        "type": "link out",
        "z": "1b14ec1b.20ab54",
        "name": "",
        "mode": "link",
        "links": [
            "15d28c99.680783"
        ],
        "x": 805,
        "y": 160,
        "wires": []
    },
    {
        "id": "4f048068.a4401",
        "type": "function",
        "z": "1b14ec1b.20ab54",
        "d": true,
        "name": "Happy hungry",
        "func": "msg.payload = \"Happy is hungry\";\nmsg.emitVolume =50;\n\n\nlet msg2 = {};\nmsg2.payload = [ {\n        \"title\": \"Eat\",\n        \"description\": \"Happy wants to eat\",\n        \"icon\": \"https://lh3.googleusercontent.com/F7dHEApWlOufIKF5NX7EHtx1VTPfKWRIN-bOMch2Mi5eixq7cASp-Jh4kr2T4u5l5OUwkhZgowOD6HSOvnnSDi14oaDkREKSmejYnyOujkuSUw5mkIr_AqgIkZro25qWezWl3jxMwv-yTNCzPGV_ABugX9malJX4ZMEumc0cz5wQHsJxfh334ayq_yAslDd7cRzVytebggUPZ7kzxiWYtNAPZLzuOhZLu831adN6OM91wD7glPQoticU3Lh97Hzi1bHI55CEsMuY0DI4jIGlHCkhziI7Xm3FoZCjqX467O5uqKxHzdsamQ9FLGPquo7xr5FBaFUlrwtYoliH1kfSLEVF5C2b_zwErbcjQPCmKyPWQiUthDLvtcatWZ-zC7XmZb3knlSdb_ecwFmbm5lyn0krvtDU123uynS_xLK2C8uXhUP_A3r2msHBEIqrQoDP3HCHlJl2rOQ77Mxgh1uqUCZTT2EUGs67B-beYgbVcd_8wydZfHl6Pn4LP04yilrP3yCZtPT9zC_j-XM4AH_5kunbXytenZHLteaI4ppe4u9lnRCjX5nq8vshrXfOJINr_XvBbUQRHb1uUxQ9N0R_a8i7McUanKl06SX967PMOl9mxSC4LrisMzTj4KoWATsVCU8oXeo6DEsx-l0ICLeLven98hfoAFZym6jPVhBbUmZF7c_IGuqEgUvDw0HI1jc5uATSRxz-7YDELuDpAz4DKQBMMToV-yZdpNQXsM3zpu1Je7j9nA=w563-h545-no\"\n    }];\n\nreturn [msg, msg2];",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 510,
        "y": 260,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "ba60c720.f08e38",
        "type": "trigger",
        "z": "1b14ec1b.20ab54",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "pay",
        "op2type": "nul",
        "duration": "2",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 690,
        "y": 140,
        "wires": [
            [
                "976db23e.1f8ba"
            ]
        ]
    },
    {
        "id": "4324ade3.0032c4",
        "type": "http request",
        "z": "1b14ec1b.20ab54",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "http://192.168.1.154:1880/feed",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 700,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "ddeb10c8.abffe",
        "type": "trigger",
        "z": "1b14ec1b.20ab54",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "pay",
        "op2type": "nul",
        "duration": "5",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 510,
        "y": 220,
        "wires": [
            [
                "4324ade3.0032c4"
            ]
        ]
    },
    {
        "id": "933b65ba.415558",
        "type": "function",
        "z": "1b14ec1b.20ab54",
        "name": "Happy Inside",
        "func": "  msg.payload = {\n    app: \"DefaultMediaReceiver\",\n    type: \"TTS\",\n    text: \"Happy wants  to go INSIDE\",\n    speed: 1, // optional to adjust TTS speed, defaults to 1\n    language: \"en\", // optional to set TTS language, default to en\n    metadata: { // optional unless desired, follows normal metadata rules noted above\n      title: \"Media title\"\n    }\n  }\n\n\n\n\n\n\n\nlet msg2 = {};\n\n\n\n\n\nmsg2.payload = [ {\n        \"title\": \"Outside\",\n        \"description\": msg.payload.text,\n        \"icon\": \"https://lh3.googleusercontent.com/F7dHEApWlOufIKF5NX7EHtx1VTPfKWRIN-bOMch2Mi5eixq7cASp-Jh4kr2T4u5l5OUwkhZgowOD6HSOvnnSDi14oaDkREKSmejYnyOujkuSUw5mkIr_AqgIkZro25qWezWl3jxMwv-yTNCzPGV_ABugX9malJX4ZMEumc0cz5wQHsJxfh334ayq_yAslDd7cRzVytebggUPZ7kzxiWYtNAPZLzuOhZLu831adN6OM91wD7glPQoticU3Lh97Hzi1bHI55CEsMuY0DI4jIGlHCkhziI7Xm3FoZCjqX467O5uqKxHzdsamQ9FLGPquo7xr5FBaFUlrwtYoliH1kfSLEVF5C2b_zwErbcjQPCmKyPWQiUthDLvtcatWZ-zC7XmZb3knlSdb_ecwFmbm5lyn0krvtDU123uynS_xLK2C8uXhUP_A3r2msHBEIqrQoDP3HCHlJl2rOQ77Mxgh1uqUCZTT2EUGs67B-beYgbVcd_8wydZfHl6Pn4LP04yilrP3yCZtPT9zC_j-XM4AH_5kunbXytenZHLteaI4ppe4u9lnRCjX5nq8vshrXfOJINr_XvBbUQRHb1uUxQ9N0R_a8i7McUanKl06SX967PMOl9mxSC4LrisMzTj4KoWATsVCU8oXeo6DEsx-l0ICLeLven98hfoAFZym6jPVhBbUmZF7c_IGuqEgUvDw0HI1jc5uATSRxz-7YDELuDpAz4DKQBMMToV-yZdpNQXsM3zpu1Je7j9nA=w563-h545-no\"\n    }];\n\nreturn [msg, msg2];",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 160,
        "wires": [
            [
                "ba60c720.f08e38"
            ],
            []
        ]
    },
    {
        "id": "e938238ab245c876",
        "type": "inject",
        "z": "1b14ec1b.20ab54",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 340,
        "y": 100,
        "wires": [
            [
                "933b65ba.415558"
            ]
        ]
    },
    {
        "id": "eb90ae51.1af18",
        "type": "deconz-input",
        "z": "1b14ec1b.20ab54",
        "name": "",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/00:15:8d:00:01:4a:08:f7-01-0006"
        ],
        "device_name": "Happy vil ut : ZHASwitch",
        "query": "",
        "outputs": 2,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "always",
                "onstart": false,
                "payload": [
                    "__complete__"
                ]
            },
            {
                "type": "homekit",
                "format": "single",
                "onstart": true,
                "onerror": true,
                "payload": [
                    "__auto__"
                ]
            }
        ],
        "x": 270,
        "y": 160,
        "wires": [
            [
                "4f048068.a4401",
                "933b65ba.415558"
            ],
            []
        ]
    },
    {
        "id": "a4770dbb.04eff",
        "type": "switch",
        "z": "605ae98f.8a9998",
        "name": "button press",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "7002",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "8002",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 770,
        "y": 400,
        "wires": [
            [
                "4182b18c.6b705"
            ],
            [
                "20238790.e84df8"
            ]
        ]
    },
    {
        "id": "20238790.e84df8",
        "type": "change",
        "z": "605ae98f.8a9998",
        "name": "Open",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1010,
        "y": 440,
        "wires": [
            [
                "1bb57f45.872e71",
                "26caebff.0ab3c4",
                "515c9831.0334b8"
            ]
        ]
    },
    {
        "id": "4182b18c.6b705",
        "type": "change",
        "z": "605ae98f.8a9998",
        "name": "CLOSE",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "100",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1020,
        "y": 400,
        "wires": [
            [
                "1bb57f45.872e71",
                "112531d1.56298e",
                "515c9831.0334b8"
            ]
        ]
    },
    {
        "id": "6c1d6758.428808",
        "type": "link in",
        "z": "605ae98f.8a9998",
        "d": true,
        "name": "IK: Sov",
        "links": [
            "fc4fe81e.444628"
        ],
        "x": 305,
        "y": 360,
        "wires": [
            [
                "6bb5ecbc.1d0e04"
            ]
        ]
    },
    {
        "id": "cec0f8cb.33f1b8",
        "type": "switch",
        "z": "605ae98f.8a9998",
        "name": "open/close",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 770,
        "y": 360,
        "wires": [
            [
                "4182b18c.6b705"
            ],
            [
                "20238790.e84df8"
            ]
        ]
    },
    {
        "id": "74a70908.bd50d8",
        "type": "inject",
        "z": "605ae98f.8a9998",
        "name": "Åpne Gardin 10 00",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "00 12 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 340,
        "y": 220,
        "wires": [
            [
                "80f7cb785e7040b3"
            ]
        ]
    },
    {
        "id": "bb45bf3b.5ab5f",
        "type": "link out",
        "z": "605ae98f.8a9998",
        "name": "",
        "links": [],
        "x": 1315,
        "y": 400,
        "wires": []
    },
    {
        "id": "26caebff.0ab3c4",
        "type": "function",
        "z": "605ae98f.8a9998",
        "name": "Open",
        "func": "msg.payload = {openPercent : 100};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1210,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "112531d1.56298e",
        "type": "function",
        "z": "605ae98f.8a9998",
        "name": "Close",
        "func": "msg.payload = {openPercent : 0};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1210,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "1bb57f45.872e71",
        "type": "function",
        "z": "605ae98f.8a9998",
        "name": "",
        "func": "        msg.payload = {devices:{id: \"id\",name: \"Sov_Gardin\", power: (msg.payload === 0) ? \"off\" : \"on\"}};\n      \n        \n   \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1220,
        "y": 400,
        "wires": [
            [
                "bb45bf3b.5ab5f"
            ]
        ]
    },
    {
        "id": "6bb5ecbc.1d0e04",
        "type": "switch",
        "z": "605ae98f.8a9998",
        "name": "away",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "away",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 450,
        "y": 360,
        "wires": [
            [
                "d87cbd2e.f854f"
            ]
        ]
    },
    {
        "id": "d87cbd2e.f854f",
        "type": "change",
        "z": "605ae98f.8a9998",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 600,
        "y": 360,
        "wires": [
            [
                "cec0f8cb.33f1b8"
            ]
        ]
    },
    {
        "id": "ad29b802.69fbb8",
        "type": "link in",
        "z": "605ae98f.8a9998",
        "name": "Fyrtur",
        "links": [
            "1b253553.66750b"
        ],
        "x": 305,
        "y": 400,
        "wires": [
            [
                "a4770dbb.04eff"
            ]
        ]
    },
    {
        "id": "515c9831.0334b8",
        "type": "link out",
        "z": "605ae98f.8a9998",
        "name": "Fyrtur",
        "links": [
            "800c441a.1f78d8"
        ],
        "x": 1175,
        "y": 360,
        "wires": []
    },
    {
        "id": "bf0b57cd2238e193",
        "type": "inject",
        "z": "605ae98f.8a9998",
        "name": "Close Gardin",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "00 21 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 720,
        "y": 240,
        "wires": [
            [
                "4182b18c.6b705"
            ]
        ]
    },
    {
        "id": "80f7cb785e7040b3",
        "type": "switch",
        "z": "605ae98f.8a9998",
        "name": "! Sleep",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "neq",
                "v": "sleep",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 560,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "e92f253c.11b9b8",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "Bevegelse Trapp",
        "mode": "link",
        "links": [
            "1329b56.bea634b",
            "77e202e1f7cb4c98",
            "f66e7e24.aca9d"
        ],
        "x": 695,
        "y": 100,
        "wires": []
    },
    {
        "id": "328ec247.9e5eee",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "Bvegelse Gang",
        "mode": "link",
        "links": [
            "1329b56.bea634b",
            "dcf434ce.e89888",
            "e22089f94174d570",
            "886397ee88c4a44f"
        ],
        "x": 695,
        "y": 160,
        "wires": []
    },
    {
        "id": "1b253553.66750b",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "DZ_Fyrtur",
        "links": [
            "ad29b802.69fbb8"
        ],
        "x": 1325,
        "y": 540,
        "wires": []
    },
    {
        "id": "800c441a.1f78d8",
        "type": "link in",
        "z": "a7af161f.d5ece8",
        "name": "DZ_Fyrtur",
        "links": [
            "515c9831.0334b8"
        ],
        "x": 615,
        "y": 660,
        "wires": [
            [
                "cda1726885b13d07",
                "c4d3b2d1c7c5794d"
            ]
        ]
    },
    {
        "id": "84d4238b.16cfe",
        "type": "subflow:94ff8f0f.02c5a",
        "z": "a7af161f.d5ece8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "Gangen",
                "type": "str"
            },
            {
                "name": "ignore_state",
                "value": "true",
                "type": "bool"
            }
        ],
        "x": 530,
        "y": 160,
        "wires": [
            [
                "328ec247.9e5eee"
            ]
        ]
    },
    {
        "id": "8b7a0dc.31806f",
        "type": "subflow:94ff8f0f.02c5a",
        "z": "a7af161f.d5ece8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "StueVtoalett",
                "type": "str"
            }
        ],
        "x": 530,
        "y": 100,
        "wires": [
            [
                "e92f253c.11b9b8"
            ]
        ]
    },
    {
        "id": "32a8f67f.ad5fca",
        "type": "subflow:94ff8f0f.02c5a",
        "z": "a7af161f.d5ece8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "Bedroom",
                "type": "str"
            },
            {
                "name": "ETG",
                "value": "2",
                "type": "str"
            }
        ],
        "x": 530,
        "y": 220,
        "wires": [
            [
                "9ace10c4.4ce8f"
            ]
        ]
    },
    {
        "id": "9ace10c4.4ce8f",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "Bvegelse Soverom",
        "links": [
            "50b0d259.df502c",
            "1329b56.bea634b",
            "77e202e1f7cb4c98"
        ],
        "x": 695,
        "y": 220,
        "wires": []
    },
    {
        "id": "c993abab.7f54d8",
        "type": "subflow:94ff8f0f.02c5a",
        "z": "a7af161f.d5ece8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "Kjøkken",
                "type": "str"
            }
        ],
        "x": 530,
        "y": 460,
        "wires": [
            [
                "63e9f9b.1d13608"
            ]
        ]
    },
    {
        "id": "63e9f9b.1d13608",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "Bevegelse Kjøkken",
        "mode": "link",
        "links": [
            "1329b56.bea634b",
            "77e202e1f7cb4c98",
            "60b2567222677770"
        ],
        "x": 695,
        "y": 460,
        "wires": []
    },
    {
        "id": "b3936326.9069d",
        "type": "switch",
        "z": "a7af161f.d5ece8",
        "name": "Upstairs",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1002",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "2002",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "1001",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 1520,
        "y": 360,
        "wires": [
            [
                "161bb255.512b1e"
            ],
            [
                "4340bf1e.b870c"
            ],
            [
                "91591da1.3f633"
            ]
        ]
    },
    {
        "id": "161bb255.512b1e",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1700,
        "y": 340,
        "wires": [
            [
                "fbd30b58.0dc988"
            ]
        ]
    },
    {
        "id": "4340bf1e.b870c",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1700,
        "y": 380,
        "wires": [
            [
                "fbd30b58.0dc988"
            ]
        ]
    },
    {
        "id": "fbd30b58.0dc988",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "Upstairs",
        "links": [],
        "x": 1925,
        "y": 380,
        "wires": []
    },
    {
        "id": "91591da1.3f633",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "Auto",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Auto",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1700,
        "y": 420,
        "wires": [
            [
                "fbd30b58.0dc988"
            ]
        ]
    },
    {
        "id": "daf07d4d.1f365",
        "type": "switch",
        "z": "a7af161f.d5ece8",
        "name": "Downstairs",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "3002",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "4002",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "3001",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 1520,
        "y": 480,
        "wires": [
            [
                "54177de6.161014"
            ],
            [
                "f15b1d.2b4844e"
            ],
            [
                "c4ac5b4f.39cb38"
            ]
        ]
    },
    {
        "id": "54177de6.161014",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1690,
        "y": 460,
        "wires": [
            [
                "63220a70.24ebb4"
            ]
        ]
    },
    {
        "id": "f15b1d.2b4844e",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1690,
        "y": 500,
        "wires": [
            [
                "63220a70.24ebb4"
            ]
        ]
    },
    {
        "id": "63220a70.24ebb4",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "Downstairs",
        "mode": "link",
        "links": [
            "5a5aa2c2317b2730"
        ],
        "x": 1805,
        "y": 480,
        "wires": []
    },
    {
        "id": "c4ac5b4f.39cb38",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "Auto",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Auto",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1690,
        "y": 540,
        "wires": [
            [
                "63220a70.24ebb4"
            ]
        ]
    },
    {
        "id": "455faa8d.6c9aa4",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "Bathrrom_Movement",
        "mode": "link",
        "links": [
            "1329b56.bea634b",
            "2214d9cb038cf259",
            "77e202e1f7cb4c98",
            "c840b6850a9f9370"
        ],
        "x": 695,
        "y": 520,
        "wires": []
    },
    {
        "id": "dc7a9dbe.e7065",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "Bathroom_Door",
        "mode": "link",
        "links": [
            "1329b56.bea634b",
            "271f90f30bdc06b6",
            "ea645748ca3e406e",
            "f66e7e24.aca9d"
        ],
        "x": 795,
        "y": 580,
        "wires": []
    },
    {
        "id": "6fd91fe30a14cff0",
        "type": "subflow:94ff8f0f.02c5a",
        "z": "a7af161f.d5ece8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "Office",
                "type": "str"
            }
        ],
        "x": 530,
        "y": 280,
        "wires": [
            [
                "b526ea173bec8f67"
            ]
        ]
    },
    {
        "id": "b526ea173bec8f67",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "Office",
        "mode": "link",
        "links": [
            "1329b56.bea634b",
            "77e202e1f7cb4c98",
            "ca59d875951bc88c"
        ],
        "x": 695,
        "y": 280,
        "wires": []
    },
    {
        "id": "aebceaf8045c24f5",
        "type": "subflow:94ff8f0f.02c5a",
        "z": "a7af161f.d5ece8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "walkingcloset",
                "type": "str"
            },
            {
                "name": "ETG",
                "value": "2",
                "type": "str"
            }
        ],
        "x": 530,
        "y": 340,
        "wires": [
            [
                "5db3412dac700df1"
            ]
        ]
    },
    {
        "id": "5db3412dac700df1",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "walkingCloset",
        "mode": "link",
        "links": [
            "89ad14e36c74d6f8"
        ],
        "x": 695,
        "y": 340,
        "wires": []
    },
    {
        "id": "34fc36da289d8a4c",
        "type": "subflow:94ff8f0f.02c5a",
        "z": "a7af161f.d5ece8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "laundry",
                "type": "str"
            },
            {
                "name": "ETG",
                "value": "2",
                "type": "str"
            }
        ],
        "x": 530,
        "y": 400,
        "wires": [
            [
                "5cb449a017a68b38"
            ]
        ]
    },
    {
        "id": "5cb449a017a68b38",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "laundry",
        "mode": "link",
        "links": [
            "a322e5db270d2e0b"
        ],
        "x": 695,
        "y": 400,
        "wires": []
    },
    {
        "id": "5665132c2e015edc",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2002",
                "fromt": "num",
                "to": "7002",
                "tot": "num"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1002",
                "fromt": "num",
                "to": "8002",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1160,
        "y": 540,
        "wires": [
            [
                "1b253553.66750b"
            ]
        ]
    },
    {
        "id": "6d8cd486.3ac49c",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "Kjeller",
        "topic": "Trapp",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/00:15:8d:00:07:8e:b1:4d-01-0406"
        ],
        "device_name": "1etg: Stue-Gang : ZHAPresence",
        "query": "",
        "outputs": 1,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "onchange",
                "onstart": true,
                "payload": [
                    "presence"
                ]
            }
        ],
        "x": 230,
        "y": 100,
        "wires": [
            [
                "8b7a0dc.31806f"
            ]
        ]
    },
    {
        "id": "3bfccd97.de6142",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "Bevegelse Gangen",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/ec:1b:bd:ff:fe:a2:fd:03-01-0006"
        ],
        "device_name": "Gangen : ZHAPresence",
        "query": "",
        "outputs": 1,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "onchange",
                "onstart": true,
                "payload": [
                    "presence"
                ],
                "uniqueId": "ui-id-26"
            }
        ],
        "x": 270,
        "y": 160,
        "wires": [
            [
                "84d4238b.16cfe"
            ]
        ]
    },
    {
        "id": "36aeb8a0.824178",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "lights/uniqueid/cc:cc:cc:ff:fe:02:96:c6-01"
        ],
        "device_name": "Window covering device 5 : Window covering device",
        "query": "",
        "outputs": 2,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "always",
                "onstart": true,
                "payload": [
                    "__complete__"
                ]
            },
            {
                "type": "homekit",
                "format": "single",
                "onstart": true,
                "onerror": true,
                "payload": [
                    "__auto__"
                ]
            }
        ],
        "x": 310,
        "y": 660,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "780badae.5effd4",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "",
        "topic": "Bedroom",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [],
        "device_name": "Soverom : ZHAPresence",
        "query": "",
        "outputs": 2,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "onchange",
                "onstart": true,
                "payload": [
                    "__complete__"
                ]
            },
            {
                "type": "homekit",
                "format": "single",
                "onstart": true,
                "onerror": true,
                "payload": [
                    "__auto__"
                ]
            }
        ],
        "x": 290,
        "y": 220,
        "wires": [
            [
                "32a8f67f.ad5fca"
            ],
            []
        ]
    },
    {
        "id": "24b6d06c.7e0e6",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/00:15:8d:00:07:00:29:61-01-0406"
        ],
        "device_name": "Kjøkken : ZHAPresence",
        "query": "",
        "outputs": 1,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "always",
                "onstart": true,
                "payload": [
                    "presence"
                ]
            }
        ],
        "x": 280,
        "y": 460,
        "wires": [
            [
                "c993abab.7f54d8"
            ]
        ]
    },
    {
        "id": "620a790d.f793f8",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "Bryter",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/60:a4:23:ff:fe:28:37:14-01-0006",
            "sensors/uniqueid/cc:86:ec:ff:fe:ac:a8:84-01-0102"
        ],
        "device_name": "Kjeller Bryter : ZHASwitch",
        "query": "{}",
        "outputs": 2,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "onupdate",
                "onstart": false,
                "payload": [
                    "buttonevent"
                ]
            },
            {
                "type": "homekit",
                "format": "single",
                "onstart": false,
                "onerror": true,
                "payload": [
                    "__auto__"
                ]
            }
        ],
        "x": 1180,
        "y": 380,
        "wires": [
            [
                "b3936326.9069d",
                "1b253553.66750b",
                "daf07d4d.1f365"
            ],
            []
        ]
    },
    {
        "id": "3d5c496e.056dd6",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "Bevegelse BAD",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/00:15:8d:00:05:4a:78:00-01-0406"
        ],
        "device_name": "Presence 16 : ZHAPresence",
        "query": "",
        "outputs": 1,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "always",
                "onstart": true,
                "payload": [
                    "presence"
                ]
            }
        ],
        "x": 260,
        "y": 520,
        "wires": [
            [
                "e51348f9105fec0e"
            ]
        ]
    },
    {
        "id": "bdda4d7b.253eb",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "Dør BAD",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/00:15:8d:00:02:8d:6d:2d-01-0006"
        ],
        "device_name": "Window / Door Sensor : ZHAOpenClose",
        "query": "",
        "outputs": 1,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "onchange",
                "onstart": true,
                "payload": [
                    "open"
                ],
                "uniqueId": "ui-id-6"
            }
        ],
        "x": 240,
        "y": 580,
        "wires": [
            [
                "0187c3a623bbd919"
            ]
        ]
    },
    {
        "id": "72d4018db023f810",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "Office",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/00:15:8d:00:07:e5:d3:9c-01-0406"
        ],
        "device_name": "Kjøkken : ZHAPresence",
        "query": "",
        "outputs": 1,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "onchange",
                "onstart": true,
                "payload": [
                    "presence"
                ]
            }
        ],
        "x": 230,
        "y": 280,
        "wires": [
            [
                "6fd91fe30a14cff0"
            ]
        ]
    },
    {
        "id": "470c19a873498faf",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "WalkingCloset",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/bc:33:ac:ff:fe:18:65:a7-01-0006"
        ],
        "device_name": "Kjøkken : ZHAPresence",
        "query": "",
        "outputs": 1,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "onchange",
                "onstart": true,
                "payload": [
                    "presence"
                ],
                "uniqueId": "ui-id-7"
            }
        ],
        "x": 250,
        "y": 340,
        "wires": [
            [
                "aebceaf8045c24f5"
            ]
        ]
    },
    {
        "id": "c1e26f4bdb8d5101",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "Laundry",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/f8:44:77:ff:fe:7e:ce:7d-02-0406"
        ],
        "device_name": "Kjøkken : ZHAPresence",
        "query": "",
        "outputs": 1,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "onchange",
                "onstart": true,
                "payload": [
                    "presence"
                ]
            }
        ],
        "x": 240,
        "y": 400,
        "wires": [
            [
                "34fc36da289d8a4c"
            ]
        ]
    },
    {
        "id": "1fcb8d7b813d9380",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "payload",
        "statustext_type": "msg",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/cc:86:ec:ff:fe:ac:a8:84-01-0102"
        ],
        "device_name": "",
        "query": "{}",
        "outputs": 1,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "onchange",
                "onstart": false,
                "payload": [
                    "buttonevent"
                ]
            }
        ],
        "x": 1150,
        "y": 500,
        "wires": [
            [
                "5665132c2e015edc"
            ]
        ]
    },
    {
        "id": "84cb19d4.d232e8",
        "type": "deconz-output",
        "z": "a7af161f.d5ece8",
        "name": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "lights/uniqueid/cc:cc:cc:ff:fe:02:96:c6-01"
        ],
        "device_name": "Window covering device 5 : Window covering device",
        "query": "",
        "commands": [
            {
                "arg": {
                    "open": {
                        "type": "keep",
                        "value": ""
                    },
                    "stop": {
                        "type": "keep",
                        "value": ""
                    },
                    "lift": {
                        "type": "msg",
                        "value": "payload"
                    },
                    "tilt": {
                        "type": "num",
                        "value": ""
                    },
                    "retryonerror": {
                        "type": "num",
                        "value": "0"
                    },
                    "aftererror": {
                        "type": "continue",
                        "value": ""
                    }
                },
                "type": "deconz_state",
                "domain": "covers"
            }
        ],
        "specific": {
            "delay": {
                "type": "num",
                "value": "50"
            },
            "result": {
                "type": "at_end",
                "value": ""
            }
        },
        "x": 1180,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "e0b7b5594378e257",
        "type": "rbe",
        "z": "a7af161f.d5ece8",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": false,
        "property": "payload",
        "topi": "topic",
        "x": 690,
        "y": 580,
        "wires": [
            [
                "dc7a9dbe.e7065"
            ]
        ]
    },
    {
        "id": "e51348f9105fec0e",
        "type": "subflow:94ff8f0f.02c5a",
        "z": "a7af161f.d5ece8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "Bathroom",
                "type": "str"
            }
        ],
        "x": 530,
        "y": 520,
        "wires": [
            [
                "455faa8d.6c9aa4"
            ]
        ]
    },
    {
        "id": "0187c3a623bbd919",
        "type": "subflow:94ff8f0f.02c5a",
        "z": "a7af161f.d5ece8",
        "name": "",
        "env": [
            {
                "name": "Name",
                "value": "Bathroom",
                "type": "str"
            }
        ],
        "x": 530,
        "y": 580,
        "wires": [
            [
                "e0b7b5594378e257"
            ]
        ]
    },
    {
        "id": "f25990ae2ecc8f46",
        "type": "deconz-output",
        "z": "a7af161f.d5ece8",
        "name": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "lights/uniqueid/70:54:64:ff:fe:2e:62:24-01",
            "sensors/uniqueid/00:15:8d:00:05:4a:78:00-01-0400"
        ],
        "device_name": "",
        "query": "{}",
        "commands": [
            {
                "arg": {
                    "on": {
                        "type": "keep",
                        "value": ""
                    },
                    "alert": {
                        "type": "str",
                        "value": ""
                    },
                    "effect": {
                        "type": "str",
                        "value": ""
                    },
                    "colorloopspeed": {
                        "type": "num",
                        "value": ""
                    },
                    "transitiontime": {
                        "type": "num",
                        "value": ""
                    },
                    "retryonerror": {
                        "type": "num",
                        "value": "0"
                    },
                    "aftererror": {
                        "type": "continue",
                        "value": ""
                    },
                    "bri": {
                        "direction": "detect_from_value",
                        "type": "msg",
                        "value": "payload.brightness"
                    },
                    "sat": {
                        "direction": "set",
                        "type": "num",
                        "value": ""
                    },
                    "hue": {
                        "direction": "set",
                        "type": "num",
                        "value": ""
                    },
                    "ct": {
                        "direction": "set",
                        "type": "num",
                        "value": ""
                    },
                    "xy": {
                        "direction": "set",
                        "type": "json",
                        "value": "[]"
                    }
                },
                "type": "deconz_state",
                "domain": "lights"
            }
        ],
        "specific": {
            "delay": {
                "type": "num",
                "value": "50"
            },
            "result": {
                "type": "at_end",
                "value": ""
            }
        },
        "x": 870,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "f638fef55302f61e",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.brightness",
                "pt": "msg",
                "to": "255",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 900,
        "wires": [
            [
                "f25990ae2ecc8f46"
            ]
        ]
    },
    {
        "id": "403c4b2a8e4799b7",
        "type": "inject",
        "z": "a7af161f.d5ece8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{}",
        "payloadType": "json",
        "x": 442.8854064941406,
        "y": 1078.2381591796875,
        "wires": [
            [
                "f638fef55302f61e"
            ]
        ]
    },
    {
        "id": "5663901c264f5e02",
        "type": "link in",
        "z": "a7af161f.d5ece8",
        "name": "link in 15",
        "links": [
            "28b70963f6e11da6"
        ],
        "x": 355,
        "y": 900,
        "wires": [
            [
                "f638fef55302f61e"
            ]
        ]
    },
    {
        "id": "31840a2653579e08",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "payload.brightness",
                "pt": "msg",
                "to": "50",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 860,
        "wires": [
            [
                "f25990ae2ecc8f46"
            ]
        ]
    },
    {
        "id": "b68b07285e615789",
        "type": "link in",
        "z": "a7af161f.d5ece8",
        "name": "Reset mirror",
        "links": [
            "d75a3fcd498a1213"
        ],
        "x": 335,
        "y": 860,
        "wires": [
            [
                "31840a2653579e08"
            ]
        ]
    },
    {
        "id": "654d9fb07d02046c",
        "type": "deconz-input",
        "z": "a7af161f.d5ece8",
        "name": "Button 1",
        "topic": "",
        "config_version": 2,
        "server": "12895ae7.9c6bf5",
        "statustext": "",
        "statustext_type": "auto",
        "search_type": "device",
        "device_list": [
            "sensors/uniqueid/00:15:8d:00:01:9d:e5:2c-01-0006"
        ],
        "device_name": "Happy sulten : ZHASwitch",
        "query": "",
        "outputs": 2,
        "output_rules": [
            {
                "type": "state",
                "format": "single",
                "output": "always",
                "onstart": false,
                "payload": [
                    "__complete__"
                ]
            },
            {
                "type": "homekit",
                "format": "single",
                "onstart": false,
                "onerror": false,
                "payload": [
                    "__auto__"
                ]
            }
        ],
        "x": 240,
        "y": 40,
        "wires": [
            [
                "261fedf807e8e610"
            ],
            []
        ]
    },
    {
        "id": "261fedf807e8e610",
        "type": "switch",
        "z": "a7af161f.d5ece8",
        "name": "",
        "property": "payload.buttonevent",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1000",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "1004",
                "vt": "num"
            },
            {
                "t": "eq",
                "v": "1003",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 730,
        "y": 40,
        "wires": [
            [
                "bb541191e0a8556a"
            ],
            [
                "a91ad0b1f8b7fb8a"
            ],
            [
                "7166cbcecd88583a"
            ]
        ]
    },
    {
        "id": "bb541191e0a8556a",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "link out 30",
        "mode": "link",
        "links": [
            "86d4bc6ca1299e77"
        ],
        "x": 935,
        "y": 20,
        "wires": []
    },
    {
        "id": "a91ad0b1f8b7fb8a",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "link out 31",
        "mode": "link",
        "links": [],
        "x": 935,
        "y": 60,
        "wires": []
    },
    {
        "id": "7166cbcecd88583a",
        "type": "link out",
        "z": "a7af161f.d5ece8",
        "name": "link out 32",
        "mode": "link",
        "links": [],
        "x": 935,
        "y": 120,
        "wires": []
    },
    {
        "id": "cda1726885b13d07",
        "type": "time-range-switch",
        "z": "a7af161f.d5ece8",
        "name": "",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "23:00",
        "endTime": "07:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 730,
        "y": 660,
        "wires": [
            [],
            [
                "84cb19d4.d232e8"
            ]
        ]
    },
    {
        "id": "c4d3b2d1c7c5794d",
        "type": "change",
        "z": "a7af161f.d5ece8",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.time",
                "pt": "msg",
                "to": "",
                "tot": "date"
            },
            {
                "t": "set",
                "p": "CoveringDevice",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 710,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "45cb9cc4a62bb031",
        "type": "api-call-service",
        "z": "a7af161f.d5ece8",
        "name": "",
        "server": "c8d8b6d992397cb8",
        "version": 7,
        "debugenabled": false,
        "action": "light.toggle",
        "floorId": [],
        "areaId": [],
        "deviceId": [],
        "entityId": [
            "light.karina_office_2"
        ],
        "labelId": [],
        "data": "",
        "dataType": "jsonata",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "blockInputOverrides": true,
        "domain": "light",
        "service": "toggle",
        "x": 1370,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "86d4bc6ca1299e77",
        "type": "link in",
        "z": "a7af161f.d5ece8",
        "name": "link in 3",
        "links": [
            "bb541191e0a8556a"
        ],
        "x": 1125,
        "y": 40,
        "wires": [
            [
                "45cb9cc4a62bb031"
            ]
        ]
    },
    {
        "id": "81af6cca.e9c66",
        "type": "switch",
        "z": "1c88039c.df631c",
        "name": "",
        "property": "payload.playerState",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "PLAYING",
                "vt": "str"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1010,
        "y": 460,
        "wires": [
            [
                "68d9f69.9352e08"
            ],
            [
                "ff0f6df7.5a918"
            ]
        ]
    },
    {
        "id": "99eeb7d8.8caeb8",
        "type": "link out",
        "z": "1c88039c.df631c",
        "name": "FH_Kjeller",
        "links": [],
        "x": 1615,
        "y": 460,
        "wires": []
    },
    {
        "id": "e141ad77.43517",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "power",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 420,
        "wires": [
            [
                "9c8ff821.d99f48"
            ]
        ]
    },
    {
        "id": "ff0f6df7.5a918",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "power",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 500,
        "wires": [
            [
                "99eeb7d8.8caeb8",
                "df254ac2.220318"
            ]
        ]
    },
    {
        "id": "68d9f69.9352e08",
        "type": "switch",
        "z": "1c88039c.df631c",
        "name": "",
        "property": "payload.media.duration",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "5400",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1150,
        "y": 420,
        "wires": [
            [
                "e141ad77.43517"
            ]
        ]
    },
    {
        "id": "ee4bdb8e.0c68a8",
        "type": "castv2-sender",
        "z": "1c88039c.df631c",
        "name": "SHIELD",
        "connection": "4d021bd33834978e",
        "x": 420,
        "y": 540,
        "wires": [
            [
                "eed7282d01b63243"
            ]
        ]
    },
    {
        "id": "e9bb9204.50585",
        "type": "switch",
        "z": "1c88039c.df631c",
        "name": "",
        "property": "isStandBy",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 810,
        "y": 580,
        "wires": [
            [
                "a1111ae.032f9e8"
            ],
            [
                "352c4db3.c00bc2",
                "7207e65ef67dab2d"
            ]
        ]
    },
    {
        "id": "352c4db3.c00bc2",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "On",
        "rules": [
            {
                "t": "set",
                "p": "background",
                "pt": "msg",
                "to": "green",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Ser på TV",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 600,
        "wires": [
            [
                "5e8d3398.55375c",
                "c4c2684c239161a6"
            ]
        ]
    },
    {
        "id": "a1111ae.032f9e8",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "background",
                "pt": "msg",
                "to": "black",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "TV er AV",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1030,
        "y": 560,
        "wires": [
            [
                "5e8d3398.55375c",
                "4d769e70a92d266c"
            ]
        ]
    },
    {
        "id": "b50c3d14.adf0e",
        "type": "inject",
        "z": "1c88039c.df631c",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 250,
        "y": 540,
        "wires": [
            [
                "ee4bdb8e.0c68a8"
            ]
        ]
    },
    {
        "id": "5e8d3398.55375c",
        "type": "link out",
        "z": "1c88039c.df631c",
        "name": "SHIELD status",
        "mode": "link",
        "links": [
            "77b0a7f7334d846a",
            "cf21cfba7f910c8f"
        ],
        "x": 1125,
        "y": 580,
        "wires": []
    },
    {
        "id": "9c8ff821.d99f48",
        "type": "trigger",
        "z": "1c88039c.df631c",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "5",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1490,
        "y": 440,
        "wires": [
            [
                "99eeb7d8.8caeb8"
            ]
        ]
    },
    {
        "id": "df254ac2.220318",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 460,
        "wires": [
            [
                "9c8ff821.d99f48"
            ]
        ]
    },
    {
        "id": "89d0b2b7.ea426",
        "type": "switch",
        "z": "1c88039c.df631c",
        "d": true,
        "name": "",
        "property": "platform.applications[0].statusText",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "Youtube",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "Plex",
                "vt": "str"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 570,
        "y": 340,
        "wires": [
            [
                "49d893b7.f4e99c"
            ],
            [
                "28e6418d.dfba6e"
            ],
            []
        ]
    },
    {
        "id": "49d893b7.f4e99c",
        "type": "function",
        "z": "1c88039c.df631c",
        "name": "Text: Youtube",
        "func": "msg.text = \"You are watching Youtube\";\nmsg.emitVolume = 20;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 780,
        "y": 320,
        "wires": [
            [
                "1484b9d6.aaa5c6"
            ]
        ]
    },
    {
        "id": "28e6418d.dfba6e",
        "type": "function",
        "z": "1c88039c.df631c",
        "name": "Text: Plex",
        "func": "msg.text = \"You are watching Plex\";\nmsg.emitVolume = 20;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 760,
        "y": 360,
        "wires": [
            [
                "1484b9d6.aaa5c6"
            ]
        ]
    },
    {
        "id": "1484b9d6.aaa5c6",
        "type": "link out",
        "z": "1c88039c.df631c",
        "name": "Shield app",
        "links": [],
        "x": 965,
        "y": 340,
        "wires": []
    },
    {
        "id": "dfb84673.fd6598",
        "type": "switch",
        "z": "1c88039c.df631c",
        "d": true,
        "name": "",
        "property": "platform.applications[0].statusText",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 450,
        "y": 400,
        "wires": [
            [
                "2cac3554.e5dc5a"
            ]
        ]
    },
    {
        "id": "347b2f4c.11cd",
        "type": "function",
        "z": "1c88039c.df631c",
        "name": "Text: Youtube",
        "func": "msg.text = \"You are watching\" + msg.platform.applications[0].statusText;\nmsg.emitVolume = 20;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 780,
        "y": 400,
        "wires": [
            [
                "1484b9d6.aaa5c6"
            ]
        ]
    },
    {
        "id": "2cac3554.e5dc5a",
        "type": "delay",
        "z": "1c88039c.df631c",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "outputs": 1,
        "x": 600,
        "y": 400,
        "wires": [
            [
                "347b2f4c.11cd"
            ]
        ]
    },
    {
        "id": "3ecbdbdc32d7e425",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "set isStandBy",
        "rules": [
            {
                "t": "set",
                "p": "isStandBy",
                "pt": "global",
                "to": "platform.isStandBy",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 640,
        "wires": [
            [
                "e9bb9204.50585",
                "f93ecd35785e6032"
            ]
        ]
    },
    {
        "id": "f93ecd35785e6032",
        "type": "switch",
        "z": "1c88039c.df631c",
        "name": "Player state playing",
        "property": "payload.playerState",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "PLAYING",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "PAUSED",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 570,
        "y": 720,
        "wires": [
            [
                "e2ea86d61ab387e5"
            ],
            [],
            [
                "0eccc6337151cd8d"
            ]
        ]
    },
    {
        "id": "e2ea86d61ab387e5",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "is_playing",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "K-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 720,
        "wires": [
            [
                "75519ca452dd85c3"
            ]
        ]
    },
    {
        "id": "7207e65ef67dab2d",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "B-Presence",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1080,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "13862cdd3cdbbc65",
        "type": "switch",
        "z": "1c88039c.df631c",
        "name": "",
        "property": "platform.isStandBy",
        "propertyType": "msg",
        "rules": [
            {
                "t": "null"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 390,
        "y": 600,
        "wires": [
            [
                "c1704d628dc827c6"
            ],
            [
                "3ecbdbdc32d7e425"
            ]
        ]
    },
    {
        "id": "c1704d628dc827c6",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "isStandBy",
        "rules": [
            {
                "t": "set",
                "p": "isStandBy",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 600,
        "wires": [
            [
                "f93ecd35785e6032"
            ]
        ]
    },
    {
        "id": "0eccc6337151cd8d",
        "type": "change",
        "z": "1c88039c.df631c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "is_playing",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "K-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 760,
        "wires": [
            [
                "75519ca452dd85c3"
            ]
        ]
    },
    {
        "id": "9aaac14aa0dcc552",
        "type": "link out",
        "z": "1c88039c.df631c",
        "d": true,
        "name": "link out 13",
        "mode": "link",
        "links": [
            "fb7b621287bb03dc"
        ],
        "x": 1365,
        "y": 760,
        "wires": []
    },
    {
        "id": "75519ca452dd85c3",
        "type": "subflow:05933d2d8abb4be7",
        "z": "1c88039c.df631c",
        "name": "",
        "x": 1150,
        "y": 780,
        "wires": [
            [
                "9aaac14aa0dcc552"
            ],
            []
        ]
    },
    {
        "id": "4d769e70a92d266c",
        "type": "link out",
        "z": "1c88039c.df631c",
        "name": "SHIELD OFF",
        "mode": "link",
        "links": [],
        "x": 1385,
        "y": 560,
        "wires": []
    },
    {
        "id": "c4c2684c239161a6",
        "type": "link out",
        "z": "1c88039c.df631c",
        "name": "SHIELD ON",
        "mode": "link",
        "links": [],
        "x": 1385,
        "y": 600,
        "wires": []
    },
    {
        "id": "eed7282d01b63243",
        "type": "trigger",
        "z": "1c88039c.df631c",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "5",
        "extend": false,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 580,
        "y": 540,
        "wires": [
            [
                "81af6cca.e9c66",
                "13862cdd3cdbbc65"
            ]
        ]
    },
    {
        "id": "b590b37dc0fbc282",
        "type": "function",
        "z": "a9a601907d96eb09",
        "name": "FP2 Presence + Activity Tracking",
        "func": "// Store FP2 presence state\nflow.set('fp2_presence', msg.payload);\n\n// Track last activity time when presence detected\nif (msg.payload === true) {\n    flow.set('lastActivityTime', Date.now());\n    node.status({fill: \"green\", shape: \"dot\", text: \"Active: \" + new Date().toLocaleTimeString()});\n} else {\n    node.status({fill: \"grey\", shape: \"ring\", text: \"Inactive\"});\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 240,
        "wires": [
            [
                "bdc7a6b2a2bf8285",
                "ba_ui_fp2_format"
            ]
        ]
    },
    {
        "id": "d9f59e6e05f7c5b4",
        "type": "link in",
        "z": "a9a601907d96eb09",
        "name": "Aqara FP2",
        "links": [
            "ca84a21742d3e0cd"
        ],
        "x": 185,
        "y": 240,
        "wires": [
            [
                "b590b37dc0fbc282"
            ]
        ]
    },
    {
        "id": "bdc7a6b2a2bf8285",
        "type": "switch",
        "z": "a9a601907d96eb09",
        "name": "ON",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 590,
        "y": 400,
        "wires": [
            [
                "fd9acad7f44237b8",
                "574aa3734542d7dc",
                "dc59445212c92f7c"
            ]
        ]
    },
    {
        "id": "574aa3734542d7dc",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 740,
        "y": 440,
        "wires": [
            [
                "12daafe786835f3a",
                "c91ca09967cda70e"
            ]
        ]
    },
    {
        "id": "dc2a2ebf5212b35b",
        "type": "function",
        "z": "a9a601907d96eb09",
        "name": "Movement + Activity Tracking",
        "func": "// Store movement state\nflow.set('movement', msg.payload);\n\n// Track last activity time when movement detected\nif (msg.payload === true) {\n    flow.set('lastActivityTime', Date.now());\n    node.status({fill: \"blue\", shape: \"dot\", text: \"Motion: \" + new Date().toLocaleTimeString()});\n} else {\n    node.status({fill: \"grey\", shape: \"ring\", text: \"No motion\"});\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 320,
        "wires": [
            [
                "bdc7a6b2a2bf8285",
                "703541eac38a33b4",
                "ba_ui_movement_format"
            ]
        ]
    },
    {
        "id": "9a6c7e2adae19dbe",
        "type": "function",
        "z": "a9a601907d96eb09",
        "name": "Door State Tracker",
        "func": "// Store door state (true = open, false = closed)\nflow.set('door_open', msg.payload);\n\n// Update activity time when door opens (entering bathroom)\nif (msg.payload === true) {\n    flow.set('lastActivityTime', Date.now());\n    node.status({fill: \"red\", shape: \"dot\", text: \"Door OPEN\"});\n} else {\n    node.status({fill: \"green\", shape: \"ring\", text: \"Door CLOSED\"});\n}\n\n// Trigger dashboard updates\nnode.send([null, null, {payload: true}]);\n\n// Route to appropriate output\nif (msg.payload === true) {\n    return [msg, null, null]; // Output 1: door opened\n} else {\n    return [null, msg, null]; // Output 2: door closed\n}",
        "outputs": 3,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 440,
        "wires": [
            [
                "bdc7a6b2a2bf8285"
            ],
            [],
            [
                "ba_ui_activity_format",
                "ba_ui_protection_format"
            ]
        ]
    },
    {
        "id": "2ebf80ed57b96fc3",
        "type": "time-range-switch",
        "z": "a9a601907d96eb09",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:00",
        "endTime": "21:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 990,
        "y": 400,
        "wires": [
            [
                "e06c1ce2758c7f85"
            ],
            [
                "f6c1c04e41814de2"
            ]
        ]
    },
    {
        "id": "12daafe786835f3a",
        "type": "trigger",
        "z": "a9a601907d96eb09",
        "name": "",
        "op1": "true",
        "op2": "false",
        "op1type": "bool",
        "op2type": "bool",
        "duration": "2",
        "extend": false,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1050,
        "y": 280,
        "wires": [
            [
                "8c0c34a86ebdc4bb"
            ]
        ]
    },
    {
        "id": "c840b6850a9f9370",
        "type": "link in",
        "z": "a9a601907d96eb09",
        "name": "Batroom_Movement",
        "links": [
            "455faa8d.6c9aa4"
        ],
        "x": 255,
        "y": 320,
        "wires": [
            [
                "dc2a2ebf5212b35b"
            ]
        ]
    },
    {
        "id": "ea645748ca3e406e",
        "type": "link in",
        "z": "a9a601907d96eb09",
        "name": "Bathroom_Door",
        "links": [
            "dc7a9dbe.e7065"
        ],
        "x": 255,
        "y": 400,
        "wires": [
            [
                "6381072ee0756353"
            ]
        ]
    },
    {
        "id": "e06c1ce2758c7f85",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "Day",
        "rules": [
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "100",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1130,
        "y": 400,
        "wires": [
            [
                "9a055681e2b48e5d"
            ]
        ]
    },
    {
        "id": "f6c1c04e41814de2",
        "type": "time-range-switch",
        "z": "a9a601907d96eb09",
        "name": "Natt",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "21:00",
        "endTime": "23:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 990,
        "y": 460,
        "wires": [
            [
                "431b24da5c1cf8a9"
            ],
            [
                "6e23ce00bcce09a8"
            ]
        ]
    },
    {
        "id": "694353d781c790bc",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "bathroom OFF",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "BA-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "islight_on",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1360,
        "y": 280,
        "wires": [
            [
                "a9eef7ebd0b8a98e",
                "2cd7beb6601eb278",
                "489a70e46708be19"
            ]
        ]
    },
    {
        "id": "2cd7beb6601eb278",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "BA-Presence",
        "rules": [
            {
                "t": "set",
                "p": "BA-Presence",
                "pt": "global",
                "to": "islight_on",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1630,
        "y": 280,
        "wires": [
            [
                "4c1858d290c94d44"
            ]
        ]
    },
    {
        "id": "431b24da5c1cf8a9",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "Evening",
        "rules": [
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "30",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 440,
        "wires": [
            [
                "9a055681e2b48e5d"
            ]
        ]
    },
    {
        "id": "6e23ce00bcce09a8",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "Night",
        "rules": [
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "15",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1130,
        "y": 480,
        "wires": [
            [
                "9a055681e2b48e5d"
            ]
        ]
    },
    {
        "id": "4c1858d290c94d44",
        "type": "link out",
        "z": "a9a601907d96eb09",
        "name": "",
        "mode": "link",
        "links": [
            "e8a10173e53f4a16"
        ],
        "x": 1765,
        "y": 280,
        "wires": []
    },
    {
        "id": "759977ced6b96acf",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "bathroom ON",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "BA-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "percent_bathroom",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "islight_on",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1360,
        "y": 320,
        "wires": [
            [
                "a9eef7ebd0b8a98e",
                "2cd7beb6601eb278",
                "d75a3fcd498a1213"
            ]
        ]
    },
    {
        "id": "0d76a80b287e9f32",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "percent_bathroom",
        "rules": [
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "status.state.dimlevel",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2010,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "cd274e19cc986be4",
        "type": "Thing List",
        "z": "a9a601907d96eb09",
        "nodeName": "bathroom",
        "outputType": "individual",
        "outputValue": "thing",
        "property": "status",
        "discardInput": false,
        "rules": [
            {
                "compare": "eq",
                "thingProp": "name",
                "value": "bathroom",
                "type": "str"
            }
        ],
        "x": 1800,
        "y": 320,
        "wires": [
            [
                "0d76a80b287e9f32"
            ]
        ]
    },
    {
        "id": "6381072ee0756353",
        "type": "ui-switch",
        "z": "a9a601907d96eb09",
        "name": "",
        "label": "DOOR",
        "group": "1257d664fb2a5f32",
        "order": 2,
        "width": 1,
        "height": "1",
        "passthru": true,
        "decouple": false,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "layout": "",
        "clickableArea": "switch",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "lock-open",
        "oncolor": "red",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "lock",
        "offcolor": "greed",
        "x": 410,
        "y": 400,
        "wires": [
            [
                "9a6c7e2adae19dbe"
            ]
        ]
    },
    {
        "id": "ba_ui_fp2_format",
        "type": "function",
        "z": "a9a601907d96eb09",
        "name": "Format FP2 Status",
        "func": "const fp2Active = flow.get('fp2_presence') || false;\nconst lastActivity = flow.get('lastActivityTime') || 0;\n\nif (fp2Active) {\n    msg.payload = \"🟢 FP2: Active\";\n} else {\n    const timeSince = Date.now() - lastActivity;\n    const minAgo = Math.floor(timeSince / 60000);\n    msg.payload = `⚫ FP2: Inactive (${minAgo}m ago)`;\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 710,
        "y": 640,
        "wires": [
            [
                "ba_ui_fp2_display"
            ]
        ]
    },
    {
        "id": "ba_ui_fp2_display",
        "type": "ui-text",
        "z": "a9a601907d96eb09",
        "group": "1257d664fb2a5f32",
        "order": 3,
        "width": 3,
        "height": "1",
        "name": "FP2 Status",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 990,
        "y": 640,
        "wires": []
    },
    {
        "id": "ba_ui_movement_format",
        "type": "function",
        "z": "a9a601907d96eb09",
        "name": "Format Movement Status",
        "func": "const movement = flow.get('movement') || false;\n\nif (movement) {\n    msg.payload = \"🔵 IR Motion: Detected\";\n} else {\n    msg.payload = \"⚫ IR Motion: Clear\";\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 560,
        "wires": [
            [
                "ba_ui_movement_display"
            ]
        ]
    },
    {
        "id": "ba_ui_movement_display",
        "type": "ui-text",
        "z": "a9a601907d96eb09",
        "group": "1257d664fb2a5f32",
        "order": 6,
        "width": 3,
        "height": "1",
        "name": "Movement Status",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 1010,
        "y": 560,
        "wires": []
    },
    {
        "id": "ba_ui_activity_format",
        "type": "function",
        "z": "a9a601907d96eb09",
        "name": "Format Activity Time",
        "func": "const lastActivity = flow.get('lastActivityTime') || 0;\nconst timeSince = Date.now() - lastActivity;\nconst minAgo = Math.floor(timeSince / 60000);\nconst secAgo = Math.floor((timeSince % 60000) / 1000);\n\nif (minAgo === 0) {\n    msg.payload = `⏱️ Last Activity: ${secAgo}s ago`;\n} else {\n    msg.payload = `⏱️ Last Activity: ${minAgo}m ${secAgo}s ago`;\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 600,
        "wires": [
            [
                "ba_ui_activity_display"
            ]
        ]
    },
    {
        "id": "ba_ui_activity_display",
        "type": "ui-text",
        "z": "a9a601907d96eb09",
        "group": "1257d664fb2a5f32",
        "order": 8,
        "width": 3,
        "height": "1",
        "name": "Last Activity",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 990,
        "y": 600,
        "wires": []
    },
    {
        "id": "ba_ui_protection_format",
        "type": "function",
        "z": "a9a601907d96eb09",
        "name": "Format Protection Status",
        "func": "const doorOpen = flow.get('door_open') || false;\nconst fp2Presence = flow.get('fp2_presence') || false;\nconst movement = flow.get('movement') || false;\nconst lastActivityTime = flow.get('lastActivityTime') || 0;\nconst timeSinceActivity = Date.now() - lastActivityTime;\nconst ACTIVITY_TIMEOUT = 4 * 60 * 1000;\n\n// Check protection rules\nif (!doorOpen && timeSinceActivity < ACTIVITY_TIMEOUT) {\n    msg.payload = \"🟡 PROTECTED: Recent activity\";\n} else if (fp2Presence && movement) {\n    msg.payload = \"🔴 PROTECTED: FP2 + Motion active\";\n} else if (fp2Presence) {\n    msg.payload = \"🟡 PROTECTED: FP2 active\";\n} else if (movement) {\n    msg.payload = \"🔵 PROTECTED: Motion detected\";\n} else {\n    const minIdle = Math.floor(timeSinceActivity / 60000);\n    msg.payload = `🟢 Safe to turn off (${minIdle}m idle)`;\n    let data = {};\n    data.payload = false;\n    node.send([null, data]);\n}\n\nreturn msg;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 520,
        "wires": [
            [
                "ba_ui_protection_display"
            ],
            [
                "c91ca09967cda70e"
            ]
        ]
    },
    {
        "id": "ba_ui_protection_display",
        "type": "ui-text",
        "z": "a9a601907d96eb09",
        "group": "1257d664fb2a5f32",
        "order": 1,
        "width": 3,
        "height": "1",
        "name": "Protection Status",
        "label": "",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 1010,
        "y": 520,
        "wires": []
    },
    {
        "id": "ba_ui_update_trigger",
        "type": "inject",
        "z": "a9a601907d96eb09",
        "name": "Update Dashboard Every 15s",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "15",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 370,
        "y": 620,
        "wires": [
            [
                "ba_ui_fp2_format",
                "ba_ui_movement_format",
                "ba_ui_protection_format"
            ]
        ]
    },
    {
        "id": "a9eef7ebd0b8a98e",
        "type": "trigger",
        "z": "a9a601907d96eb09",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "5",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1620,
        "y": 320,
        "wires": [
            [
                "cd274e19cc986be4"
            ]
        ]
    },
    {
        "id": "d75a3fcd498a1213",
        "type": "link out",
        "z": "a9a601907d96eb09",
        "name": "Reset mirror ",
        "mode": "link",
        "links": [
            "b68b07285e615789"
        ],
        "x": 1615,
        "y": 380,
        "wires": []
    },
    {
        "id": "8c0c34a86ebdc4bb",
        "type": "switch",
        "z": "a9a601907d96eb09",
        "name": "paylaod False",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1060,
        "y": 240,
        "wires": [
            [
                "41e16a5e73288fc6"
            ],
            [
                "694353d781c790bc",
                "d75a3fcd498a1213"
            ]
        ]
    },
    {
        "id": "5ae3babe85bed457",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "bathroom Dimm OFF close",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "BA-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "10",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "tmpDimmed",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "tmp_percent_bathroom",
                "pt": "flow",
                "to": "percent_bathroom",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1640,
        "y": 140,
        "wires": [
            [
                "a9eef7ebd0b8a98e",
                "4c1858d290c94d44"
            ]
        ]
    },
    {
        "id": "dc59445212c92f7c",
        "type": "switch",
        "z": "a9a601907d96eb09",
        "name": "is tmpDimmed",
        "property": "tmpDimmed",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 740,
        "y": 360,
        "wires": [
            [
                "b20ce97136a7c3a4"
            ]
        ]
    },
    {
        "id": "b20ce97136a7c3a4",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "bathroom Dimm reset",
        "rules": [
            {
                "t": "set",
                "p": "tmpDimmed",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "tmp_percent_bathroom",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1080,
        "y": 320,
        "wires": [
            [
                "759977ced6b96acf"
            ]
        ]
    },
    {
        "id": "fd9acad7f44237b8",
        "type": "switch",
        "z": "a9a601907d96eb09",
        "name": "islight_on",
        "property": "islight_on",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 720,
        "y": 400,
        "wires": [
            [],
            [
                "2ebf80ed57b96fc3"
            ]
        ]
    },
    {
        "id": "489a70e46708be19",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "islight_on",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1370,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "703541eac38a33b4",
        "type": "switch",
        "z": "a9a601907d96eb09",
        "name": "fp2_presence false",
        "property": "fp2_presence",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 710,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "9a055681e2b48e5d",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "bathroom Dimm OFF close",
        "rules": [
            {
                "t": "set",
                "p": "tmp_percent_bathroom",
                "pt": "flow",
                "to": "percent_bathroom",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1360,
        "y": 400,
        "wires": [
            [
                "759977ced6b96acf"
            ]
        ]
    },
    {
        "id": "41e16a5e73288fc6",
        "type": "time-range-switch",
        "z": "a9a601907d96eb09",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:00",
        "endTime": "21:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1210,
        "y": 140,
        "wires": [
            [
                "02eff22aca2a8ec6"
            ],
            [
                "34e93c09513999f0"
            ]
        ]
    },
    {
        "id": "02eff22aca2a8ec6",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "Set dim 75",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "75",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 100,
        "wires": [
            [
                "8ab59e27d798ed60"
            ]
        ]
    },
    {
        "id": "34e93c09513999f0",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "Set dim 15",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "15",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 140,
        "wires": [
            [
                "5ae3babe85bed457"
            ]
        ]
    },
    {
        "id": "c91ca09967cda70e",
        "type": "trigger",
        "z": "a9a601907d96eb09",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "0",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 950,
        "y": 360,
        "wires": [
            [
                "12daafe786835f3a"
            ]
        ]
    },
    {
        "id": "e87b0901614d212a",
        "type": "inject",
        "z": "a9a601907d96eb09",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 450,
        "y": 500,
        "wires": [
            [
                "574aa3734542d7dc"
            ]
        ]
    },
    {
        "id": "8ab59e27d798ed60",
        "type": "change",
        "z": "a9a601907d96eb09",
        "name": "bathroom Dimm OFF close",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "BA-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "75",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "tmpDimmed",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "tmp_percent_bathroom",
                "pt": "flow",
                "to": "percent_bathroom",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1640,
        "y": 100,
        "wires": [
            [
                "a9eef7ebd0b8a98e",
                "4c1858d290c94d44"
            ]
        ]
    },
    {
        "id": "ae45298f049b87f6",
        "type": "inject",
        "z": "a9a601907d96eb09",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "2",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 350,
        "y": 560,
        "wires": [
            [
                "ba_ui_activity_format"
            ]
        ]
    },
    {
        "id": "6dfa8a1d2171cc7d",
        "type": "inject",
        "z": "a9a601907d96eb09",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 440,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "ae311c4db6e56d39",
        "type": "switch",
        "z": "81eedfe27e202b5a",
        "name": "OFF",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 570,
        "y": 240,
        "wires": [
            [
                "37436e4d3a7713d2"
            ]
        ]
    },
    {
        "id": "d063c7cde31095b8",
        "type": "function",
        "z": "81eedfe27e202b5a",
        "name": "FP2 Presence",
        "func": "// Store FP2 presence state\nflow.set('fp2_presence', msg.payload);\n\n// Update activity timestamp when presence detected\nif (msg.payload === true) {\n    flow.set('lastActivityTime', Date.now());\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 240,
        "wires": [
            [
                "a3596ea4652f4781",
                "ae311c4db6e56d39"
            ]
        ]
    },
    {
        "id": "f627f6e01a47a3da",
        "type": "link in",
        "z": "81eedfe27e202b5a",
        "name": "Aqara FP2",
        "links": [
            "ca84a21742d3e0cd"
        ],
        "x": 255,
        "y": 240,
        "wires": [
            [
                "d063c7cde31095b8"
            ]
        ]
    },
    {
        "id": "a3596ea4652f4781",
        "type": "switch",
        "z": "81eedfe27e202b5a",
        "name": "ON",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 570,
        "y": 400,
        "wires": [
            [
                "a5298eebaa1406ae",
                "f84aec200172692f",
                "7a55227e73379517"
            ]
        ]
    },
    {
        "id": "f84aec200172692f",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 740,
        "y": 440,
        "wires": [
            [
                "b37f9344a44156eb"
            ]
        ]
    },
    {
        "id": "3459e431fca4758f",
        "type": "function",
        "z": "81eedfe27e202b5a",
        "name": "movement",
        "func": "// Store movement state\nflow.set('movement', msg.payload);\n\n// Update activity timestamp when movement detected\nif (msg.payload === true) {\n    flow.set('lastActivityTime', Date.now());\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 320,
        "wires": [
            [
                "a3596ea4652f4781",
                "23796465c61d729a"
            ]
        ]
    },
    {
        "id": "ff6e2c73d81400a7",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "Store Door State",
        "rules": [
            {
                "t": "set",
                "p": "door_open",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 440,
        "wires": [
            [
                "21a6ec0a34f66ad0"
            ]
        ]
    },
    {
        "id": "21a6ec0a34f66ad0",
        "type": "switch",
        "z": "81eedfe27e202b5a",
        "name": "Door Action",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 570,
        "y": 440,
        "wires": [
            [
                "a3596ea4652f4781"
            ],
            []
        ]
    },
    {
        "id": "34160b8f67f08a13",
        "type": "time-range-switch",
        "z": "81eedfe27e202b5a",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:00",
        "endTime": "21:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1110,
        "y": 400,
        "wires": [
            [
                "130c8e606a7ae5f6"
            ],
            [
                "d669c29570928ec8"
            ]
        ]
    },
    {
        "id": "b37f9344a44156eb",
        "type": "trigger",
        "z": "81eedfe27e202b5a",
        "name": "",
        "op1": "true",
        "op2": "false",
        "op1type": "bool",
        "op2type": "bool",
        "duration": "6",
        "extend": true,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1170,
        "y": 300,
        "wires": [
            [
                "5aa31dda5144330d"
            ]
        ]
    },
    {
        "id": "2214d9cb038cf259",
        "type": "link in",
        "z": "81eedfe27e202b5a",
        "name": "Batroom_Movement",
        "links": [
            "455faa8d.6c9aa4"
        ],
        "x": 255,
        "y": 320,
        "wires": [
            [
                "3459e431fca4758f"
            ]
        ]
    },
    {
        "id": "271f90f30bdc06b6",
        "type": "link in",
        "z": "81eedfe27e202b5a",
        "name": "Bathroom_Door",
        "links": [
            "dc7a9dbe.e7065"
        ],
        "x": 255,
        "y": 400,
        "wires": [
            [
                "520b112f818a4214"
            ]
        ]
    },
    {
        "id": "130c8e606a7ae5f6",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "Day",
        "rules": [
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "100",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1250,
        "y": 400,
        "wires": [
            [
                "a83e83d43e9fad9d"
            ]
        ]
    },
    {
        "id": "d669c29570928ec8",
        "type": "time-range-switch",
        "z": "81eedfe27e202b5a",
        "name": "Natt",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "21:00",
        "endTime": "23:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1110,
        "y": 460,
        "wires": [
            [
                "a53e1683544a2527"
            ],
            [
                "de1664c16f6c3ca3"
            ]
        ]
    },
    {
        "id": "4219203ecedf6e85",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "bathroom OFF",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "BA-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "islight_on",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1480,
        "y": 280,
        "wires": [
            [
                "b495c2b0d9420e46",
                "96746b4052bcd68d",
                "b43b03308b3a32dc"
            ]
        ]
    },
    {
        "id": "96746b4052bcd68d",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "BA-Presence",
        "rules": [
            {
                "t": "set",
                "p": "BA-Presence",
                "pt": "global",
                "to": "islight_on",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1750,
        "y": 280,
        "wires": [
            [
                "2acf2e9e39519966"
            ]
        ]
    },
    {
        "id": "a53e1683544a2527",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "Evening",
        "rules": [
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "30",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1260,
        "y": 440,
        "wires": [
            [
                "a83e83d43e9fad9d"
            ]
        ]
    },
    {
        "id": "de1664c16f6c3ca3",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "Night",
        "rules": [
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "15",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1250,
        "y": 480,
        "wires": [
            [
                "a83e83d43e9fad9d"
            ]
        ]
    },
    {
        "id": "2acf2e9e39519966",
        "type": "link out",
        "z": "81eedfe27e202b5a",
        "name": "",
        "mode": "link",
        "links": [
            "e8a10173e53f4a16"
        ],
        "x": 1885,
        "y": 280,
        "wires": []
    },
    {
        "id": "fe4e6ca838d46c7d",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "bathroom ON",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "BA-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "percent_bathroom",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "islight_on",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1480,
        "y": 320,
        "wires": [
            [
                "b495c2b0d9420e46",
                "96746b4052bcd68d",
                "94f167f5c3077859"
            ]
        ]
    },
    {
        "id": "d96187e4c5a2f765",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "percent_bathroom",
        "rules": [
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "status.state.dimlevel",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2130,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "136c3dd86f0940f4",
        "type": "Thing List",
        "z": "81eedfe27e202b5a",
        "nodeName": "bathroom",
        "outputType": "individual",
        "outputValue": "thing",
        "property": "status",
        "discardInput": false,
        "rules": [
            {
                "compare": "eq",
                "thingProp": "name",
                "value": "bathroom",
                "type": "str"
            }
        ],
        "x": 1920,
        "y": 320,
        "wires": [
            [
                "d96187e4c5a2f765"
            ]
        ]
    },
    {
        "id": "520b112f818a4214",
        "type": "ui-switch",
        "z": "81eedfe27e202b5a",
        "name": "",
        "label": "DOOR",
        "group": "1257d664fb2a5f32",
        "order": 4,
        "width": "2",
        "height": "1",
        "passthru": true,
        "decouple": false,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "lock-open",
        "oncolor": "red",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "lock",
        "offcolor": "greed",
        "x": 410,
        "y": 400,
        "wires": [
            [
                "ff6e2c73d81400a7"
            ]
        ]
    },
    {
        "id": "b495c2b0d9420e46",
        "type": "trigger",
        "z": "81eedfe27e202b5a",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "5",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1740,
        "y": 320,
        "wires": [
            [
                "136c3dd86f0940f4"
            ]
        ]
    },
    {
        "id": "94f167f5c3077859",
        "type": "link out",
        "z": "81eedfe27e202b5a",
        "name": "Reset mirror ",
        "mode": "link",
        "links": [
            "b68b07285e615789"
        ],
        "x": 1735,
        "y": 380,
        "wires": []
    },
    {
        "id": "957367a642a8f932",
        "type": "switch",
        "z": "81eedfe27e202b5a",
        "name": "islight_on",
        "property": "islight_on",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 820,
        "y": 240,
        "wires": [
            [],
            [
                "2776a0c811928535"
            ]
        ]
    },
    {
        "id": "2776a0c811928535",
        "type": "function",
        "z": "81eedfe27e202b5a",
        "name": "Door-Closed Protection",
        "func": "// Check if door is closed (false = closed, true = open)\nconst doorOpen = flow.get('door_open');\nconst fp2Presence = flow.get('fp2_presence');\nconst movement = flow.get('movement');\n\n// Get last activity time\nlet lastActivityTime = flow.get('lastActivityTime') || 0;\nconst now = Date.now();\n\n// Update activity timestamp if any sensor is active\nif (fp2Presence || movement) {\n    lastActivityTime = now;\n    flow.set('lastActivityTime', lastActivityTime);\n}\n\nconst timeSinceActivity = now - lastActivityTime;\nconst ACTIVITY_TIMEOUT = 5 * 60 * 1000; // 5 minutes\n\n// CRITICAL: Block turn-off if door is closed and recent activity\nif (!doorOpen && timeSinceActivity < ACTIVITY_TIMEOUT) {\n    node.status({\n        fill: \"yellow\",\n        shape: \"dot\",\n        text: `Door closed - blocking OFF (activity ${Math.round(timeSinceActivity/1000)}s ago)`\n    });\n    return null; // Block the message - don't start timer\n}\n\n// Allow timer to proceed\nnode.status({\n    fill: \"green\",\n    shape: \"dot\",\n    text: \"Door open or no recent activity - allowing timer\"\n});\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1030,
        "y": 200,
        "wires": [
            [
                "b37f9344a44156eb"
            ]
        ]
    },
    {
        "id": "5aa31dda5144330d",
        "type": "switch",
        "z": "81eedfe27e202b5a",
        "name": "paylaod False",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1180,
        "y": 260,
        "wires": [
            [
                "20441058ceaa89d2"
            ],
            [
                "4219203ecedf6e85",
                "94f167f5c3077859"
            ]
        ]
    },
    {
        "id": "7b60170b73c4fe03",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "bathroom Dimm OFF close",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "BA-LYS",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "75",
                "tot": "num"
            },
            {
                "t": "set",
                "p": "tmpDimmed",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "tmp_percent_bathroom",
                "pt": "flow",
                "to": "percent_bathroom",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1580,
        "y": 140,
        "wires": [
            [
                "b495c2b0d9420e46",
                "2acf2e9e39519966"
            ]
        ]
    },
    {
        "id": "7a55227e73379517",
        "type": "switch",
        "z": "81eedfe27e202b5a",
        "name": "is tmpDimmed",
        "property": "tmpDimmed",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 740,
        "y": 360,
        "wires": [
            [
                "adfcc1c9dc3626f2"
            ]
        ]
    },
    {
        "id": "adfcc1c9dc3626f2",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "bathroom Dimm reset",
        "rules": [
            {
                "t": "set",
                "p": "tmpDimmed",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "percent_bathroom",
                "pt": "flow",
                "to": "tmp_percent_bathroom",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1200,
        "y": 340,
        "wires": [
            [
                "fe4e6ca838d46c7d"
            ]
        ]
    },
    {
        "id": "a5298eebaa1406ae",
        "type": "switch",
        "z": "81eedfe27e202b5a",
        "name": "islight_on",
        "property": "islight_on",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 720,
        "y": 400,
        "wires": [
            [],
            [
                "34160b8f67f08a13"
            ]
        ]
    },
    {
        "id": "b43b03308b3a32dc",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "islight_on",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1490,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "23796465c61d729a",
        "type": "switch",
        "z": "81eedfe27e202b5a",
        "name": "fp2_presence false",
        "property": "fp2_presence",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 630,
        "y": 320,
        "wires": [
            [
                "ae311c4db6e56d39"
            ]
        ]
    },
    {
        "id": "a83e83d43e9fad9d",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "bathroom Dimm OFF close",
        "rules": [
            {
                "t": "set",
                "p": "tmp_percent_bathroom",
                "pt": "flow",
                "to": "percent_bathroom",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1480,
        "y": 400,
        "wires": [
            [
                "fe4e6ca838d46c7d"
            ]
        ]
    },
    {
        "id": "37436e4d3a7713d2",
        "type": "switch",
        "z": "81eedfe27e202b5a",
        "name": "movement false",
        "property": "movement",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 700,
        "y": 200,
        "wires": [
            [
                "957367a642a8f932"
            ]
        ]
    },
    {
        "id": "b2431ebafdbafd5b",
        "type": "inject",
        "z": "81eedfe27e202b5a",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 70,
        "y": 100,
        "wires": [
            [
                "d063c7cde31095b8"
            ]
        ]
    },
    {
        "id": "20441058ceaa89d2",
        "type": "time-range-switch",
        "z": "81eedfe27e202b5a",
        "name": "Dag",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:00",
        "endTime": "21:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1330,
        "y": 140,
        "wires": [
            [
                "2d171009544cc13a"
            ],
            [
                "5c58166e260ef9d6"
            ]
        ]
    },
    {
        "id": "2d171009544cc13a",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "Set dim 75",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "75",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1530,
        "y": 100,
        "wires": [
            [
                "7b60170b73c4fe03"
            ]
        ]
    },
    {
        "id": "5c58166e260ef9d6",
        "type": "change",
        "z": "81eedfe27e202b5a",
        "name": "Set dim 15",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "15",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1450,
        "y": 180,
        "wires": [
            [
                "7b60170b73c4fe03"
            ]
        ]
    },
    {
        "id": "a06b8b8fe054a921",
        "type": "inject",
        "z": "81eedfe27e202b5a",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 70,
        "y": 160,
        "wires": [
            [
                "d063c7cde31095b8",
                "3459e431fca4758f",
                "520b112f818a4214"
            ]
        ]
    },
    {
        "id": "c048d104fd00f2fc",
        "type": "inject",
        "z": "81eedfe27e202b5a",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 90,
        "y": 360,
        "wires": [
            [
                "520b112f818a4214"
            ]
        ]
    },
    {
        "id": "550ffc19d0f226cf",
        "type": "inject",
        "z": "81eedfe27e202b5a",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 90,
        "y": 420,
        "wires": [
            [
                "520b112f818a4214"
            ]
        ]
    },
    {
        "id": "4e6013de2aa5c07f",
        "type": "link out",
        "z": "021cd6ea3e90db93",
        "name": "",
        "mode": "link",
        "links": [
            "e1a25373.858cb"
        ],
        "x": 1252,
        "y": 300,
        "wires": []
    },
    {
        "id": "91184b0e10053eeb",
        "type": "aedes broker",
        "z": "021cd6ea3e90db93",
        "name": "Arduino",
        "mqtt_port": "1884",
        "mqtt_ws_bind": "port",
        "mqtt_ws_port": "",
        "mqtt_ws_path": "",
        "cert": "",
        "key": "",
        "certname": "",
        "keyname": "",
        "persistence_bind": "memory",
        "dburl": "",
        "usetls": false,
        "x": 370,
        "y": 300,
        "wires": [
            [
                "cc902c65355fc2a0"
            ],
            []
        ]
    },
    {
        "id": "bbb9f86114d07be5",
        "type": "mqtt in",
        "z": "021cd6ea3e90db93",
        "name": "",
        "topic": "stairs/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "5d47569e31e42f22",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 340,
        "y": 460,
        "wires": [
            [
                "35663b0957414f64"
            ]
        ]
    },
    {
        "id": "1a0e8a5610faf0f6",
        "type": "link out",
        "z": "021cd6ea3e90db93",
        "name": "",
        "mode": "link",
        "links": [
            "e1a25373.858cb"
        ],
        "x": 2305,
        "y": 460,
        "wires": []
    },
    {
        "id": "930f669a18eeef18",
        "type": "delay",
        "z": "021cd6ea3e90db93",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "6",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1980,
        "y": 460,
        "wires": [
            [
                "1a0e8a5610faf0f6",
                "1a3156237b63c2bb"
            ]
        ]
    },
    {
        "id": "4cd4b3b209ffa75f",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lst_value",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1070,
        "y": 460,
        "wires": [
            [
                "fee5b724a8ccf193"
            ]
        ]
    },
    {
        "id": "fee5b724a8ccf193",
        "type": "trigger",
        "z": "021cd6ea3e90db93",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1360,
        "y": 460,
        "wires": [
            [
                "a64baee919cee0e6"
            ]
        ]
    },
    {
        "id": "a64baee919cee0e6",
        "type": "switch",
        "z": "021cd6ea3e90db93",
        "name": "U || D",
        "property": "lst_value",
        "propertyType": "flow",
        "rules": [
            {
                "t": "btwn",
                "v": "45",
                "vt": "num",
                "v2": "90",
                "v2t": "num"
            },
            {
                "t": "lte",
                "v": "40",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1550,
        "y": 460,
        "wires": [
            [
                "5a875997eb40043b"
            ],
            [
                "ec2b0c7452e7b0f2"
            ]
        ]
    },
    {
        "id": "7678f144c5148af9",
        "type": "switch",
        "z": "021cd6ea3e90db93",
        "name": "",
        "property": "payload.client.connected",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 830,
        "y": 300,
        "wires": [
            [
                "0a16bcbd068a4386"
            ],
            [
                "051636d7f5e1c145"
            ]
        ]
    },
    {
        "id": "cc902c65355fc2a0",
        "type": "delay",
        "z": "021cd6ea3e90db93",
        "d": true,
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "3",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 540,
        "y": 300,
        "wires": [
            [
                "af83160c4353fe50"
            ]
        ]
    },
    {
        "id": "83665e5eeb0c9dd4",
        "type": "switch",
        "z": "021cd6ea3e90db93",
        "name": "is between",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "btwn",
                "v": "1",
                "vt": "num",
                "v2": "75",
                "v2t": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 850,
        "y": 460,
        "wires": [
            [
                "4cd4b3b209ffa75f"
            ]
        ]
    },
    {
        "id": "af83160c4353fe50",
        "type": "switch",
        "z": "021cd6ea3e90db93",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "clientReady",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "clientDisconnect",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 710,
        "y": 300,
        "wires": [
            [
                "7678f144c5148af9"
            ],
            [
                "7678f144c5148af9"
            ]
        ]
    },
    {
        "id": "0a16bcbd068a4386",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "payload.client.id & \"have been Connected\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1090,
        "y": 260,
        "wires": [
            [
                "4e6013de2aa5c07f"
            ]
        ]
    },
    {
        "id": "051636d7f5e1c145",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "payload.client.id & \"have been disconnected\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1090,
        "y": 300,
        "wires": [
            [
                "4e6013de2aa5c07f"
            ]
        ]
    },
    {
        "id": "5a875997eb40043b",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "going upstairs",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "up",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1780,
        "y": 440,
        "wires": [
            [
                "930f669a18eeef18"
            ]
        ]
    },
    {
        "id": "ec2b0c7452e7b0f2",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "going upstairs",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "up",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1780,
        "y": 480,
        "wires": [
            [
                "930f669a18eeef18"
            ]
        ]
    },
    {
        "id": "1a3156237b63c2bb",
        "type": "function",
        "z": "021cd6ea3e90db93",
        "name": "",
        "func": "let up_count = flow.get(\"up_count\") || 0\nlet down_count = flow.get(\"down_count\") || 0\n\nif (msg.up == true) {\n    up_count++\n    down_count--;\n} else {\n    down_count++;\n\n    up_count--\n}\n\nflow.set(\"up_count\", up_count);\nflow.set(\"down_count\", down_count);\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2340,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "35663b0957414f64",
        "type": "function",
        "z": "021cd6ea3e90db93",
        "name": "",
        "func": "let last = context.get(\"last\") | 0;\n\nlet count = parseInt(msg.payload) + parseInt(last);\n\n\nmsg.payload = parseInt(count / 2);\ncontext.set(\"last\", msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 460,
        "wires": [
            [
                "1630e5498522a364"
            ]
        ]
    },
    {
        "id": "1630e5498522a364",
        "type": "calculate",
        "z": "021cd6ea3e90db93",
        "name": "",
        "pauseType": "timed",
        "calculation": "median",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "10",
        "x": 680,
        "y": 460,
        "wires": [
            [
                "83665e5eeb0c9dd4"
            ]
        ]
    },
    {
        "id": "b7cae4186e887d19",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "up_count",
                "pt": "flow",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1650,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "a1d7f615b671ac4d",
        "type": "inject",
        "z": "021cd6ea3e90db93",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1460,
        "y": 140,
        "wires": [
            [
                "b7cae4186e887d19"
            ]
        ]
    },
    {
        "id": "4b34abe0a4611149",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "up_count",
                "pt": "flow",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1660,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "b9e501c4f7f1e14b",
        "type": "inject",
        "z": "021cd6ea3e90db93",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1470,
        "y": 100,
        "wires": [
            [
                "4b34abe0a4611149"
            ]
        ]
    },
    {
        "id": "df80adcae9312ebf",
        "type": "mqtt in",
        "z": "021cd6ea3e90db93",
        "name": "",
        "topic": "stairs/debug",
        "qos": "2",
        "datatype": "auto",
        "broker": "5d47569e31e42f22",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 330,
        "y": 680,
        "wires": [
            [
                "6801af662fb02bd3"
            ]
        ]
    },
    {
        "id": "23e030a9e19f898b",
        "type": "debug",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "DEBUG",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload.distance",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1280,
        "y": 1420,
        "wires": []
    },
    {
        "id": "8981156258330374",
        "type": "mqtt in",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "Bluetooth presence",
        "topic": "espresense/rooms/stair",
        "qos": "2",
        "datatype": "auto",
        "broker": "5d47569e31e42f22",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 590,
        "y": 1420,
        "wires": [
            [
                "711accb21e6923cb"
            ]
        ]
    },
    {
        "id": "711accb21e6923cb",
        "type": "json",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 770,
        "y": 1420,
        "wires": [
            [
                "8a70081184fd9d2f",
                "d6258c7d724e2714",
                "915e541148107f9f"
            ]
        ]
    },
    {
        "id": "8cd527805b016174",
        "type": "function",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "",
        "func": "\nvar Devices = flow.get(\"Devices\")|| {}\nlet id = msg.payload.id\nDevices[id] = msg.payload.mac\n\n\n      \n\n\n\nflow.set(\"Devices\", Devices)\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1240,
        "y": 1480,
        "wires": [
            []
        ]
    },
    {
        "id": "8a70081184fd9d2f",
        "type": "delay",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 900,
        "y": 1480,
        "wires": [
            [
                "8cd527805b016174"
            ]
        ]
    },
    {
        "id": "d6258c7d724e2714",
        "type": "switch",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "",
        "property": "payload.distance",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "0.5",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 950,
        "y": 1420,
        "wires": [
            [
                "277f89239aa44fc7"
            ]
        ]
    },
    {
        "id": "915e541148107f9f",
        "type": "switch",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "mac adress",
        "property": "msg.payload.id",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "exp:20",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1090,
        "y": 1480,
        "wires": [
            [
                "7079d27f6152cac0",
                "23e030a9e19f898b"
            ]
        ]
    },
    {
        "id": "7079d27f6152cac0",
        "type": "switch",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "Close",
        "property": "payload.distance",
        "propertyType": "msg",
        "rules": [
            {
                "t": "lt",
                "v": "1",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1270,
        "y": 1540,
        "wires": [
            [
                "ae12affc3eb4dc45"
            ]
        ]
    },
    {
        "id": "ae12affc3eb4dc45",
        "type": "trigger",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "",
        "op1": "Øivind are in the office",
        "op2": "Øivind are not in the office",
        "op1type": "str",
        "op2type": "str",
        "duration": "15",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1490,
        "y": 1540,
        "wires": [
            [
                "1f50ac0d5a21f7ce",
                "f56836e5626dc00d"
            ]
        ]
    },
    {
        "id": "1f50ac0d5a21f7ce",
        "type": "debug",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "DEBUG",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1480,
        "y": 1480,
        "wires": []
    },
    {
        "id": "19242790ba73e3ef",
        "type": "link out",
        "z": "021cd6ea3e90db93",
        "d": true,
        "name": "",
        "mode": "link",
        "links": [
            "e1a25373.858cb"
        ],
        "x": 2025,
        "y": 1360,
        "wires": []
    },
    {
        "id": "f56836e5626dc00d",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1773,
        "y": 1360,
        "wires": [
            [
                "19242790ba73e3ef",
                "a84ac6f3a352ff80"
            ]
        ]
    },
    {
        "id": "277f89239aa44fc7",
        "type": "function",
        "z": "021cd6ea3e90db93",
        "d": true,
        "g": "9bb3180dbbe92370",
        "name": "",
        "func": "\nvar Devices = flow.get(\"Close\")|| {}\nlet id = msg.payload.id\nDevices[id] = msg.payload.mac\n\n\n      \n\n\n\nflow.set(\"Close\", Devices)\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1360,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "6801af662fb02bd3",
        "type": "switch",
        "z": "021cd6ea3e90db93",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "stairs/debug",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "stairs/number/staircounter/state",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 520,
        "y": 680,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "ee9a5ebf536be5a1",
        "type": "json",
        "z": "021cd6ea3e90db93",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 813,
        "y": 1400,
        "wires": [
            [
                "3d8eb5f097ce5a24"
            ]
        ]
    },
    {
        "id": "db80c49b2d23831b",
        "type": "debug",
        "z": "021cd6ea3e90db93",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1313,
        "y": 1460,
        "wires": []
    },
    {
        "id": "3d8eb5f097ce5a24",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "stairCount",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"There are \" & $flowContext(\"stairCount\") & \"Downstairs\"\t ",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1053,
        "y": 1400,
        "wires": [
            [
                "db80c49b2d23831b",
                "f56836e5626dc00d"
            ]
        ]
    },
    {
        "id": "a84ac6f3a352ff80",
        "type": "link out",
        "z": "021cd6ea3e90db93",
        "d": true,
        "name": "",
        "mode": "link",
        "links": [
            "662ff2faf119d193"
        ],
        "x": 2018,
        "y": 1320,
        "wires": []
    },
    {
        "id": "b526c7e6f3d3f11a",
        "type": "mqtt in",
        "z": "021cd6ea3e90db93",
        "name": "",
        "topic": "hall/debug",
        "qos": "2",
        "datatype": "auto",
        "broker": "5d47569e31e42f22",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 300,
        "y": 620,
        "wires": [
            [
                "8ba3f0a0c27b8578"
            ]
        ]
    },
    {
        "id": "52b90438422286d4",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "people",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "\"there are \" & payload & \"people in the house\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1070,
        "y": 420,
        "wires": [
            [
                "4e6013de2aa5c07f"
            ]
        ]
    },
    {
        "id": "54f2cb1467a0b769",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "person",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "\"there are \" & payload & \"person in the house\"",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1070,
        "y": 380,
        "wires": [
            [
                "4e6013de2aa5c07f"
            ]
        ]
    },
    {
        "id": "d499806d22f9fbb3",
        "type": "switch",
        "z": "021cd6ea3e90db93",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 940,
        "y": 400,
        "wires": [
            [
                "54f2cb1467a0b769"
            ],
            [
                "52b90438422286d4"
            ]
        ]
    },
    {
        "id": "85874d19114f788d",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "peopleUpstairs",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 840,
        "wires": [
            [
                "c7221f2791289568"
            ]
        ]
    },
    {
        "id": "121bdd895c2f1815",
        "type": "function",
        "z": "021cd6ea3e90db93",
        "name": "",
        "func": "let value = msg.payload;\nlet upstairs = global.get(\"peopleUpstairs\");\nif(value == true){\n\nupstairs ++;\n\n}else if (value == false){\n    upstairs --;\n}\n\nglobal.set(\"peopleUpstairs\", upstairs);",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 550,
        "y": 840,
        "wires": [
            [
                "85874d19114f788d"
            ]
        ]
    },
    {
        "id": "9d549e13d9b28066",
        "type": "json",
        "z": "021cd6ea3e90db93",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 920,
        "wires": [
            [
                "85874d19114f788d"
            ]
        ]
    },
    {
        "id": "7af2ddb53f4a4443",
        "type": "link in",
        "z": "021cd6ea3e90db93",
        "name": "PeopleCount",
        "links": [],
        "x": 405,
        "y": 840,
        "wires": [
            [
                "121bdd895c2f1815"
            ]
        ]
    },
    {
        "id": "888d7786eb85ecde",
        "type": "mqtt in",
        "z": "021cd6ea3e90db93",
        "name": "state",
        "topic": "hall/number/#",
        "qos": "2",
        "datatype": "auto",
        "broker": "5d47569e31e42f22",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 390,
        "y": 980,
        "wires": [
            [
                "9d549e13d9b28066"
            ]
        ]
    },
    {
        "id": "c7221f2791289568",
        "type": "function",
        "z": "021cd6ea3e90db93",
        "name": "",
        "func": "let down = global.get(\"peopleDownstairs\") || 0 ;\nlet up = global.get(\"peopleUpstairs\");\nlet total = down + up;\n\nif(down == 0){\n    global.set(\"peopleDownstairs\", down)\n}\n\n\nmsg.payload = down;\nmsg.topic = \"mirror/downstairs\";\nnode.send(msg);\n\nmsg.payload = up;\nmsg.topic = \"mirror/upstairs\";\nnode.send(msg);\n\nmsg.payload = total;\nmsg.topic = \"mirror/persons\";\nnode.send(msg);\nvar message = {};\nif(total >2){\n    msg.payload = total -2;\n    msg.topic = \"mirror/guests\";\n    node.send(msg);\n    // message.text = \"There are \" + msg.payload + \" Guests \";\n    if(msg.payload == 1 ){\n        message.text = \"There are \" + msg.payload + \" Guest \";\n    }\n   \n    node.send([null, message]);\n}else{\n    msg.payload = 0;\n    msg.topic = \"mirror/guests\";\n    node.send(msg);\n \n    // message.text = \"There are NO Guests \"\n    // node.send([null, message]);\n}\n\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1040,
        "y": 840,
        "wires": [
            [
                "9732e4475cdba75e"
            ],
            [
                "357cd3912cb4b9bf"
            ]
        ]
    },
    {
        "id": "e22089f94174d570",
        "type": "link in",
        "z": "021cd6ea3e90db93",
        "d": true,
        "name": "Update Mirror",
        "links": [
            "328ec247.9e5eee"
        ],
        "x": 875,
        "y": 800,
        "wires": [
            [
                "c7221f2791289568"
            ]
        ]
    },
    {
        "id": "9732e4475cdba75e",
        "type": "json",
        "z": "021cd6ea3e90db93",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1190,
        "y": 840,
        "wires": [
            [
                "3947729dea97def1",
                "86b26471abf46099"
            ]
        ]
    },
    {
        "id": "357cd3912cb4b9bf",
        "type": "link out",
        "z": "021cd6ea3e90db93",
        "d": true,
        "name": "",
        "mode": "link",
        "links": [
            "278706f49dd302bf"
        ],
        "x": 1165,
        "y": 900,
        "wires": []
    },
    {
        "id": "8de8993ab6bbc967",
        "type": "change",
        "z": "021cd6ea3e90db93",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "(\t   $upstairs :=  (\t       $globalContext(\"peopleUpstairs\") + $globalContext(\"peopleDownstairs\") \t   );\t   $upstairs = 1 ? \"there are \" &$upstairs&\t\" Person at Home\" :  $upstairs = 0 ? \"There are no one home\" :  $upstairs > 2 ? \"There are \" &\t   ($upstairs - 2) & \" Guests\":\t\"there are \" & $upstairs &\" Persons at Home\"\t)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1570,
        "y": 800,
        "wires": [
            [
                "f803dc8c9371fd5f"
            ]
        ]
    },
    {
        "id": "3947729dea97def1",
        "type": "mqtt out",
        "z": "021cd6ea3e90db93",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "5d47569e31e42f22",
        "x": 1370,
        "y": 840,
        "wires": []
    },
    {
        "id": "f803dc8c9371fd5f",
        "type": "link out",
        "z": "021cd6ea3e90db93",
        "d": true,
        "name": "",
        "mode": "link",
        "links": [
            "662ff2faf119d193"
        ],
        "x": 1675,
        "y": 800,
        "wires": []
    },
    {
        "id": "ff116dfe744534de",
        "type": "mqtt in",
        "z": "021cd6ea3e90db93",
        "name": "",
        "topic": "hall/number/hallcounter/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "5d47569e31e42f22",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 300,
        "y": 920,
        "wires": [
            [
                "9d549e13d9b28066"
            ]
        ]
    },
    {
        "id": "86b26471abf46099",
        "type": "trigger",
        "z": "021cd6ea3e90db93",
        "name": "",
        "op1": "",
        "op2": "true",
        "op1type": "nul",
        "op2type": "bool",
        "duration": "250",
        "extend": true,
        "overrideDelay": false,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1400,
        "y": 800,
        "wires": [
            [
                "8de8993ab6bbc967"
            ]
        ]
    },
    {
        "id": "8ba3f0a0c27b8578",
        "type": "function",
        "z": "021cd6ea3e90db93",
        "name": "function 1",
        "func": "msg.payload = msg.payload.toString()\nlet hallDebug = flow.get(\"hallDebug\") || [];\n\nhallDebug.push(msg.payload);\n\nflow.set(\"hallDebug\", hallDebug);\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "3a621e1.6c980e2",
        "type": "inject",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "18000",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "topic": "",
        "payload": "{   viewer {     home(id: \"142c1670-ab43-2ab3-ba6d-723703a551e2\") {       currentSubscription{         priceInfo{           today {             total             energy             tax             startsAt           }           tomorrow {             total             energy             tax             startsAt           }         }       }     }   } }",
        "payloadType": "str",
        "x": 130,
        "y": 80,
        "wires": [
            [
                "459349dfcd1788c8"
            ]
        ]
    },
    {
        "id": "1f5b698b.c40ec6",
        "type": "tibber-feed",
        "z": "15652aa.fd5c4d5",
        "name": "Heggland",
        "active": true,
        "apiEndpointRef": "3d2f09b6c7faaec7",
        "homeId": "50c631b0-94da-4fd9-ac4c-f767e223de07",
        "timestamp": false,
        "power": true,
        "lastMeterConsumption": true,
        "accumulatedConsumption": true,
        "accumulatedProduction": false,
        "accumulatedConsumptionLastHour": true,
        "accumulatedProductionLastHour": false,
        "accumulatedCost": false,
        "accumulatedReward": false,
        "currency": false,
        "minPower": false,
        "averagePower": false,
        "maxPower": false,
        "powerProduction": false,
        "minPowerProduction": false,
        "maxPowerProduction": false,
        "lastMeterProduction": false,
        "powerFactor": false,
        "voltagePhase1": false,
        "voltagePhase2": false,
        "voltagePhase3": false,
        "currentL1": false,
        "currentL2": false,
        "currentL3": false,
        "signalStrength": false,
        "x": 140,
        "y": 780,
        "wires": [
            [
                "1e7116aeb4426982"
            ]
        ]
    },
    {
        "id": "4d90c0d9.a283f",
        "type": "tibber-query",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "active": true,
        "apiEndpointRef": "3d2f09b6c7faaec7",
        "x": 470,
        "y": 80,
        "wires": [
            [
                "264aa2ac0ba723fa"
            ]
        ]
    },
    {
        "id": "fb875b11.4c9c18",
        "type": "tibber-notify",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "active": true,
        "apiEndpointRef": "3d2f09b6c7faaec7",
        "notifyTitle": "",
        "notifyMessage": "",
        "notifyScreen": "",
        "x": 430,
        "y": 160,
        "wires": []
    },
    {
        "id": "1f3d8f53.3561c1",
        "type": "inject",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"title\":\"Test\",\"message\":\"This is a simple test\",\"screen\":\"HOME\"}",
        "payloadType": "json",
        "x": 220,
        "y": 160,
        "wires": [
            [
                "fb875b11.4c9c18"
            ]
        ]
    },
    {
        "id": "0911a3e961c90766",
        "type": "switch",
        "z": "15652aa.fd5c4d5",
        "name": "Current Power",
        "property": "payload.power",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "4500",
                "vt": "num"
            },
            {
                "t": "lte",
                "v": "3500",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 500,
        "y": 780,
        "wires": [
            [
                "5893340b1743a6a1"
            ],
            [
                "7543444ed89d60f0"
            ]
        ]
    },
    {
        "id": "fe09f6b01a7587a0",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "Power HIGH",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "\"Power Usage is HIGH: Power is at \" &payload.power ",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1170,
        "y": 780,
        "wires": [
            [
                "bd2186f08e42c63b"
            ]
        ]
    },
    {
        "id": "858b8605826bec63",
        "type": "link out",
        "z": "15652aa.fd5c4d5",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "5cfbdbd83670143c"
        ],
        "x": 1525,
        "y": 780,
        "wires": []
    },
    {
        "id": "052f3d28a092f444",
        "type": "trigger",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "10",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 990,
        "y": 780,
        "wires": [
            [
                "fe09f6b01a7587a0"
            ]
        ]
    },
    {
        "id": "7543444ed89d60f0",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "Reset last_measured",
        "rules": [
            {
                "t": "set",
                "p": "last_measured",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "459349dfcd1788c8",
        "type": "function",
        "z": "15652aa.fd5c4d5",
        "name": "Single Home",
        "func": "msg.payload =\n\"{   viewer { home(id: \\\"50c631b0-94da-4fd9-ac4c-f767e223de07\\\") {currentSubscription{  priceInfo{today {  total  energy  tax  startsAt}tomorrow {  total  energy  tax  startsAt}  }} }   } }\"\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 80,
        "wires": [
            [
                "4d90c0d9.a283f"
            ]
        ]
    },
    {
        "id": "e0f4bc77f36c022a",
        "type": "link out",
        "z": "15652aa.fd5c4d5",
        "d": true,
        "name": "link out 2",
        "mode": "link",
        "links": [
            "5cfbdbd83670143c"
        ],
        "x": 1615,
        "y": 60,
        "wires": []
    },
    {
        "id": "207ec618a3073c3c",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "Power ON",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "Power schedule is on",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1250,
        "y": 20,
        "wires": [
            [
                "f1d6ae4de07e3bdf"
            ]
        ]
    },
    {
        "id": "67c4b006c62d09d4",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "Power OFF",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "Power cann not be used",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1250,
        "y": 60,
        "wires": [
            [
                "f1d6ae4de07e3bdf"
            ]
        ]
    },
    {
        "id": "f1d6ae4de07e3bdf",
        "type": "rbe",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": false,
        "property": "payload",
        "topi": "topic",
        "x": 1510,
        "y": 40,
        "wires": [
            [
                "e0f4bc77f36c022a"
            ]
        ]
    },
    {
        "id": "32a0b9d95d5f01ed",
        "type": "link out",
        "z": "15652aa.fd5c4d5",
        "name": "set Temperature",
        "mode": "link",
        "links": [],
        "x": 1195,
        "y": 220,
        "wires": []
    },
    {
        "id": "bd2186f08e42c63b",
        "type": "time-range-switch",
        "z": "15652aa.fd5c4d5",
        "d": true,
        "name": "",
        "lat": "58.8713",
        "lon": "5.7168",
        "startTime": "08:00",
        "endTime": "21:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1370,
        "y": 780,
        "wires": [
            [
                "858b8605826bec63"
            ],
            []
        ]
    },
    {
        "id": "cb719895315359f3",
        "type": "inject",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 500,
        "y": 820,
        "wires": [
            [
                "7543444ed89d60f0"
            ]
        ]
    },
    {
        "id": "264aa2ac0ba723fa",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "priceData",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 120,
        "wires": [
            [
                "48e83ca74d8bc7ba"
            ]
        ]
    },
    {
        "id": "7e9dc56a7125a4f5",
        "type": "inject",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "900",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "priceData",
        "payloadType": "flow",
        "x": 480,
        "y": 20,
        "wires": [
            [
                "48e83ca74d8bc7ba"
            ]
        ]
    },
    {
        "id": "b0fdfb7de098c15a",
        "type": "mqtt in",
        "z": "15652aa.fd5c4d5",
        "d": true,
        "name": "",
        "topic": "tibber/lostdata",
        "qos": "2",
        "datatype": "auto",
        "broker": "5d47569e31e42f22",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 230,
        "y": 1080,
        "wires": [
            [
                "4a8c8715361352a1",
                "2206cf804279bce4"
            ]
        ]
    },
    {
        "id": "9c907e1d118e1133",
        "type": "link out",
        "z": "15652aa.fd5c4d5",
        "d": true,
        "name": "link out 4",
        "mode": "link",
        "links": [
            "662ff2faf119d193"
        ],
        "x": 605,
        "y": 1080,
        "wires": []
    },
    {
        "id": "4a8c8715361352a1",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "Noting have been registered for 10 Minutes",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 1080,
        "wires": [
            [
                "9c907e1d118e1133"
            ]
        ]
    },
    {
        "id": "2206cf804279bce4",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "d": true,
        "name": "debug 19",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 450,
        "y": 1160,
        "wires": []
    },
    {
        "id": "5893340b1743a6a1",
        "type": "function",
        "z": "15652aa.fd5c4d5",
        "name": "Higher than last_measured",
        "func": "let last_measured = flow.get(\"last_measured\") || 0;\n\nif (msg.payload.power > last_measured){\n    last_measured = msg.payload.power\n    flow.set(\"last_measured\", last_measured);\n\nreturn msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 780,
        "y": 780,
        "wires": [
            [
                "052f3d28a092f444"
            ]
        ]
    },
    {
        "id": "6692caeafc9b13b0",
        "type": "switch",
        "z": "15652aa.fd5c4d5",
        "name": "Accumulated this hhour",
        "property": "payload.accumulatedConsumptionLastHour",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "4.6",
                "vt": "num"
            },
            {
                "t": "lte",
                "v": "0.1",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 530,
        "y": 880,
        "wires": [
            [
                "3fe4bff2327460c9"
            ],
            [
                "612b2ceb4e7d7b5a"
            ]
        ]
    },
    {
        "id": "3fe4bff2327460c9",
        "type": "trigger",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "op1": "",
        "op2": "0",
        "op1type": "pay",
        "op2type": "str",
        "duration": "0",
        "extend": false,
        "overrideDelay": false,
        "units": "ms",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 860,
        "y": 860,
        "wires": [
            [
                "b0e3b11f99e9b336"
            ]
        ]
    },
    {
        "id": "b0e3b11f99e9b336",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "Consumption HIGH",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "\" Consumption is HIGH: Consumption is at \" &payload.accumulatedConsumptionLastHour",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1190,
        "y": 860,
        "wires": [
            [
                "d18f32d84c4f3637"
            ]
        ]
    },
    {
        "id": "d18f32d84c4f3637",
        "type": "time-range-switch",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "lat": "58.8713",
        "lon": "5.7168",
        "startTime": "08:00",
        "endTime": "21:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 1390,
        "y": 860,
        "wires": [
            [
                "858b8605826bec63"
            ],
            []
        ]
    },
    {
        "id": "612b2ceb4e7d7b5a",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 860,
        "y": 900,
        "wires": [
            [
                "3fe4bff2327460c9"
            ]
        ]
    },
    {
        "id": "cebda535547a8a8c",
        "type": "inject",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "props": [
            {
                "p": "payload.accumulatedConsumptionLastHour",
                "v": "4.7",
                "vt": "num"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 220,
        "y": 920,
        "wires": [
            [
                "6692caeafc9b13b0"
            ]
        ]
    },
    {
        "id": "1e7116aeb4426982",
        "type": "delay",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "10",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 300,
        "y": 780,
        "wires": [
            [
                "0911a3e961c90766",
                "6692caeafc9b13b0"
            ]
        ]
    },
    {
        "id": "f149bfebe7926479",
        "type": "tibber-data",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "active": true,
        "apiEndpointRef": "3d2f09b6c7faaec7",
        "queryName": "getConsumption",
        "homeId": "50c631b0-94da-4fd9-ac4c-f767e223de07",
        "energyResolution": "HOURLY",
        "lastCount": 10,
        "x": 680,
        "y": 1380,
        "wires": [
            [
                "b5b385242b1f7af9"
            ]
        ]
    },
    {
        "id": "5380cad09511f7cb",
        "type": "inject",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 430,
        "y": 1360,
        "wires": [
            [
                "f149bfebe7926479"
            ]
        ]
    },
    {
        "id": "b5b385242b1f7af9",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "name": "debug 39",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 890,
        "y": 1360,
        "wires": []
    },
    {
        "id": "3a1184cc27422ca7",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "name": "Best Save",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1250,
        "y": 120,
        "wires": []
    },
    {
        "id": "137f3aca6d394e9f",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "name": "Heat Capasitor",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1260,
        "y": 260,
        "wires": []
    },
    {
        "id": "21dfbc9a84e86769",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "name": "Fixed Schedule",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1260,
        "y": 340,
        "wires": []
    },
    {
        "id": "adde7d669c054b47",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "name": "Sende til FIKTIV Temperatursensor ",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 2180,
        "y": 320,
        "wires": [],
        "icon": "font-awesome/fa-tachometer"
    },
    {
        "id": "de2b220d5addd99e",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "name": "SCHEDULE Best Save",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1290,
        "y": 160,
        "wires": []
    },
    {
        "id": "b0631605274ae7e9",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "name": "SCHEDULE Heat Capasitor",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1300,
        "y": 300,
        "wires": []
    },
    {
        "id": "a379505ca9dd0b4d",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "name": "SCHEDULE Fixed Schedule",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1300,
        "y": 380,
        "wires": []
    },
    {
        "id": "4604f10759ed4c97",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "Normalt bruk",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "22",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1890,
        "y": 240,
        "wires": [
            [
                "adde7d669c054b47"
            ]
        ]
    },
    {
        "id": "2e6e13eab2b389fb",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "strøm sparing / ECO ",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "20",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1860,
        "y": 280,
        "wires": [
            [
                "adde7d669c054b47"
            ]
        ]
    },
    {
        "id": "849ff7a6cbd29216",
        "type": "switch",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1640,
        "y": 220,
        "wires": [
            [
                "4604f10759ed4c97",
                "37672156235b99ac"
            ],
            [
                "2e6e13eab2b389fb",
                "39dba0459e4addf6"
            ]
        ]
    },
    {
        "id": "37672156235b99ac",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "Normal mode ( EKO av)",
        "rules": [
            {
                "t": "set",
                "p": "payload.ecomode",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1850,
        "y": 320,
        "wires": [
            [
                "adde7d669c054b47"
            ]
        ]
    },
    {
        "id": "39dba0459e4addf6",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "strømsparing ( EKO på) ",
        "rules": [
            {
                "t": "set",
                "p": "payload.ecomode",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1850,
        "y": 360,
        "wires": [
            [
                "adde7d669c054b47"
            ]
        ]
    },
    {
        "id": "726c55f0c8eefec2",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"config\":{\"timeHeat1C\":75,\"timeCool1C\":50,\"setpoint\":30,\"maxTempAdjustment\":0.5,\"boostTempHeat\":2,\"boostTempCool\":1,\"minSavings\":0.08}}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "payload.config.setpoint",
                "pt": "msg",
                "to": "termostatTemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 340,
        "wires": [
            [
                "eb5b458d1fc7deda",
                "9ba86ceb8e9ee185"
            ]
        ]
    },
    {
        "id": "ebe8d33d0779e942",
        "type": "inject",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 430,
        "y": 340,
        "wires": [
            [
                "726c55f0c8eefec2"
            ]
        ]
    },
    {
        "id": "eb5b458d1fc7deda",
        "type": "debug",
        "z": "15652aa.fd5c4d5",
        "name": "debug 63",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 910,
        "y": 420,
        "wires": []
    },
    {
        "id": "2df958d99789518a",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "originaltemp",
                "pt": "flow",
                "to": "termostatTemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1360,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "e9b2c70421abbddc",
        "type": "inject",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1680,
        "y": 400,
        "wires": [
            [
                "9162b6aa3d4f4acf"
            ]
        ]
    },
    {
        "id": "9162b6aa3d4f4acf",
        "type": "change",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "temperatur",
                "pt": "msg",
                "to": "originaltemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1870,
        "y": 400,
        "wires": [
            [
                "adde7d669c054b47"
            ]
        ]
    },
    {
        "id": "48e83ca74d8bc7ba",
        "type": "ps-receive-price",
        "z": "15652aa.fd5c4d5",
        "name": "Price Receiver",
        "x": 700,
        "y": 80,
        "wires": [
            [
                "9e05d9595d856561",
                "c044cd57b65b3c36",
                "311e6fcaf9f8cca9"
            ]
        ]
    },
    {
        "id": "9e05d9595d856561",
        "type": "ps-strategy-best-save",
        "z": "15652aa.fd5c4d5",
        "name": "Best Save",
        "minSaving": "0.05",
        "sendCurrentValueWhenRescheduling": true,
        "outputValueForOn": "true",
        "outputValueForOff": "true",
        "outputValueForOntype": "bool",
        "outputValueForOfftype": "bool",
        "outputIfNoSchedule": "true",
        "contextStorage": "default",
        "x": 950,
        "y": 160,
        "wires": [
            [
                "207ec618a3073c3c",
                "3a1184cc27422ca7"
            ],
            [
                "67c4b006c62d09d4",
                "3a1184cc27422ca7"
            ],
            [
                "de2b220d5addd99e"
            ]
        ]
    },
    {
        "id": "9ba86ceb8e9ee185",
        "type": "ps-strategy-heat-capacitor",
        "z": "15652aa.fd5c4d5",
        "name": "Heat capacitor",
        "timeHeat1C": "75",
        "timeCool1C": 50,
        "maxTempAdjustment": "1",
        "boostTempHeat": "0",
        "boostTempCool": "0",
        "minSavings": 0.08,
        "setpoint": "22",
        "x": 960,
        "y": 240,
        "wires": [
            [
                "32a0b9d95d5f01ed",
                "137f3aca6d394e9f",
                "b0631605274ae7e9",
                "2df958d99789518a"
            ],
            [],
            [
                "b0631605274ae7e9"
            ],
            []
        ]
    },
    {
        "id": "c044cd57b65b3c36",
        "type": "ps-strategy-fixed-schedule",
        "z": "15652aa.fd5c4d5",
        "name": "Fixed Schedule",
        "periods": [
            {
                "start": "00",
                "value": "false"
            },
            {
                "start": "07",
                "value": "true"
            }
        ],
        "validFrom": "2023-01-01",
        "validTo": "2023-12-31",
        "days": {
            "Mon": true,
            "Tue": true,
            "Wed": true,
            "Thu": true,
            "Fri": true,
            "Sat": true,
            "Sun": true
        },
        "sendCurrentValueWhenRescheduling": true,
        "outputValueForOn": "true",
        "outputValueForOff": "false",
        "outputValueForOntype": "bool",
        "outputValueForOfftype": "bool",
        "outputIfNoSchedule": "false",
        "contextStorage": "default",
        "x": 960,
        "y": 320,
        "wires": [
            [
                "21dfbc9a84e86769"
            ],
            [],
            [
                "a379505ca9dd0b4d"
            ]
        ]
    },
    {
        "id": "311e6fcaf9f8cca9",
        "type": "subflow:05933d2d8abb4be7",
        "z": "15652aa.fd5c4d5",
        "name": "",
        "x": 710,
        "y": 240,
        "wires": [
            [
                "9ba86ceb8e9ee185"
            ],
            []
        ]
    },
    {
        "id": "6521603b2e19525f",
        "type": "aedes broker",
        "z": "c83f14cc3d9b8395",
        "name": "Remote Broker",
        "mqtt_port": "1888",
        "mqtt_ws_bind": "port",
        "mqtt_ws_port": "",
        "mqtt_ws_path": "",
        "cert": "",
        "key": "",
        "certname": "",
        "keyname": "",
        "dburl": "",
        "usetls": false,
        "x": 410,
        "y": 180,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "77d1d4b3.4641ec",
        "type": "time-range-switch",
        "z": "daf28d0f20b236a4",
        "name": "",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "10:00",
        "endTime": "16:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 770,
        "y": 300,
        "wires": [
            [
                "accd6d3d.10c09"
            ],
            [
                "855d3e8b975470b7"
            ]
        ]
    },
    {
        "id": "accd6d3d.10c09",
        "type": "trigger",
        "z": "daf28d0f20b236a4",
        "name": "",
        "op1": "true",
        "op2": "",
        "op1type": "bool",
        "op2type": "nul",
        "duration": "12",
        "extend": false,
        "overrideDelay": false,
        "units": "hr",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 970,
        "y": 300,
        "wires": [
            [
                "8ea3f755.e68d88"
            ]
        ]
    },
    {
        "id": "bb323297a8af6244",
        "type": "link in",
        "z": "daf28d0f20b236a4",
        "name": "vacuum start",
        "links": [
            "247260f.c82dca"
        ],
        "x": 505,
        "y": 180,
        "wires": [
            [
                "5e0f66ea.3848a8"
            ]
        ]
    },
    {
        "id": "810548cd17705360",
        "type": "link in",
        "z": "daf28d0f20b236a4",
        "name": "vacuum stop",
        "links": [
            "fc4fe81e.444628"
        ],
        "x": 415,
        "y": 300,
        "wires": [
            [
                "77d1d4b3.4641ec"
            ]
        ]
    },
    {
        "id": "9ae92a2b.99c9c8",
        "type": "function",
        "z": "daf28d0f20b236a4",
        "name": "Convert Data",
        "func": "     msg.label = msg.payload.state_text;\n     //msg.payload = global.get(\"Mode\");\n     msg.payload = false;\n     if(msg.label === \"charging\"){\n         msg.payload = true;\n     }\n     \n     \n     msg.label = \"Mr Robot is \" + msg.label; \n     \n \nreturn msg;\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 910,
        "y": 240,
        "wires": [
            [
                "cfc5a1d05fe8095b"
            ]
        ]
    },
    {
        "id": "1f150a19.40f1f6",
        "type": "delay",
        "z": "daf28d0f20b236a4",
        "name": "",
        "pauseType": "rate",
        "timeout": "6",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "outputs": 1,
        "x": 720,
        "y": 240,
        "wires": [
            [
                "9ae92a2b.99c9c8",
                "abbe05a0ae493686"
            ]
        ]
    },
    {
        "id": "855d3e8b975470b7",
        "type": "trigger",
        "z": "daf28d0f20b236a4",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "15",
        "extend": true,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 730,
        "y": 360,
        "wires": [
            [
                "77d1d4b3.4641ec"
            ]
        ]
    },
    {
        "id": "bb0350d09c07a742",
        "type": "change",
        "z": "daf28d0f20b236a4",
        "name": "reset trigger",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 360,
        "wires": [
            [
                "855d3e8b975470b7"
            ]
        ]
    },
    {
        "id": "dd907ae5e8f3fab4",
        "type": "link in",
        "z": "daf28d0f20b236a4",
        "name": "Reset Vacum Trigger",
        "links": [
            "247260f.c82dca"
        ],
        "x": 415,
        "y": 360,
        "wires": [
            [
                "bb0350d09c07a742"
            ]
        ]
    },
    {
        "id": "cfc5a1d05fe8095b",
        "type": "ui-switch",
        "z": "daf28d0f20b236a4",
        "name": "Mr Robot Status",
        "label": "Mr Robot Status",
        "group": "3f286b473c9966df",
        "order": 7,
        "width": "2",
        "height": "1",
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "lightning-bolt",
        "oncolor": "green",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "sign-out",
        "offcolor": "red",
        "x": 1110,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "0a746840de428715",
        "type": "inject",
        "z": "daf28d0f20b236a4",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 330,
        "y": 240,
        "wires": [
            [
                "3572fdf5.48cc62"
            ]
        ]
    },
    {
        "id": "dd80e399de57df56",
        "type": "switch",
        "z": "daf28d0f20b236a4",
        "name": "",
        "property": "payload.error_code_text",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1270,
        "y": 180,
        "wires": [
            [
                "c62c40a16f3026c9"
            ]
        ]
    },
    {
        "id": "c62c40a16f3026c9",
        "type": "change",
        "z": "daf28d0f20b236a4",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "payload.error_code_text",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 180,
        "wires": [
            [
                "4cf9b6efdbba67fa"
            ]
        ]
    },
    {
        "id": "4cf9b6efdbba67fa",
        "type": "link out",
        "z": "daf28d0f20b236a4",
        "name": "link out 16",
        "mode": "link",
        "links": [
            "5cfbdbd83670143c"
        ],
        "x": 1555,
        "y": 180,
        "wires": []
    },
    {
        "id": "abbe05a0ae493686",
        "type": "switch",
        "z": "daf28d0f20b236a4",
        "name": "",
        "property": "d",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 990,
        "y": 180,
        "wires": [
            [
                "548c2b48a07ce159"
            ]
        ]
    },
    {
        "id": "548c2b48a07ce159",
        "type": "delay",
        "z": "daf28d0f20b236a4",
        "name": "rate limiter",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "15",
        "rateUnits": "minute",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 1130,
        "y": 180,
        "wires": [
            [
                "dd80e399de57df56"
            ]
        ]
    },
    {
        "id": "3572fdf5.48cc62",
        "type": "miio-roborock-event",
        "z": "daf28d0f20b236a4",
        "name": "Roborock",
        "server": "f8a9cdbf31cc2082",
        "outputAtStartup": true,
        "x": 540,
        "y": 240,
        "wires": [
            [
                "1f150a19.40f1f6"
            ]
        ]
    },
    {
        "id": "5e0f66ea.3848a8",
        "type": "miio-roborock-command",
        "z": "daf28d0f20b236a4",
        "name": "Mr Robot STOP",
        "server": "f8a9cdbf31cc2082",
        "command_name": "Dock",
        "command": "app_charge",
        "commandType": "vacuum_cmd",
        "payload": "payload",
        "payloadType": "msg",
        "coordinates": "",
        "fan_speed": 100,
        "voice_pack": null,
        "homekit_stop_to_dock": true,
        "x": 780,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "8ea3f755.e68d88",
        "type": "miio-roborock-command",
        "z": "daf28d0f20b236a4",
        "name": "Mr Robot Start",
        "server": "f8a9cdbf31cc2082",
        "command_name": "► Start",
        "command": "app_start",
        "commandType": "vacuum_cmd",
        "payload": "payload",
        "payloadType": "msg",
        "coordinates": "",
        "fan_speed": 100,
        "voice_pack": null,
        "homekit_stop_to_dock": true,
        "x": 1160,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "3933205788318785",
        "type": "inject",
        "z": "daf28d0f20b236a4",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 570,
        "y": 60,
        "wires": [
            [
                "5e0f66ea.3848a8"
            ]
        ]
    },
    {
        "id": "817f1df1.c5f98",
        "type": "exec",
        "z": "55bef9f81591ce2e",
        "g": "10af9586a4a889ef",
        "command": "node-red-restart",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 340,
        "y": 100,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "aecb8d48.af66f",
        "type": "inject",
        "z": "55bef9f81591ce2e",
        "g": "10af9586a4a889ef",
        "name": "",
        "props": [
            {
                "p": "payload",
                "v": "",
                "vt": "date"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 100,
        "wires": [
            [
                "817f1df1.c5f98"
            ]
        ]
    },
    {
        "id": "38519274c0551bb7",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "Mode",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "away",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1090,
        "y": 60,
        "wires": [
            [
                "ed4c1dbd7e3c8218"
            ],
            [
                "d8cc8d6cd6ac5ca8"
            ]
        ]
    },
    {
        "id": "ed4c1dbd7e3c8218",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "link out 11",
        "mode": "link",
        "links": [],
        "x": 1435,
        "y": 60,
        "wires": []
    },
    {
        "id": "d8cc8d6cd6ac5ca8",
        "type": "trigger",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "",
        "op1": "",
        "op2": "false",
        "op1type": "nul",
        "op2type": "bool",
        "duration": "5",
        "extend": true,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1260,
        "y": 120,
        "wires": [
            [
                "99e34fb7e0972e1e"
            ]
        ]
    },
    {
        "id": "77e202e1f7cb4c98",
        "type": "link in",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "Reset away mode",
        "links": [
            "455faa8d.6c9aa4",
            "63e9f9b.1d13608",
            "9ace10c4.4ce8f",
            "b526ea173bec8f67",
            "bc76c6da083bdd3b",
            "ca84a21742d3e0cd",
            "e92f253c.11b9b8"
        ],
        "x": 365,
        "y": 120,
        "wires": [
            [
                "e4188f47293e43df"
            ]
        ]
    },
    {
        "id": "99e34fb7e0972e1e",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "d": true,
        "g": "58a01d02b4619b46",
        "name": "link out 12",
        "mode": "link",
        "links": [
            "9e9814a999c69457"
        ],
        "x": 1525,
        "y": 120,
        "wires": []
    },
    {
        "id": "e4188f47293e43df",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "Is Movement",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": true,
        "outputs": 2,
        "x": 560,
        "y": 120,
        "wires": [
            [
                "3fc79d5f33bafedc"
            ],
            [
                "8a959998326ddd98"
            ]
        ]
    },
    {
        "id": "6504b75c810f8995",
        "type": "delay",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 940,
        "y": 60,
        "wires": [
            [
                "38519274c0551bb7"
            ]
        ]
    },
    {
        "id": "9ab71bb708f19c1b",
        "type": "change",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "delete",
                "p": "reset",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 200,
        "wires": [
            [
                "99e34fb7e0972e1e"
            ]
        ]
    },
    {
        "id": "3fc79d5f33bafedc",
        "type": "change",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 940,
        "y": 160,
        "wires": [
            [
                "9ab71bb708f19c1b",
                "d8cc8d6cd6ac5ca8",
                "cc6d1b5c216b0f73"
            ]
        ]
    },
    {
        "id": "eabe9d09ac5494a3",
        "type": "function",
        "z": "6a77c00f79a19693",
        "name": "Determine device presence",
        "func": "// @ts-nocheck\nconst lastSeenSeconds = 120;\nlet presenceCutoff = (new Date() - (lastSeenSeconds * 1000)) / 1000; \nconst people = {\n    \"presence/heggland\": \"heggland\",\n    \"presence/karina\": \"karina\",\n    \"presence/person3\": \"stian\"\n};\nlet data = {};\ndata.payload = false;\ndata.people = [];\n\n// Check for tracked phone presence\nfor (let device in msg.payload) {\n    let macadress = msg.payload[device].mac\n   \n    switch (macadress) {\n        case \"fa:9b:7e:5a:6c:6e\":\n        case \"52:9c:f0:c9:7a:bd\":\n        case \"aa:e4:74:26:ba:e3\":\n        case \"6a:a4:ac:02:44:19\":\n        case \"ce:4b:f9:34:9b:7d\":\n        case \"46:5f:50:69:f1:6a\":\n            data.people.push(\"heggland\");\n            data.payload = true;\n            break;\n        case \"d6:05:24:1f:de:7a\":\n        case \"de:61:a8:7d:7f:6f\":\n        case \"52:e0:79:65:ea:f5\":\n            data.people.push(\"karina\");\n            data.payload = true;\n            break;\n        default:\n            break;\n    } \n}\n\n// VISITOR MODE ENHANCEMENT\n// If visitor mode is active and no owner phones detected,\n// check FP2 sensors for visitor presence\nconst visitorMode = global.get('VisitorMode') || {};\nif (visitorMode.enabled === true && data.payload === false) {\n    // Check FP2 presence sensors\n    const fp2_presence = flow.get('fp2_presence');\n    const lastActivityTime = flow.get('lastActivityTime');\n    const baPresence = global.get('BA-Presence');\n    \n    // If FP2 detects presence within last 5 minutes, consider as visitor presence\n    const fiveMinutesAgo = Date.now() - (5 * 60 * 1000);\n    \n    if (fp2_presence === true || (lastActivityTime && lastActivityTime > fiveMinutesAgo) || baPresence === true) {\n        data.payload = true; // Treat as presence to prevent away mode\n        data.people.push(\"visitor\");\n        data.visitorDetected = true;\n    }\n}\n\nreturn data",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 660,
        "wires": [
            [
                "f471eaf5a8b7a9c1",
                "da091a4c003e3588"
            ]
        ],
        "outputLabels": [
            "oivheg "
        ]
    },
    {
        "id": "f471eaf5a8b7a9c1",
        "type": "function",
        "z": "6a77c00f79a19693",
        "name": "Check Phones",
        "func": "\nlet home = [{ payload: false }, { payload: false }];\nmsg.people.forEach(function(element) {\n    msg.payload =true;\n    if (element == \"heggland\"){\n       home[0].payload = true;\n        \n    }\n    if (element == \"karina\") {\n        home[1].payload = true;\n\n\n    }\n});\n\nreturn home;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 720,
        "wires": [
            [
                "d6d8cf38.1794d"
            ],
            [
                "3d692d1e.98b022"
            ]
        ]
    },
    {
        "id": "d6d8cf38.1794d",
        "type": "rbe",
        "z": "6a77c00f79a19693",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 1070,
        "y": 720,
        "wires": [
            [
                "772b0560.6b8bcc"
            ]
        ]
    },
    {
        "id": "3d692d1e.98b022",
        "type": "rbe",
        "z": "6a77c00f79a19693",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 1070,
        "y": 760,
        "wires": [
            [
                "47763aff.5ff334"
            ]
        ]
    },
    {
        "id": "772b0560.6b8bcc",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "name": "heggland",
        "mode": "link",
        "links": [
            "d871d736.d19838"
        ],
        "x": 1235,
        "y": 720,
        "wires": []
    },
    {
        "id": "47763aff.5ff334",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "name": "karina",
        "links": [
            "84abded8.462ac"
        ],
        "x": 1235,
        "y": 760,
        "wires": []
    },
    {
        "id": "05d9e9467b811a09",
        "type": "arp",
        "z": "6a77c00f79a19693",
        "name": "ARP",
        "ips": "",
        "x": 510,
        "y": 660,
        "wires": [
            [
                "eabe9d09ac5494a3",
                "923123cf470fc3e4",
                "46561a09fa8da2c4"
            ]
        ]
    },
    {
        "id": "71e547f174525c61",
        "type": "inject",
        "z": "6a77c00f79a19693",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "27",
        "crontab": "",
        "once": true,
        "onceDelay": "30",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 210,
        "y": 660,
        "wires": [
            [
                "05d9e9467b811a09"
            ]
        ]
    },
    {
        "id": "6b9eeab08f2cdd54",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "name": "Set Away",
        "mode": "link",
        "links": [
            "9e9814a999c69457"
        ],
        "x": 1445,
        "y": 680,
        "wires": []
    },
    {
        "id": "f76dc950e201b13c",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "g": "f36c921c7f424de5",
        "name": "",
        "property": "payload.ip",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "192.168.1.196",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 630,
        "y": 580,
        "wires": [
            [
                "1860791aaa644301"
            ]
        ]
    },
    {
        "id": "923123cf470fc3e4",
        "type": "split",
        "z": "6a77c00f79a19693",
        "g": "f36c921c7f424de5",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 510,
        "y": 580,
        "wires": [
            [
                "f76dc950e201b13c"
            ]
        ]
    },
    {
        "id": "bc76c6da083bdd3b",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "name": "FP2 Livingroom",
        "mode": "link",
        "links": [
            "be2ad471.d9c448",
            "77e202e1f7cb4c98"
        ],
        "x": 945,
        "y": 1100,
        "wires": []
    },
    {
        "id": "ca84a21742d3e0cd",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "name": "FP2 Bathroom",
        "mode": "link",
        "links": [
            "77e202e1f7cb4c98",
            "d9f59e6e05f7c5b4",
            "f627f6e01a47a3da"
        ],
        "x": 735,
        "y": 900,
        "wires": []
    },
    {
        "id": "cf3797c1e0b5c101",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "name": "link out 18",
        "mode": "link",
        "links": [
            "1329b56.bea634b"
        ],
        "x": 465,
        "y": 960,
        "wires": []
    },
    {
        "id": "1860791aaa644301",
        "type": "debug",
        "z": "6a77c00f79a19693",
        "g": "f36c921c7f424de5",
        "name": "debug 64",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 580,
        "wires": []
    },
    {
        "id": "2269200b466aa112",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "Maid",
        "mode": "link",
        "links": [
            "16df02f3eb3587ef",
            "f2c61516d13e4a6a"
        ],
        "x": 515,
        "y": 200,
        "wires": []
    },
    {
        "id": "ef6ae4e981532ef3",
        "type": "change",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "DogSitterMode",
        "rules": [
            {
                "t": "set",
                "p": "DogSitterMode",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "DogSitterMode turned ON ",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 580,
        "y": 240,
        "wires": [
            [
                "bb4c524ddea9d903",
                "cc6d1b5c216b0f73"
            ]
        ]
    },
    {
        "id": "2f576cac154fabea",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "DogSitterMode",
        "property": "DogSitterMode",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 950,
        "y": 100,
        "wires": [
            [
                "d8cc8d6cd6ac5ca8",
                "7f851e060826def4",
                "092abfe4f694d244"
            ]
        ]
    },
    {
        "id": "7f851e060826def4",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "d": true,
        "g": "58a01d02b4619b46",
        "name": "MaidMode",
        "mode": "link",
        "links": [
            "137603dc312c04a3"
        ],
        "x": 1235,
        "y": 80,
        "wires": []
    },
    {
        "id": "092abfe4f694d244",
        "type": "change",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "DogSitterMode",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "DogSitterMode turned OFF ",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 160,
        "wires": [
            [
                "b6a29855cdae995e"
            ]
        ]
    },
    {
        "id": "b6a29855cdae995e",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "Turn off al lights",
        "mode": "link",
        "links": [
            "5cfbdbd83670143c",
            "fa037bf9c192d1d3"
        ],
        "x": 1445,
        "y": 160,
        "wires": []
    },
    {
        "id": "5f39989d186eff71",
        "type": "subflow:05933d2d8abb4be7",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "",
        "x": 560,
        "y": 60,
        "wires": [
            [
                "6504b75c810f8995"
            ],
            [
                "2f576cac154fabea"
            ]
        ]
    },
    {
        "id": "10e22a1e9cb69adb",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "Mode",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "cont",
                "v": "home",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "sleep",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 550,
        "y": 280,
        "wires": [
            [],
            [],
            [
                "fbc0b4b628c8de0f"
            ]
        ]
    },
    {
        "id": "fbc0b4b628c8de0f",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "LOCK USER NOT MAID ",
        "mode": "link",
        "links": [
            "f27df5b9f6840243"
        ],
        "x": 675,
        "y": 300,
        "wires": []
    },
    {
        "id": "5ae85538c239b7ab",
        "type": "mqtt in",
        "z": "6a77c00f79a19693",
        "name": "FP2 Bad",
        "topic": "presence/bad",
        "qos": "1",
        "datatype": "auto-detect",
        "broker": "5d47569e31e42f22",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 280,
        "y": 920,
        "wires": [
            [
                "cf3797c1e0b5c101",
                "c60c2aeb2a5f38b4"
            ]
        ]
    },
    {
        "id": "da091a4c003e3588",
        "type": "rbe",
        "z": "6a77c00f79a19693",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": false,
        "property": "payload",
        "topi": "topic",
        "x": 1070,
        "y": 680,
        "wires": [
            [
                "cb809ab79e18fc86"
            ]
        ]
    },
    {
        "id": "9bd4ae83dda03a5e",
        "type": "link in",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "Deactivate DogSitter Mode",
        "links": [],
        "x": 355,
        "y": 60,
        "wires": [
            [
                "5f39989d186eff71"
            ]
        ]
    },
    {
        "id": "87845e6165a9844d",
        "type": "link in",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "Activate DogSitterMode",
        "links": [],
        "x": 365,
        "y": 240,
        "wires": [
            [
                "2269200b466aa112",
                "ef6ae4e981532ef3",
                "10e22a1e9cb69adb"
            ]
        ]
    },
    {
        "id": "bb4c524ddea9d903",
        "type": "link out",
        "z": "6a77c00f79a19693",
        "d": true,
        "g": "58a01d02b4619b46",
        "name": "link out 33",
        "mode": "link",
        "links": [
            "5cfbdbd83670143c"
        ],
        "x": 705,
        "y": 240,
        "wires": []
    },
    {
        "id": "cc6d1b5c216b0f73",
        "type": "trigger",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "hr",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 900,
        "y": 220,
        "wires": [
            [
                "092abfe4f694d244"
            ]
        ]
    },
    {
        "id": "8a959998326ddd98",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "g": "58a01d02b4619b46",
        "name": "DogSitterMode",
        "property": "DogSitterMode",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 640,
        "y": 160,
        "wires": [
            [
                "cc6d1b5c216b0f73"
            ]
        ]
    },
    {
        "id": "779458453f211e42",
        "type": "poll-state",
        "z": "6a77c00f79a19693",
        "name": "",
        "server": "c8d8b6d992397cb8",
        "version": 3,
        "exposeAsEntityConfig": "",
        "updateInterval": "15",
        "updateIntervalType": "num",
        "updateIntervalUnits": "minutes",
        "outputInitially": false,
        "outputOnChanged": true,
        "entityId": "sensor.aqara_fp_combined",
        "stateType": "str",
        "ifState": "",
        "ifStateType": "str",
        "ifStateOperator": "is",
        "outputs": 1,
        "outputProperties": [
            {
                "property": "payload",
                "propertyType": "msg",
                "value": "",
                "valueType": "entityState"
            },
            {
                "property": "data",
                "propertyType": "msg",
                "value": "",
                "valueType": "entity"
            },
            {
                "property": "topic",
                "propertyType": "msg",
                "value": "",
                "valueType": "triggerId"
            }
        ],
        "x": 270,
        "y": 1000,
        "wires": [
            [
                "0474d8dcceeabbfe"
            ]
        ]
    },
    {
        "id": "0474d8dcceeabbfe",
        "type": "json",
        "z": "6a77c00f79a19693",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 540,
        "y": 1000,
        "wires": [
            [
                "ce6a6d205a83129b"
            ]
        ]
    },
    {
        "id": "f38e2ab61d16cb7f",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "true"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 730,
        "y": 1080,
        "wires": [
            [
                "0345e9c8f91734a4"
            ],
            [
                "f0fc36ab5d3f19ff"
            ]
        ]
    },
    {
        "id": "f0fc36ab5d3f19ff",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "name": "Mode",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 850,
        "y": 1140,
        "wires": [
            [
                "0345e9c8f91734a4"
            ]
        ]
    },
    {
        "id": "c60c2aeb2a5f38b4",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "true"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 430,
        "y": 860,
        "wires": [
            [
                "ca84a21742d3e0cd"
            ],
            [
                "91a62c0970200190"
            ]
        ]
    },
    {
        "id": "91a62c0970200190",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "name": "Mode",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "neq",
                "v": "away",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 430,
        "y": 900,
        "wires": [
            [
                "ca84a21742d3e0cd"
            ]
        ]
    },
    {
        "id": "ce6a6d205a83129b",
        "type": "change",
        "z": "6a77c00f79a19693",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "illuminance",
                "pt": "msg",
                "to": "$number(payload.illuminance)\t\t",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.presence",
                "tot": "msg"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "on",
                "fromt": "str",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "off",
                "fromt": "str",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "presence",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 720,
        "y": 1000,
        "wires": [
            [
                "f38e2ab61d16cb7f",
                "cf3797c1e0b5c101"
            ]
        ]
    },
    {
        "id": "cb809ab79e18fc86",
        "type": "switch",
        "z": "6a77c00f79a19693",
        "name": "",
        "property": "VisitorMode",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1240,
        "y": 680,
        "wires": [
            [],
            [
                "6b9eeab08f2cdd54"
            ]
        ]
    },
    {
        "id": "0345e9c8f91734a4",
        "type": "subflow:05933d2d8abb4be7",
        "z": "6a77c00f79a19693",
        "name": "",
        "x": 990,
        "y": 1060,
        "wires": [
            [
                "bc76c6da083bdd3b"
            ],
            []
        ]
    },
    {
        "id": "46561a09fa8da2c4",
        "type": "debug",
        "z": "6a77c00f79a19693",
        "name": "debug 4",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 630,
        "y": 760,
        "wires": []
    },
    {
        "id": "502f4e884cac3140",
        "type": "Thing Setup",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "thingType": "FH_Light",
        "things": [
            {
                "name": "Hallway OLD",
                "id": "21",
                "props": {
                    "address": 2,
                    "sv": "out_lvl_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "Office_Light",
                "id": "5",
                "props": {
                    "address": 6,
                    "sv": "out_bin_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "kjøkken",
                "id": "10",
                "props": {
                    "address": "3",
                    "sv": "out_lvl_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "stue",
                "id": "11",
                "props": {
                    "address": "14",
                    "sv": "out_bin_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "bathroom",
                "id": "46",
                "props": {
                    "address": "37",
                    "sv": "out_lvl_switch",
                    "dimable": true
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "closet",
                "id": "9",
                "props": {
                    "address": "12",
                    "sv": "out_bin_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "Hallway",
                "id": "15",
                "props": {
                    "address": 9,
                    "sv": "out_bin_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "basement",
                "id": "17",
                "props": {
                    "address": "18",
                    "sv": "out_bin_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "bedroom",
                "id": "20",
                "props": {
                    "address": "22",
                    "sv": "out_lvl_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "karinaoffice",
                "id": "27",
                "props": {
                    "address": "27",
                    "sv": "out_lvl_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "office",
                "id": "26",
                "props": {
                    "address": "l4",
                    "sv": "out_lvl_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "laundry",
                "id": "52",
                "props": {
                    "address": "47",
                    "sv": "out_lvl_switch"
                },
                "state": [],
                "commands": [],
                "children": []
            }
        ],
        "state": [
            {
                "key": "power",
                "value": false
            }
        ],
        "commands": [],
        "statusFunction": "if (state.power === undefined) return null\nlet text = state.power == \"on\" ? 'On' : 'Off'\nif (state.hasOwnProperty('brightness') && state.on){\n     text += ` ${state.brightness < 1 ? state.brightness * 100 : state.brightness}%`\n}\n   \n    \nreturn {\n    fill: state.power == \"on\" ? 'yellow' : 'grey',\n    shape: 'dot',\n    text\n}",
        "debug": false,
        "x": 1060,
        "y": 720,
        "wires": []
    },
    {
        "id": "2dc40524a1b11e11",
        "type": "Thing Update",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "nodeName": "",
        "name": "",
        "thingType": "FH_Light",
        "debug": true,
        "updates": [
            {
                "key": "power",
                "type": "msg",
                "val": "payload.val.changes.power"
            },
            {
                "key": "dimlevel",
                "type": "msg",
                "val": "payload.val.param.param.dimValue"
            }
        ],
        "x": 560,
        "y": 780,
        "wires": []
    },
    {
        "id": "feaccb063046e633",
        "type": "Thing Process",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "nodeName": "",
        "thingType": "FH_Light",
        "topic": "$id",
        "debug": false,
        "x": 380,
        "y": 720,
        "wires": [
            [
                "fc74b8e441ba36bb"
            ]
        ]
    },
    {
        "id": "0f1c18c6959cd496",
        "type": "Thing Command",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "nodeName": "Set LIght",
        "name": "",
        "command": "",
        "commandType": "msg",
        "debug": false,
        "x": 1940,
        "y": 1460,
        "wires": []
    },
    {
        "id": "f6e9c846c1dd7c91",
        "type": "comment",
        "z": "2153cce4d74e8cba",
        "g": "90a2ae744f3f1a15",
        "name": "Futurehome MQTT communication ",
        "info": "This example uses the Lifx platform. The Lifx node works well with the thing nodes, as it requires no initization to receive inbound messages. And the Lifx node already uses the MAC address as the message topic, so the Lifx Things are setup with the MAC address as their ID.",
        "x": 320,
        "y": 220,
        "wires": []
    },
    {
        "id": "7f1c02a51299c501",
        "type": "Thing Setup",
        "z": "2153cce4d74e8cba",
        "thingType": "DC_Light",
        "things": [],
        "state": [],
        "commands": [],
        "statusFunction": "if (state.on === undefined) return null\nlet text = state.on ? 'On' : 'Off'\nif (state.hasOwnProperty('brightness') && state.on)\n    text += ` ${state.brightness < 1 ? state.brightness * 100 : state.brightness}%`\nreturn {\n    fill: state.on ? 'yellow' : 'grey',\n    shape: 'dot',\n    text\n}",
        "debug": false,
        "x": 260,
        "y": 100,
        "wires": []
    },
    {
        "id": "e9c6b977279a9ace",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "name": "Light ID",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "payload.val.id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 340,
        "y": 780,
        "wires": [
            [
                "2dc40524a1b11e11"
            ]
        ]
    },
    {
        "id": "36d041fc10d198e1",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "\"pt:j1/mt:cmd/rt:dev/rn:zw/ad:1/sv:\"& thing.props.sv & \"/ad:\"& thing.props.address & \"_0\"",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\t    \"type\": thing.props.type,\t    \"serv\": thing.props.sv,\t    \"val_t\": thing.props.val_t,\t    \"val\": payload,\t    \"tags\": null,\t    \"props\": {},\t    \"ver\": \"1\",\t    \"corid\": \"\",\t    \"src\": \"node-red\",\t    \"ctime\": \"\",\t    \"uid\": \"\"\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1070,
        "y": 780,
        "wires": [
            [
                "39f321390ee435bd"
            ]
        ]
    },
    {
        "id": "39f321390ee435bd",
        "type": "mqtt out",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "name": "FH_MQTT",
        "topic": "",
        "qos": "0",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "41e681f.e420d8",
        "x": 1430,
        "y": 780,
        "wires": []
    },
    {
        "id": "d4a6b225ba8ed179",
        "type": "mqtt in",
        "z": "2153cce4d74e8cba",
        "g": "90a2ae744f3f1a15",
        "name": "FH_MQTT",
        "topic": "pt:j1/mt:evt/rt:app/rn:vinculum/ad:1",
        "qos": "1",
        "datatype": "json",
        "broker": "41e681f.e420d8",
        "nl": false,
        "rap": false,
        "rh": "1",
        "inputs": 0,
        "x": 260,
        "y": 280,
        "wires": [
            [
                "09f1aab9bbdc8dc3",
                "e5671f21a115e942"
            ]
        ]
    },
    {
        "id": "09f1aab9bbdc8dc3",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "90a2ae744f3f1a15",
        "name": "FH functionality",
        "property": "payload.val.param.functionality",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "lighting",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 460,
        "y": 280,
        "wires": [
            [
                "e39012b8700bad76"
            ],
            [
                "79e1877f01b1e9dd"
            ]
        ]
    },
    {
        "id": "a70594b76501cf94",
        "type": "Thing Trigger",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "nodeName": "",
        "triggerThing": {
            "path": "type",
            "type": "str",
            "value": "FH_Light"
        },
        "triggerState": null,
        "triggerTest": null,
        "ignoreInit": false,
        "payload": {
            "type": "state",
            "value": ""
        },
        "x": 570,
        "y": 840,
        "wires": [
            [
                "69f22820e9552291"
            ]
        ]
    },
    {
        "id": "7461442f9ce7e50e",
        "type": "mqtt in",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "FH_MQTT",
        "topic": "pt:j1/mt:evt/rt:app/rn:vinculum/ad:1",
        "qos": "0",
        "datatype": "json",
        "broker": "41e681f.e420d8",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 880,
        "y": 60,
        "wires": [
            [
                "f6577fe9cc641a4b"
            ]
        ]
    },
    {
        "id": "f6577fe9cc641a4b",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "",
        "property": "payload.val.component",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "hub",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1030,
        "y": 60,
        "wires": [
            [
                "655d1a811ae2bfbd"
            ]
        ]
    },
    {
        "id": "655d1a811ae2bfbd",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "",
        "property": "payload.val.param.current",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "Mode",
                "vt": "global"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 1150,
        "y": 60,
        "wires": [
            [
                "ff4854b4e81f1a8a"
            ]
        ]
    },
    {
        "id": "ff4854b4e81f1a8a",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "Mode",
                "pt": "global",
                "to": "payload.val.param.current",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 60,
        "wires": [
            [
                "8ca977fa2d6c3f23",
                "42a4c8da879f2e30"
            ]
        ]
    },
    {
        "id": "0890fca55df81357",
        "type": "mqtt out",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "Set Mode",
        "topic": "pt:j1/mt:cmd/rt:app/rn:vinculum/ad:1",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "41e681f.e420d8",
        "x": 2320,
        "y": 120,
        "wires": []
    },
    {
        "id": "f7ac0d2fc376810c",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "Set Mode",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\t   \"ctime\": \"2019-09-04 17:36:31 +0200\",\t   \"props\": {},\t   \"resp_to\": \"pt:j1/mt:rsp/rt:app/rn:node-red/ad:flow1\",\t   \"serv\": \"vinculum\",\t   \"src\": \"node-red\",\t   \"tags\": [],\t   \"type\": \"cmd.pd7.request\",\t   \"uid\": \"09936904-8ec8-4280-9285-945d77bd0a74\",\t   \"val\": {\t       \"cmd\": \"set\",\t       \"component\": \"mode\",\t       \"id\": mode,\t       \"param\": {},\t       \"requestId\": 1\t    },\t   \"val_t\": \"object\",\t   \"ver\": \"1\"\t}",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2160,
        "y": 120,
        "wires": [
            [
                "0890fca55df81357"
            ]
        ]
    },
    {
        "id": "e0f3fa373c92533a",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "away",
        "rules": [
            {
                "t": "set",
                "p": "mode",
                "pt": "msg",
                "to": "away",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2010,
        "y": 80,
        "wires": [
            [
                "f7ac0d2fc376810c"
            ]
        ]
    },
    {
        "id": "4bfb43cc5c725dfa",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "home",
        "rules": [
            {
                "t": "set",
                "p": "mode",
                "pt": "msg",
                "to": "home",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2010,
        "y": 120,
        "wires": [
            [
                "f7ac0d2fc376810c"
            ]
        ]
    },
    {
        "id": "8d9ebcf8551eea4b",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "sleep",
        "rules": [
            {
                "t": "set",
                "p": "mode",
                "pt": "msg",
                "to": "sleep",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2010,
        "y": 160,
        "wires": [
            [
                "f7ac0d2fc376810c"
            ]
        ]
    },
    {
        "id": "b3f9adc55b666094",
        "type": "link in",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "Set AWAY",
        "links": [
            "fc4fe81e.444628",
            "6929bc641b70d921"
        ],
        "x": 1895,
        "y": 80,
        "wires": [
            [
                "e0f3fa373c92533a"
            ]
        ]
    },
    {
        "id": "f27df5b9f6840243",
        "type": "link in",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "Set HOME",
        "links": [
            "247260f.c82dca",
            "fbc0b4b628c8de0f"
        ],
        "x": 1895,
        "y": 120,
        "wires": [
            [
                "4bfb43cc5c725dfa"
            ]
        ]
    },
    {
        "id": "9a51081d9dca2356",
        "type": "link in",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "Set SLEEP",
        "links": [
            "c9b7d9c6.2c46e8"
        ],
        "x": 1895,
        "y": 160,
        "wires": [
            [
                "8d9ebcf8551eea4b"
            ]
        ]
    },
    {
        "id": "e39012b8700bad76",
        "type": "link out",
        "z": "2153cce4d74e8cba",
        "g": "90a2ae744f3f1a15",
        "name": "FH_Lights",
        "mode": "link",
        "links": [
            "eca75607ec15506a"
        ],
        "x": 785,
        "y": 280,
        "wires": []
    },
    {
        "id": "eca75607ec15506a",
        "type": "link in",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "name": "FH_Lights",
        "links": [
            "e39012b8700bad76"
        ],
        "x": 215,
        "y": 780,
        "wires": [
            [
                "e9c6b977279a9ace"
            ]
        ]
    },
    {
        "id": "5c5afd3abb577912",
        "type": "link out",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "FH_Mode_Set",
        "mode": "link",
        "links": [
            "9e9814a999c69457"
        ],
        "x": 1755,
        "y": 60,
        "wires": []
    },
    {
        "id": "c9f8d6dac8d4ba6d",
        "type": "Thing Get",
        "z": "2153cce4d74e8cba",
        "d": true,
        "g": "833beeaf82e34801",
        "nodeName": "Get Ligth Status",
        "name": "",
        "props": [
            {
                "msgProp": "payload",
                "thingProp": "state",
                "path": "power"
            }
        ],
        "x": 1180,
        "y": 1500,
        "wires": [
            [
                "d1864239e50a53f6"
            ]
        ]
    },
    {
        "id": "04b5d65f2356f4ba",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Office_Light",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Office_Light",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 970,
        "y": 1600,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "3f0facfb8ecb6309",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Hallway",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Hallway",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 1400,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "7b748d84badce752",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "kjøkken",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "kjøkken",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 1360,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "169eb382584dea9a",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "stue",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "stue",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 990,
        "y": 1320,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "9b29720688f4f892",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "bathroom",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "bathroom",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 1480,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "5581b9e705bd930b",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "closet",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "closet",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 990,
        "y": 1280,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "32b87da33debbea7",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "laundry",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "laundry",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 1560,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "fa9eb39dc8d1ab43",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "basement",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "basement",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 1520,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "57f6d41542bec600",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "bedroom",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "bedroom",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 1440,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "f5414ebf88c0dd29",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "karinaoffice",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "karinaoffice",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 970,
        "y": 1640,
        "wires": [
            [
                "5009a3c5bb74d022"
            ]
        ]
    },
    {
        "id": "e8a10173e53f4a16",
        "type": "link in",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Set_Lights",
        "links": [
            "1deeab2413b7a99b",
            "21c80566.d9201a",
            "87d1ce3c19202d34",
            "8bc1a1a00cecc7a6",
            "99bb192c.9613d8",
            "b9eed7dde8000c3e",
            "d3afa1ea39895105",
            "e2d7c57f5c31b977",
            "4c1858d290c94d44"
        ],
        "x": 295,
        "y": 1460,
        "wires": [
            [
                "0cdeb110cc9cbe87"
            ]
        ]
    },
    {
        "id": "3e5515ba1d6c857c",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "",
        "property": "room",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "walkingCloset",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "KJØKKEN",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "G-LYS",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "S-LYS",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "BA-LYS",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "K-LYS",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "laundry",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "O-LYS",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "K-O-LYS",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "All-Lights",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 10,
        "x": 710,
        "y": 1440,
        "wires": [
            [
                "5581b9e705bd930b"
            ],
            [
                "7b748d84badce752",
                "169eb382584dea9a"
            ],
            [
                "3f0facfb8ecb6309"
            ],
            [
                "57f6d41542bec600"
            ],
            [
                "9b29720688f4f892"
            ],
            [
                "fa9eb39dc8d1ab43"
            ],
            [
                "32b87da33debbea7"
            ],
            [
                "04b5d65f2356f4ba"
            ],
            [
                "f5414ebf88c0dd29"
            ],
            [
                "5581b9e705bd930b",
                "169eb382584dea9a",
                "7b748d84badce752",
                "3f0facfb8ecb6309",
                "57f6d41542bec600",
                "9b29720688f4f892",
                "fa9eb39dc8d1ab43",
                "32b87da33debbea7",
                "04b5d65f2356f4ba",
                "f5414ebf88c0dd29"
            ]
        ]
    },
    {
        "id": "69f22820e9552291",
        "type": "link out",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "name": "Light_Changed",
        "mode": "link",
        "links": [],
        "x": 1175,
        "y": 840,
        "wires": []
    },
    {
        "id": "e5671f21a115e942",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "90a2ae744f3f1a15",
        "name": "External FH ( HUE)",
        "property": "payload.val.param.type.subtype",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "presence",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 460,
        "y": 340,
        "wires": [
            [
                "6ad1052a6188fbc4"
            ]
        ]
    },
    {
        "id": "6ad1052a6188fbc4",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "90a2ae744f3f1a15",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.val.param.param.presence",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 380,
        "wires": [
            [
                "2544b14f26361464"
            ]
        ]
    },
    {
        "id": "2544b14f26361464",
        "type": "link out",
        "z": "2153cce4d74e8cba",
        "g": "90a2ae744f3f1a15",
        "name": "HUE PRESENCE",
        "mode": "link",
        "links": [],
        "x": 605,
        "y": 380,
        "wires": []
    },
    {
        "id": "935ba8da4c403144",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "has state",
        "property": "state",
        "propertyType": "msg",
        "rules": [
            {
                "t": "null"
            },
            {
                "t": "nnull"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1500,
        "y": 1500,
        "wires": [
            [
                "34fedf56c6a998e5"
            ],
            [
                "cf4286d760897c48"
            ]
        ]
    },
    {
        "id": "6635faf90a4a38ac",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Set State",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "state",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1760,
        "y": 1500,
        "wires": [
            [
                "0f1c18c6959cd496"
            ]
        ]
    },
    {
        "id": "79e1877f01b1e9dd",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "90a2ae744f3f1a15",
        "name": "",
        "property": "payload.val.param.type.subtype",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "presence",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 710,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "60b992e02d33fa6b",
        "type": "mqtt in",
        "z": "2153cce4d74e8cba",
        "g": "a498e3e25a476808",
        "name": "FH_MQTT",
        "topic": "pt:j1/mt:evt/rt:dev/rn:zw/ad:1/sv:sensor_presence/#",
        "qos": "1",
        "datatype": "json",
        "broker": "41e681f.e420d8",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 300,
        "y": 500,
        "wires": [
            [
                "ecf544e90fa509b5"
            ]
        ]
    },
    {
        "id": "9b9c69bdb290d6e6",
        "type": "Thing Update",
        "z": "2153cce4d74e8cba",
        "g": "a498e3e25a476808",
        "nodeName": "",
        "name": "",
        "thingType": "FH_movement",
        "debug": true,
        "updates": [
            {
                "key": "movement",
                "type": "msg",
                "val": "payload.val"
            }
        ],
        "x": 660,
        "y": 500,
        "wires": []
    },
    {
        "id": "ecf544e90fa509b5",
        "type": "string",
        "z": "2153cce4d74e8cba",
        "g": "a498e3e25a476808",
        "name": "",
        "methods": [
            {
                "name": "getRightMost",
                "params": [
                    {
                        "type": "str",
                        "value": ":"
                    }
                ]
            },
            {
                "name": "getLeftMost",
                "params": [
                    {
                        "type": "str",
                        "value": "_"
                    }
                ]
            }
        ],
        "prop": "topic",
        "propout": "topic",
        "object": "msg",
        "objectout": "msg",
        "x": 450,
        "y": 500,
        "wires": [
            [
                "9b9c69bdb290d6e6"
            ]
        ]
    },
    {
        "id": "6fe45e94bb1611c0",
        "type": "Thing Setup",
        "z": "2153cce4d74e8cba",
        "g": "a498e3e25a476808",
        "thingType": "FH_movement",
        "things": [
            {
                "name": "m_basement",
                "id": "20",
                "props": {},
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "m_basement_stairs",
                "id": "36",
                "props": {},
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "m_wardrobe",
                "id": "4",
                "props": {},
                "state": [],
                "commands": [],
                "children": []
            },
            {
                "name": "m_basement2",
                "id": "16",
                "props": {},
                "state": [],
                "commands": [],
                "children": []
            }
        ],
        "state": [
            {
                "key": "movement",
                "value": false
            }
        ],
        "commands": [],
        "statusFunction": "if (state.movement === undefined) return null\r\n\r\n\r\nreturn {\r\n    fill: state.movement == true ? 'blue' : 'grey',\r\n    shape: 'dot'\r\n}",
        "debug": false,
        "x": 880,
        "y": 500,
        "wires": []
    },
    {
        "id": "e9771f214776e51e",
        "type": "Thing Trigger",
        "z": "2153cce4d74e8cba",
        "g": "a498e3e25a476808",
        "nodeName": "FH_movement",
        "triggerThing": {
            "path": "type",
            "type": "str",
            "value": "FH_movement"
        },
        "triggerState": "state.movement",
        "triggerTest": null,
        "ignoreInit": true,
        "payload": {
            "type": "state",
            "value": "movement"
        },
        "x": 280,
        "y": 580,
        "wires": [
            [
                "03af9b4d41bd40d1"
            ]
        ]
    },
    {
        "id": "87d84f08c959923a",
        "type": "link out",
        "z": "2153cce4d74e8cba",
        "g": "a498e3e25a476808",
        "name": "FH_Movement",
        "mode": "link",
        "links": [
            "f66e7e24.aca9d"
        ],
        "x": 575,
        "y": 580,
        "wires": []
    },
    {
        "id": "fb7b621287bb03dc",
        "type": "link in",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "set_Lights_buypass",
        "links": [
            "1063cb701ba3a9ac",
            "9aaac14aa0dcc552"
        ],
        "x": 325,
        "y": 1360,
        "wires": [
            [
                "eae7f9bdc1f64e43"
            ]
        ]
    },
    {
        "id": "eae7f9bdc1f64e43",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "topic",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 1360,
        "wires": [
            [
                "3e5515ba1d6c857c"
            ]
        ]
    },
    {
        "id": "0cdeb110cc9cbe87",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "state",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 1460,
        "wires": [
            [
                "3e5515ba1d6c857c"
            ]
        ]
    },
    {
        "id": "ca9bd84f6914ccc1",
        "type": "debug",
        "z": "2153cce4d74e8cba",
        "name": "debug 20",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1420,
        "y": 420,
        "wires": []
    },
    {
        "id": "35ccdda768414683",
        "type": "catch",
        "z": "2153cce4d74e8cba",
        "name": "Unknown Things",
        "scope": null,
        "uncaught": false,
        "x": 1190,
        "y": 460,
        "wires": [
            [
                "08d6277accad7820",
                "ca9bd84f6914ccc1"
            ]
        ]
    },
    {
        "id": "08d6277accad7820",
        "type": "function",
        "z": "2153cce4d74e8cba",
        "name": "save unknown for later check",
        "func": "\n\nvar id = msg.topic;\nflow.set([\"unknown\"+id], msg)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1470,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "77555cd20a73894f",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "STOP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 120,
        "wires": [
            [
                "43e8b3bc5eb993e3"
            ]
        ]
    },
    {
        "id": "43e8b3bc5eb993e3",
        "type": "link out",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "link out 9",
        "mode": "link",
        "links": [],
        "x": 1435,
        "y": 120,
        "wires": []
    },
    {
        "id": "8ca977fa2d6c3f23",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "sleep",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1150,
        "y": 120,
        "wires": [
            [
                "77555cd20a73894f",
                "312c76cd73591b09"
            ]
        ]
    },
    {
        "id": "fc74b8e441ba36bb",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "name": "is val_t !null",
        "property": "thing.props.dimable",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 750,
        "y": 720,
        "wires": [
            [
                "3586e46bbd0e53af"
            ],
            [
                "da8d02b690681002"
            ]
        ]
    },
    {
        "id": "da8d02b690681002",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "name": "set bool",
        "rules": [
            {
                "t": "set",
                "p": "thing.props.val_t",
                "pt": "msg",
                "to": "bool",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "thing.props.type",
                "pt": "msg",
                "to": "cmd.binary.set",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 900,
        "y": 760,
        "wires": [
            [
                "36d041fc10d198e1"
            ]
        ]
    },
    {
        "id": "3586e46bbd0e53af",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "a3172e532d882fe7",
        "name": "set int",
        "rules": [
            {
                "t": "set",
                "p": "thing.props.val_t",
                "pt": "msg",
                "to": "int",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "thing.props.type",
                "pt": "msg",
                "to": "cmd.lvl.set",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 910,
        "y": 700,
        "wires": [
            [
                "36d041fc10d198e1"
            ]
        ]
    },
    {
        "id": "913fb4c226869e79",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Turn all Ligths OFF",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "All-Lights",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 1300,
        "wires": [
            [
                "0cdeb110cc9cbe87"
            ]
        ]
    },
    {
        "id": "fa037bf9c192d1d3",
        "type": "link in",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Turn OFF ALL Lights",
        "links": [
            "fc4fe81e.444628",
            "b6a29855cdae995e"
        ],
        "x": 305,
        "y": 1300,
        "wires": [
            [
                "913fb4c226869e79"
            ]
        ]
    },
    {
        "id": "1d5ad1bb7efafd0d",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Turn all Ligths ON",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "All-Lights",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 1580,
        "wires": [
            [
                "8981429cc9d0e3c8"
            ]
        ]
    },
    {
        "id": "e580148cb6b2ecc0",
        "type": "inject",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 280,
        "y": 1580,
        "wires": [
            [
                "1d5ad1bb7efafd0d"
            ]
        ]
    },
    {
        "id": "cf4286d760897c48",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "All-Lights",
        "property": "room",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "All-Lights",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1580,
        "y": 1560,
        "wires": [
            [
                "9554f5c971a0df0e"
            ],
            [
                "6635faf90a4a38ac"
            ]
        ]
    },
    {
        "id": "9554f5c971a0df0e",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "bathroom",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "bathroom",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1660,
        "y": 1600,
        "wires": [
            [
                "56156f4a5dc995ed"
            ],
            [
                "6635faf90a4a38ac"
            ]
        ]
    },
    {
        "id": "56156f4a5dc995ed",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "set bathroom",
        "rules": [
            {
                "t": "change",
                "p": "state",
                "pt": "msg",
                "from": "true",
                "fromt": "bool",
                "to": "100",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1830,
        "y": 1620,
        "wires": [
            [
                "6635faf90a4a38ac"
            ]
        ]
    },
    {
        "id": "8981429cc9d0e3c8",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "state",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 530,
        "y": 1640,
        "wires": [
            [
                "9b29720688f4f892"
            ]
        ]
    },
    {
        "id": "1a7dad7a9bee2cbb",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Turn all Ligths off",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "All-Lights",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 330,
        "y": 1640,
        "wires": [
            [
                "8981429cc9d0e3c8"
            ]
        ]
    },
    {
        "id": "e46130fd001328ba",
        "type": "inject",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 1640,
        "wires": [
            [
                "1a7dad7a9bee2cbb"
            ]
        ]
    },
    {
        "id": "33feae6a920e0c12",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Turn all Ligths ON",
        "rules": [
            {
                "t": "set",
                "p": "room",
                "pt": "msg",
                "to": "All-Lights",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 1260,
        "wires": [
            [
                "0cdeb110cc9cbe87"
            ]
        ]
    },
    {
        "id": "16df02f3eb3587ef",
        "type": "link in",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "Turn ON ALL Lights",
        "links": [
            "2269200b466aa112"
        ],
        "x": 305,
        "y": 1260,
        "wires": [
            [
                "33feae6a920e0c12"
            ]
        ]
    },
    {
        "id": "d1864239e50a53f6",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "on/off",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "on",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "off",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 3,
        "x": 1330,
        "y": 1500,
        "wires": [
            [
                "910130f6c7a85723"
            ],
            [
                "701322a59ecb3a3d"
            ],
            [
                "935ba8da4c403144"
            ]
        ]
    },
    {
        "id": "910130f6c7a85723",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1450,
        "y": 1460,
        "wires": [
            [
                "935ba8da4c403144"
            ]
        ]
    },
    {
        "id": "701322a59ecb3a3d",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1430,
        "y": 1540,
        "wires": [
            [
                "935ba8da4c403144"
            ]
        ]
    },
    {
        "id": "03af9b4d41bd40d1",
        "type": "subflow:05933d2d8abb4be7",
        "z": "2153cce4d74e8cba",
        "g": "a498e3e25a476808",
        "name": "",
        "x": 450,
        "y": 580,
        "wires": [
            [
                "87d84f08c959923a"
            ],
            []
        ]
    },
    {
        "id": "34fedf56c6a998e5",
        "type": "function",
        "z": "2153cce4d74e8cba",
        "g": "833beeaf82e34801",
        "name": "function 5",
        "func": "msg.payload = !msg.payload;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1650,
        "y": 1460,
        "wires": [
            [
                "0f1c18c6959cd496"
            ]
        ]
    },
    {
        "id": "7be94949b0599c5f",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1640,
        "y": 60,
        "wires": [
            [
                "5c5afd3abb577912"
            ]
        ]
    },
    {
        "id": "312c76cd73591b09",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1640,
        "y": 120,
        "wires": [
            [
                "5c5afd3abb577912"
            ]
        ]
    },
    {
        "id": "42a4c8da879f2e30",
        "type": "switch",
        "z": "2153cce4d74e8cba",
        "g": "ba9650ca3526ed06",
        "name": "",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1490,
        "y": 60,
        "wires": [
            [
                "7be94949b0599c5f"
            ]
        ]
    },
    {
        "id": "1683544e57ff8fa9",
        "type": "change",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "vacation",
        "rules": [
            {
                "t": "set",
                "p": "mode",
                "pt": "msg",
                "to": "vacation",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2020,
        "y": 40,
        "wires": [
            [
                "f7ac0d2fc376810c"
            ]
        ]
    },
    {
        "id": "06a76cb3da5742c4",
        "type": "link in",
        "z": "2153cce4d74e8cba",
        "g": "12605644788902fd",
        "name": "Set Vacation",
        "links": [
            "2d89c6f3277b5730",
            "b6ce0f321a83eba0"
        ],
        "x": 1895,
        "y": 40,
        "wires": [
            [
                "1683544e57ff8fa9"
            ]
        ]
    },
    {
        "id": "7268b8b9.eb7ae",
        "type": "inject",
        "z": "19a61e2a.75f152",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "00 12 * * 1",
        "once": true,
        "onceDelay": "10",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 500,
        "wires": [
            [
                "c70310c4.a7eb78",
                "3467f3008929627e"
            ]
        ]
    },
    {
        "id": "c70310c4.a7eb78",
        "type": "http request",
        "z": "19a61e2a.75f152",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.hentavfall.no/rogaland/sandnes/tommekalender/show?id=759fbf09-3f7f-4c41-aa70-54d3902d915f&municipality=Sandnes%20kommune%202020&gnumber=38&bnumber=1696&snumber=4",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 370,
        "y": 500,
        "wires": [
            [
                "5c9d5ab90b9643f7"
            ]
        ]
    },
    {
        "id": "8e57f94726f5be98",
        "type": "debug",
        "z": "19a61e2a.75f152",
        "name": "Dato -Dag",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1030,
        "y": 340,
        "wires": []
    },
    {
        "id": "8d6b27c1c9e2c2e0",
        "type": "split",
        "z": "19a61e2a.75f152",
        "name": "For hver Avfallstype",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 590,
        "y": 460,
        "wires": [
            [
                "b18db77dc706d617",
                "c42c0fc74c149b91",
                "35b0a73644bd0f7b"
            ]
        ]
    },
    {
        "id": "d5631660e7e2357e",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Avfallstype Bilder",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[1].images",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 590,
        "y": 420,
        "wires": [
            [
                "8d6b27c1c9e2c2e0"
            ]
        ]
    },
    {
        "id": "b18db77dc706d617",
        "type": "debug",
        "z": "19a61e2a.75f152",
        "name": "Avfallstyper",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1030,
        "y": 460,
        "wires": []
    },
    {
        "id": "3060dfc94ade0f86",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Dato - Dag",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[1].date",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "date",
                "pt": "msg",
                "to": " \t\t   \t\t$trim($substringBefore(payload,'-'))& '.'&$moment().format('YYYY')\t\t \t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 380,
        "wires": [
            [
                "8e57f94726f5be98",
                "307b1fd4d57c05fc",
                "c879542c56b5a555",
                "86e47902d1c776a0"
            ]
        ]
    },
    {
        "id": "307b1fd4d57c05fc",
        "type": "ui-template",
        "z": "19a61e2a.75f152",
        "group": "e63aca3c0dabe7de",
        "page": "",
        "ui": "",
        "name": "Vis Avfallstyper for neste Tømming",
        "order": 3,
        "width": 0,
        "height": 0,
        "head": "",
        "format": "<template >\n   <div >\n      <div class=\"col-lg-2\">       \n           <img  v-for=\"pic in msg?.payload\" style=\"height: 100px;\" v-bind:src=\"pic\" v-bind:alt=\"pic\"  style=\"display: flex;\">\n\n   </div>\n</template>\n",
        "storeOutMessages": true,
        "passthru": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1100,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "c42c0fc74c149b91",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Generer Bilde Adresse",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "\"https://www.hentavfall.no/\"&payload",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 600,
        "y": 500,
        "wires": [
            [
                "d0cfa1719585871c"
            ]
        ]
    },
    {
        "id": "d0cfa1719585871c",
        "type": "join",
        "z": "19a61e2a.75f152",
        "name": "Kombiner Avfallstyper",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": true,
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "reduceExp": "",
        "reduceInit": "",
        "reduceInitType": "",
        "reduceFixup": "",
        "x": 600,
        "y": 540,
        "wires": [
            [
                "307b1fd4d57c05fc",
                "f488905696dd9bb9"
            ]
        ]
    },
    {
        "id": "f488905696dd9bb9",
        "type": "debug",
        "z": "19a61e2a.75f152",
        "name": "Kombinerte linker",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 540,
        "wires": []
    },
    {
        "id": "c879542c56b5a555",
        "type": "ui-text",
        "z": "19a61e2a.75f152",
        "group": "e63aca3c0dabe7de",
        "order": 2,
        "width": 3,
        "height": null,
        "name": "",
        "label": "Tømmedag",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 1030,
        "y": 380,
        "wires": []
    },
    {
        "id": "e0aa0bcbecd4d1a4",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Neste Tømming",
        "rules": [
            {
                "t": "set",
                "p": "dateDayBefore",
                "pt": "flow",
                "to": "dateDayBefore",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1260,
        "y": 300,
        "wires": [
            [
                "66294b131746695a"
            ]
        ]
    },
    {
        "id": "1a2a1f5a64482b86",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "today",
                "pt": "flow",
                "to": "$moment().format('DD/MM/YYYY')\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 780,
        "wires": [
            [
                "a43988c0b007cfc6"
            ]
        ]
    },
    {
        "id": "97e4bcebf71b7b99",
        "type": "bigtimer",
        "z": "19a61e2a.75f152",
        "outtopic": "",
        "outpayload1": "",
        "outpayload2": "",
        "name": "Big Timer",
        "comment": "",
        "lat": 0,
        "lon": 0,
        "starttime": 5001,
        "endtime": 1425,
        "starttime2": 0,
        "endtime2": 0,
        "startoff": 0,
        "endoff": 0,
        "startoff2": 0,
        "endoff2": 0,
        "offs": 0,
        "outtext1": "",
        "outtext2": "",
        "timeout": 1440,
        "sun": true,
        "mon": true,
        "tue": true,
        "wed": true,
        "thu": true,
        "fri": true,
        "sat": false,
        "jan": true,
        "feb": false,
        "mar": false,
        "apr": false,
        "may": true,
        "jun": false,
        "jul": false,
        "aug": false,
        "sep": true,
        "oct": false,
        "nov": false,
        "dec": false,
        "day1": 0,
        "month1": 0,
        "day2": 0,
        "month2": 0,
        "day3": 0,
        "month3": 0,
        "day4": 0,
        "month4": 0,
        "day5": 0,
        "month5": 0,
        "day6": 0,
        "month6": 0,
        "day7": 0,
        "month7": 0,
        "day8": 0,
        "month8": 0,
        "day9": 0,
        "month9": 0,
        "day10": 0,
        "month10": 0,
        "day11": 0,
        "month11": 0,
        "day12": 0,
        "month12": 0,
        "d1": 0,
        "w1": 0,
        "d2": 0,
        "w2": 0,
        "d3": 0,
        "w3": 0,
        "d4": 0,
        "w4": 0,
        "d5": 0,
        "w5": 0,
        "d6": 0,
        "w6": 0,
        "xday1": 0,
        "xmonth1": 0,
        "xday2": 0,
        "xmonth2": 0,
        "xday3": 0,
        "xmonth3": 0,
        "xday4": 0,
        "xmonth4": 0,
        "xday5": 0,
        "xmonth5": 0,
        "xday6": 0,
        "xmonth6": 0,
        "xday7": 0,
        "xmonth7": 0,
        "xday8": 0,
        "xmonth8": 0,
        "xday9": 0,
        "xmonth9": 0,
        "xday10": 0,
        "xmonth10": 0,
        "xday11": 0,
        "xmonth11": 0,
        "xday12": 0,
        "xmonth12": 0,
        "xd1": 0,
        "xw1": 0,
        "xd2": 0,
        "xw2": 0,
        "xd3": 0,
        "xw3": 0,
        "xd4": 0,
        "xw4": 0,
        "xd5": 0,
        "xw5": 0,
        "xd6": 0,
        "xw6": 0,
        "suspend": false,
        "random": false,
        "randon1": false,
        "randoff1": false,
        "randon2": false,
        "randoff2": false,
        "repeat": true,
        "atstart": true,
        "odd": false,
        "even": false,
        "x": 100,
        "y": 820,
        "wires": [
            [
                "1bd7657d1f89af5b"
            ],
            [],
            []
        ]
    },
    {
        "id": "212c4217852361f8",
        "type": "inject",
        "z": "19a61e2a.75f152",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 760,
        "wires": [
            [
                "1bd7657d1f89af5b"
            ]
        ]
    },
    {
        "id": "edf1e6c5b4462da1",
        "type": "switch",
        "z": "19a61e2a.75f152",
        "name": "Type",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "bio",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "hage",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "rest",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "plast",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "papir",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 5,
        "x": 870,
        "y": 660,
        "wires": [
            [
                "c19e972371d1940b"
            ],
            [
                "c78ca9e56bc523ec"
            ],
            [
                "1f428c8c9098b774"
            ],
            [
                "f7ff928eee78dab3"
            ],
            [
                "57d38f2b9c957238"
            ]
        ]
    },
    {
        "id": "c19e972371d1940b",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "bio",
                "pt": "flow",
                "to": "setType",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1150,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "c78ca9e56bc523ec",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hage",
                "pt": "flow",
                "to": "setType",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1150,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "1f428c8c9098b774",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "rest",
                "pt": "flow",
                "to": "setType",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1150,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "f7ff928eee78dab3",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "plast",
                "pt": "flow",
                "to": "setType",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1150,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "35b0a73644bd0f7b",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "setType true",
        "rules": [
            {
                "t": "set",
                "p": "setType",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 890,
        "y": 600,
        "wires": [
            [
                "edf1e6c5b4462da1"
            ]
        ]
    },
    {
        "id": "d392f04b755ddf0c",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "setType false",
        "rules": [
            {
                "t": "set",
                "p": "setType",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 890,
        "y": 720,
        "wires": [
            [
                "f7ff928eee78dab3",
                "1f428c8c9098b774",
                "c78ca9e56bc523ec",
                "c19e972371d1940b",
                "57d38f2b9c957238"
            ]
        ]
    },
    {
        "id": "cee713031b9e4b96",
        "type": "switch",
        "z": "19a61e2a.75f152",
        "name": "bio",
        "property": "bio",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 390,
        "y": 880,
        "wires": [
            [
                "8a3ff16928c6d0c6"
            ],
            [
                "dccf8209e287f17c"
            ]
        ]
    },
    {
        "id": "dccf8209e287f17c",
        "type": "switch",
        "z": "19a61e2a.75f152",
        "name": "hage",
        "property": "hage",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 530,
        "y": 920,
        "wires": [
            [
                "62117c33196328c7"
            ],
            [
                "d558dc2e3abdd52c"
            ]
        ]
    },
    {
        "id": "d558dc2e3abdd52c",
        "type": "switch",
        "z": "19a61e2a.75f152",
        "name": "plast",
        "property": "plast",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 670,
        "y": 960,
        "wires": [
            [
                "adc5c73c556d9870"
            ],
            [
                "aa36257f41855f1e"
            ]
        ]
    },
    {
        "id": "aa36257f41855f1e",
        "type": "switch",
        "z": "19a61e2a.75f152",
        "name": "rest",
        "property": "rest",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 810,
        "y": 1000,
        "wires": [
            [
                "647d6da519c7f5b4"
            ],
            [
                "66c8054726f4a4fe"
            ]
        ]
    },
    {
        "id": "57d38f2b9c957238",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "papir",
                "pt": "flow",
                "to": "setType",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1150,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "66c8054726f4a4fe",
        "type": "switch",
        "z": "19a61e2a.75f152",
        "name": "papir",
        "property": "papir",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 970,
        "y": 1040,
        "wires": [
            [
                "aa4bea0c445264b5"
            ],
            [
                "a8707fb5af9d3632"
            ]
        ]
    },
    {
        "id": "8a3ff16928c6d0c6",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Matavfall",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "text& ' Matavfall '",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 880,
        "wires": [
            [
                "dccf8209e287f17c"
            ]
        ],
        "icon": "font-awesome/fa-text-width"
    },
    {
        "id": "62117c33196328c7",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Hageavfall",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "text& ',  Hageavfall '",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 920,
        "wires": [
            [
                "d558dc2e3abdd52c"
            ]
        ]
    },
    {
        "id": "adc5c73c556d9870",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Plastavfall",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "text& ' , Plastavfall'",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 960,
        "wires": [
            [
                "aa36257f41855f1e"
            ]
        ]
    },
    {
        "id": "647d6da519c7f5b4",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Restavfall",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "text& ' , Restavfall'",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 1000,
        "wires": [
            [
                "66c8054726f4a4fe"
            ]
        ]
    },
    {
        "id": "aa4bea0c445264b5",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Papiravfall",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "text& ' , Papiravfall'",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1130,
        "y": 1040,
        "wires": [
            [
                "a8707fb5af9d3632"
            ]
        ]
    },
    {
        "id": "cc5ab9a6bfdc1b6a",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "Husk",
        "rules": [
            {
                "t": "set",
                "p": "text",
                "pt": "msg",
                "to": "Husk å ta ut",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 250,
        "y": 880,
        "wires": [
            [
                "cee713031b9e4b96"
            ]
        ]
    },
    {
        "id": "3f373bb9ada3dfc6",
        "type": "debug",
        "z": "19a61e2a.75f152",
        "name": "Text til Google",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "text",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 1340,
        "y": 1000,
        "wires": []
    },
    {
        "id": "86e47902d1c776a0",
        "type": "moment",
        "z": "19a61e2a.75f152",
        "name": "",
        "topic": "",
        "input": "date",
        "inputType": "msg",
        "inTz": "Europe/Oslo",
        "adjAmount": "1",
        "adjType": "days",
        "adjDir": "subtract",
        "format": "DD/MM/YYYY",
        "locale": "Europe/Oslo",
        "output": "dateDayBefore",
        "outputType": "msg",
        "outTz": "Europe/Oslo",
        "x": 1060,
        "y": 300,
        "wires": [
            [
                "e0aa0bcbecd4d1a4"
            ]
        ]
    },
    {
        "id": "5c9d5ab90b9643f7",
        "type": "cheerio-function",
        "z": "19a61e2a.75f152",
        "name": "",
        "func": "\nconst items = $('.waste-calendar__item'); // Select all elements with class 'waste-calendar__item'\n\nconst extractedData = items.map((index, element) => {\n    const date = $(element).find('td:first-child').text().trim(); // Extract the date\n    const images = $(element).find('img.waste-container-icon[src]').map((i, img) => $(img).attr('src')).get(); // Extract image URLs\n    return { date, images };\n}).get();\n\n\nmsg.payload = extractedData\nreturn msg;",
        "outputs": 1,
        "noerr": 10,
        "x": 380,
        "y": 440,
        "wires": [
            [
                "d5631660e7e2357e",
                "3060dfc94ade0f86",
                "0b1ae7693e714bb0"
            ]
        ]
    },
    {
        "id": "17cd3339e33d1ca7",
        "type": "inject",
        "z": "19a61e2a.75f152",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 100,
        "y": 900,
        "wires": [
            [
                "cc5ab9a6bfdc1b6a"
            ]
        ]
    },
    {
        "id": "f676af51cded15ca",
        "type": "link out",
        "z": "19a61e2a.75f152",
        "name": "link out 19",
        "mode": "link",
        "links": [
            "662ff2faf119d193"
        ],
        "x": 1325,
        "y": 1060,
        "wires": []
    },
    {
        "id": "ce6346dfc59fd373",
        "type": "link in",
        "z": "19a61e2a.75f152",
        "name": "Remeber Garbage",
        "links": [
            "d7ad25e5346ae60c"
        ],
        "x": 195,
        "y": 960,
        "wires": [
            [
                "cc5ab9a6bfdc1b6a"
            ]
        ]
    },
    {
        "id": "a8707fb5af9d3632",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "add language",
        "rules": [
            {
                "t": "set",
                "p": "language",
                "pt": "msg",
                "to": "nb",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "text",
                "pt": "msg",
                "from": ",",
                "fromt": "str",
                "to": " og ",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1180,
        "y": 1080,
        "wires": [
            [
                "3f373bb9ada3dfc6",
                "f676af51cded15ca"
            ]
        ]
    },
    {
        "id": "a43988c0b007cfc6",
        "type": "switch",
        "z": "19a61e2a.75f152",
        "name": "Garbage is Is Tomorrow?",
        "property": "dateDayBefore",
        "propertyType": "flow",
        "rules": [
            {
                "t": "eq",
                "v": "today",
                "vt": "flow"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 520,
        "y": 820,
        "wires": [
            [
                "cc5ab9a6bfdc1b6a"
            ]
        ]
    },
    {
        "id": "da162105b2aa7597",
        "type": "ui-button",
        "z": "19a61e2a.75f152",
        "group": "e63aca3c0dabe7de",
        "name": "",
        "label": "Søppel tatt",
        "order": 1,
        "width": "2",
        "height": "1",
        "emulateClick": true,
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "iconPosition": "left",
        "payload": "STOP",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "enableClick": true,
        "enablePointerdown": false,
        "pointerdownPayload": "",
        "pointerdownPayloadType": "str",
        "enablePointerup": false,
        "pointerupPayload": "",
        "pointerupPayloadType": "str",
        "x": 1250,
        "y": 220,
        "wires": [
            [
                "d6f0c1209533f50e"
            ]
        ]
    },
    {
        "id": "1bd7657d1f89af5b",
        "type": "switch",
        "z": "19a61e2a.75f152",
        "name": "garbageTaken",
        "property": "garbageTaken",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 280,
        "y": 820,
        "wires": [
            [
                "1a2a1f5a64482b86"
            ]
        ]
    },
    {
        "id": "d6f0c1209533f50e",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "garbageTaken = true",
        "rules": [
            {
                "t": "set",
                "p": "garbageTaken",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1460,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "66294b131746695a",
        "type": "change",
        "z": "19a61e2a.75f152",
        "name": "garbageTaken = false",
        "rules": [
            {
                "t": "set",
                "p": "garbageTaken",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1480,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "19d48064119a9c03",
        "type": "inject",
        "z": "19a61e2a.75f152",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1060,
        "y": 220,
        "wires": [
            [
                "da162105b2aa7597"
            ]
        ]
    },
    {
        "id": "0b1ae7693e714bb0",
        "type": "debug",
        "z": "19a61e2a.75f152",
        "name": "debug 2",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 220,
        "wires": []
    },
    {
        "id": "82d4deea0f5d146b",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "group": "205ec56154dae157",
        "name": "KJØKKEN",
        "label": "",
        "order": 1,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "black",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "lightbulb-outline",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "KJØKKEN",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1790,
        "y": 480,
        "wires": [
            [
                "1063cb701ba3a9ac"
            ]
        ]
    },
    {
        "id": "0f8a013e0153fbd5",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "87210300141eb4cc",
        "group": "20e9e3a35362262a",
        "name": "TV",
        "label": "",
        "order": 4,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "television",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 650,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "0a0229165450e20b",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "group": "9d9a284bf5ce86d3",
        "name": "O-LYS",
        "label": "",
        "order": 1,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "black",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "lightbulb-outline",
        "iconPosition": "left",
        "payload": "true",
        "payloadType": "bool",
        "topic": "O-LYS",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1770,
        "y": 160,
        "wires": [
            [
                "1063cb701ba3a9ac"
            ]
        ]
    },
    {
        "id": "be0766449f34157c",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "group": "20e9e3a35362262a",
        "name": "K-LYS",
        "label": "",
        "order": 1,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "black",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "lightbulb-outline",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "K-LYS",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1770,
        "y": 320,
        "wires": [
            [
                "1063cb701ba3a9ac"
            ]
        ]
    },
    {
        "id": "2b75c1c39c22e878",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "group": "e53a9dd93e589b2e",
        "name": "S-LYS",
        "label": "",
        "order": 1,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "black",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "lightbulb-outline",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "S-LYS",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1770,
        "y": 280,
        "wires": [
            [
                "1063cb701ba3a9ac"
            ]
        ]
    },
    {
        "id": "99923aedde97df0f",
        "type": "switch",
        "z": "61f713462b422a81",
        "g": "87210300141eb4cc",
        "name": "",
        "property": "isStandBy",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 340,
        "y": 440,
        "wires": [
            [
                "e747302ab0cd4829"
            ],
            [
                "0cdeb3068b8c43dc"
            ]
        ]
    },
    {
        "id": "0cdeb3068b8c43dc",
        "type": "change",
        "z": "61f713462b422a81",
        "g": "87210300141eb4cc",
        "name": "ON",
        "rules": [
            {
                "t": "set",
                "p": "background",
                "pt": "msg",
                "to": "green",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 460,
        "wires": [
            [
                "0f8a013e0153fbd5"
            ]
        ]
    },
    {
        "id": "e747302ab0cd4829",
        "type": "change",
        "z": "61f713462b422a81",
        "g": "87210300141eb4cc",
        "name": "OFF",
        "rules": [
            {
                "t": "set",
                "p": "background",
                "pt": "msg",
                "to": "black",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 420,
        "wires": [
            [
                "0f8a013e0153fbd5"
            ]
        ]
    },
    {
        "id": "3d752044a6901bba",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "group": "403670954d105a2d",
        "name": "G-LYS",
        "label": "",
        "order": 1,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "black",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "lightbulb-outline",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "G-LYS",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1770,
        "y": 200,
        "wires": [
            [
                "1063cb701ba3a9ac"
            ]
        ]
    },
    {
        "id": "be78e95a54ad258e",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "group": "c68075e9d91b3588",
        "name": "K-O-LYS",
        "label": "",
        "order": 1,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "black",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "lightbulb-outline",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "K-O-LYS",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1780,
        "y": 400,
        "wires": [
            [
                "1063cb701ba3a9ac"
            ]
        ]
    },
    {
        "id": "77b0a7f7334d846a",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "87210300141eb4cc",
        "name": "SHIELD",
        "links": [
            "5e8d3398.55375c"
        ],
        "x": 255,
        "y": 440,
        "wires": [
            [
                "99923aedde97df0f"
            ]
        ]
    },
    {
        "id": "ee65e366a035b490",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "group": "20e9e3a35362262a",
        "name": "B-PRES",
        "label": "",
        "order": 3,
        "width": 1,
        "height": 1,
        "emulateClick": true,
        "tooltip": "",
        "color": "white",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "eye",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "basement",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 740,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "86476bd49731fa2c",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "group": "205ec56154dae157",
        "name": "KJ-PRES",
        "label": "",
        "order": 2,
        "width": 1,
        "height": 1,
        "emulateClick": true,
        "tooltip": "",
        "color": "white",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "eye",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "kitchn",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 740,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "dcc90d5280e1aeb8",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "group": "9d9a284bf5ce86d3",
        "name": "O-PRESS",
        "label": "",
        "order": 2,
        "width": 1,
        "height": 1,
        "emulateClick": true,
        "tooltip": "",
        "color": "white",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "eye",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "Office",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "enableClick": true,
        "x": 740,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "1dcdfd1b4bbd46e1",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "group": "c68075e9d91b3588",
        "name": "K-O-PRESS",
        "label": "",
        "order": 2,
        "width": 1,
        "height": 1,
        "emulateClick": true,
        "tooltip": "",
        "color": "white",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "eye",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "Karina_OFFICE",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 750,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "aa0430d69264a383",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "group": "403670954d105a2d",
        "name": "G-PRESS",
        "label": "",
        "order": 2,
        "width": 1,
        "height": 1,
        "emulateClick": true,
        "tooltip": "",
        "color": "white",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "eye",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "hall",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 740,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "48ec96b07e81e728",
        "type": "inject",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "30",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 330,
        "y": 720,
        "wires": [
            [
                "ad963eccab3159c2",
                "54f7718144729c48",
                "1107db891bfcee07",
                "135724c94b4da9e3",
                "014cc1262b6a5534",
                "81fda15dc62d9a91",
                "c3d029127d9b687e",
                "9980b08f3c9badd5"
            ]
        ]
    },
    {
        "id": "8859702d4e0dda25",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "group": "1257d664fb2a5f32",
        "name": "BA-PRES",
        "label": "",
        "order": 7,
        "width": 1,
        "height": 1,
        "emulateClick": true,
        "tooltip": "",
        "color": "white",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "eye",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "bathroom",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 740,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "b59fc37200ad0559",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "group": "1257d664fb2a5f32",
        "name": "BA-LYS",
        "label": "",
        "order": 5,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "black",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "lightbulb-outline",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "BA-LYS",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1780,
        "y": 360,
        "wires": [
            [
                "1063cb701ba3a9ac"
            ]
        ]
    },
    {
        "id": "1063cb701ba3a9ac",
        "type": "link out",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "name": "Lights",
        "mode": "link",
        "links": [
            "fb7b621287bb03dc"
        ],
        "x": 2045,
        "y": 300,
        "wires": []
    },
    {
        "id": "d6f63ee6ae47b993",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "group": "2742573c1afc3a9d",
        "name": "Closet",
        "label": "",
        "order": 1,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "black",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "lightbulb-outline",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "Closet",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1770,
        "y": 240,
        "wires": [
            [
                "1063cb701ba3a9ac"
            ]
        ]
    },
    {
        "id": "ee0928a7625436ab",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "group": "2c9e91a26ccc554d",
        "name": "vaskerom",
        "label": "",
        "order": 1,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "black",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "lightbulb-outline",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "vaskerom",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1780,
        "y": 440,
        "wires": [
            [
                "1063cb701ba3a9ac"
            ]
        ]
    },
    {
        "id": "d2b50c1ddfab828c",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "name": "",
        "links": [
            "69f22820e9552291"
        ],
        "x": 1225,
        "y": 280,
        "wires": [
            [
                "7e5753e9fb0410a3"
            ]
        ]
    },
    {
        "id": "7e5753e9fb0410a3",
        "type": "function",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "name": "Btn_LIghts",
        "func": "msg.background = \"grey\";\nif (msg.payload.power == \"on\"){\n    msg.background = \"yellow\";\n}\n\nmsg.ui_update = {\"buttonColor\" : msg.background} ;\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1330,
        "y": 280,
        "wires": [
            [
                "706c4e8e62a2175f"
            ]
        ]
    },
    {
        "id": "706c4e8e62a2175f",
        "type": "switch",
        "z": "61f713462b422a81",
        "g": "07a89de28d307ce8",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Office_Light",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Hallway",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "closet",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "bedroom",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "basement",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "bathroom",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "karinaoffice",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "laundry",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "kjøkken",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 9,
        "x": 1510,
        "y": 280,
        "wires": [
            [
                "0a0229165450e20b"
            ],
            [
                "3d752044a6901bba"
            ],
            [
                "d6f63ee6ae47b993"
            ],
            [
                "2b75c1c39c22e878"
            ],
            [
                "be0766449f34157c"
            ],
            [
                "b59fc37200ad0559"
            ],
            [
                "be78e95a54ad258e"
            ],
            [
                "ee0928a7625436ab"
            ],
            [
                "82d4deea0f5d146b"
            ]
        ]
    },
    {
        "id": "32a3ea9d827e0d64",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "group": "2c9e91a26ccc554d",
        "name": "V-PRESS",
        "label": "",
        "order": 2,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "white",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "eye",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 740,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "6ad7524469d27c5e",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "group": "2742573c1afc3a9d",
        "name": "C-PRESS",
        "label": "",
        "order": 2,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "white",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "eye",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 740,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "817926c433169913",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "group": "205ec56154dae157",
        "name": "Off",
        "label": "",
        "order": 5,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "red",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "power",
        "iconPosition": "left",
        "payload": "false",
        "payloadType": "bool",
        "topic": "off",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "enableClick": true,
        "enablePointerdown": false,
        "pointerdownPayload": "",
        "pointerdownPayloadType": "str",
        "enablePointerup": false,
        "pointerupPayload": "",
        "pointerupPayloadType": "str",
        "x": 1510,
        "y": 700,
        "wires": [
            [
                "bbb00f8bf1437a19"
            ]
        ]
    },
    {
        "id": "e006a76904b60354",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "group": "205ec56154dae157",
        "name": "On",
        "label": "",
        "order": 3,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "green",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "power",
        "iconPosition": "left",
        "payload": "true",
        "payloadType": "bool",
        "topic": "on",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "enableClick": true,
        "enablePointerdown": false,
        "pointerdownPayload": "",
        "pointerdownPayloadType": "str",
        "enablePointerup": false,
        "pointerupPayload": "",
        "pointerupPayloadType": "str",
        "x": 1510,
        "y": 660,
        "wires": [
            [
                "bbb00f8bf1437a19"
            ]
        ]
    },
    {
        "id": "51ccf992e760cfb4",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "group": "205ec56154dae157",
        "name": "Auto",
        "label": "AUTO",
        "order": 4,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "date",
        "topic": "Auto",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "enableClick": true,
        "enablePointerdown": false,
        "pointerdownPayload": "",
        "pointerdownPayloadType": "str",
        "enablePointerup": false,
        "pointerupPayload": "",
        "pointerupPayloadType": "str",
        "x": 1510,
        "y": 740,
        "wires": [
            [
                "bbb00f8bf1437a19"
            ]
        ]
    },
    {
        "id": "aa65f6a826960c6e",
        "type": "inject",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "WEEK",
        "props": [
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "00 06 * * 1,2,3,4,5",
        "once": false,
        "onceDelay": "2",
        "topic": "Auto",
        "x": 1240,
        "y": 580,
        "wires": [
            [
                "0f094dee2e4348c9"
            ]
        ]
    },
    {
        "id": "38a6473ae1b8cb4d",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "group": "20e9e3a35362262a",
        "name": "Off",
        "label": "",
        "order": 7,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "red",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "power",
        "iconPosition": "left",
        "payload": "false",
        "payloadType": "bool",
        "topic": "off",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1510,
        "y": 860,
        "wires": [
            [
                "f267683663f2dca9"
            ]
        ]
    },
    {
        "id": "ec8e67587eb60111",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "group": "20e9e3a35362262a",
        "name": "On",
        "label": "",
        "order": 5,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "green",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "power",
        "iconPosition": "left",
        "payload": "true",
        "payloadType": "bool",
        "topic": "on",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1510,
        "y": 820,
        "wires": [
            [
                "f267683663f2dca9"
            ]
        ]
    },
    {
        "id": "8051cc3693513a78",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "group": "20e9e3a35362262a",
        "name": "Auto",
        "label": "AUTO",
        "order": 6,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "",
        "bgcolor": "{{background}}",
        "icon": "",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "date",
        "topic": "Auto",
        "topicType": "str",
        "x": 1510,
        "y": 900,
        "wires": [
            [
                "f267683663f2dca9"
            ]
        ]
    },
    {
        "id": "bbb00f8bf1437a19",
        "type": "link out",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "btn_upstairs",
        "links": [
            "8d85a587153a5563",
            "fabdb6a9.b22598"
        ],
        "x": 1755,
        "y": 680,
        "wires": []
    },
    {
        "id": "f3c851ce3f4bb01f",
        "type": "link out",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "btn_downstairs",
        "links": [
            "5db5024050114fe3",
            "56d97603.6cdfe8"
        ],
        "x": 2005,
        "y": 880,
        "wires": []
    },
    {
        "id": "c55131d2170d2058",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "d": true,
        "g": "0cc1d007b784b6ed",
        "group": "20e9e3a35362262a",
        "name": "FILM",
        "label": "",
        "order": 2,
        "width": 2,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "tv",
        "iconPosition": "left",
        "payload": "true",
        "payloadType": "bool",
        "topic": "block",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1510,
        "y": 940,
        "wires": [
            [
                "f267683663f2dca9"
            ]
        ]
    },
    {
        "id": "48b8d712fc1ea0fb",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "group": "e53a9dd93e589b2e",
        "name": "S-Off",
        "label": "",
        "order": 4,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "red",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "power",
        "iconPosition": "left",
        "payload": "false",
        "payloadType": "bool",
        "topic": "off",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1510,
        "y": 1040,
        "wires": [
            [
                "798ec501490403d7"
            ]
        ]
    },
    {
        "id": "290b787a2e6cab17",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "group": "e53a9dd93e589b2e",
        "name": "S-On",
        "label": "",
        "order": 2,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "green",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "power",
        "iconPosition": "left",
        "payload": "true",
        "payloadType": "bool",
        "topic": "on",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "x": 1510,
        "y": 1000,
        "wires": [
            [
                "798ec501490403d7"
            ]
        ]
    },
    {
        "id": "798ec501490403d7",
        "type": "link out",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "btn_Bedroom",
        "links": [
            "1aceef23.4fc291",
            "105bf0cf1d973ec9"
        ],
        "x": 2005,
        "y": 1060,
        "wires": []
    },
    {
        "id": "ce96471538f6565a",
        "type": "ui-button",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "group": "e53a9dd93e589b2e",
        "name": "S-Auto",
        "label": "AUTO",
        "order": 3,
        "width": 1,
        "height": 1,
        "emulateClick": false,
        "tooltip": "",
        "color": "",
        "bgcolor": "{{background}}",
        "icon": "",
        "iconPosition": "left",
        "payload": "",
        "payloadType": "date",
        "topic": "Auto",
        "topicType": "str",
        "x": 1510,
        "y": 1080,
        "wires": [
            [
                "798ec501490403d7"
            ]
        ]
    },
    {
        "id": "105bf0cf1d973ec9",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "btn_Color",
        "links": [
            "798ec501490403d7"
        ],
        "x": 1175,
        "y": 1040,
        "wires": [
            [
                "126c90c96c81b86b"
            ]
        ]
    },
    {
        "id": "126c90c96c81b86b",
        "type": "subflow:c8930ccb.6e912",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "Bedroom",
        "env": [],
        "x": 1320,
        "y": 1040,
        "wires": [
            [
                "290b787a2e6cab17"
            ],
            [
                "48b8d712fc1ea0fb"
            ],
            [
                "ce96471538f6565a"
            ]
        ]
    },
    {
        "id": "b83132c1d2f38f5d",
        "type": "subflow:c8930ccb.6e912",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "Basement",
        "env": [],
        "x": 1320,
        "y": 860,
        "wires": [
            [
                "ec8e67587eb60111"
            ],
            [
                "38a6473ae1b8cb4d"
            ],
            [
                "8051cc3693513a78"
            ]
        ]
    },
    {
        "id": "6d896087b5e899ac",
        "type": "subflow:c8930ccb.6e912",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "Upstairs",
        "env": [],
        "x": 1320,
        "y": 700,
        "wires": [
            [
                "e006a76904b60354"
            ],
            [
                "817926c433169913"
            ],
            [
                "51ccf992e760cfb4"
            ]
        ]
    },
    {
        "id": "5db5024050114fe3",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "btn_B-Color",
        "links": [
            "f3c851ce3f4bb01f"
        ],
        "x": 1175,
        "y": 860,
        "wires": [
            [
                "b83132c1d2f38f5d"
            ]
        ]
    },
    {
        "id": "8d85a587153a5563",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "btn_U-Color",
        "links": [
            "bbb00f8bf1437a19"
        ],
        "x": 1175,
        "y": 700,
        "wires": [
            [
                "6d896087b5e899ac"
            ]
        ]
    },
    {
        "id": "cf21cfba7f910c8f",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "SHIELD STATUS",
        "links": [
            "5e8d3398.55375c"
        ],
        "x": 1285,
        "y": 940,
        "wires": [
            [
                "c55131d2170d2058"
            ]
        ]
    },
    {
        "id": "bdf5318dd87b3dfa",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "Decons_Upstairs",
        "links": [
            "fbd30b58.0dc988"
        ],
        "x": 1535,
        "y": 620,
        "wires": [
            [
                "bbb00f8bf1437a19"
            ]
        ]
    },
    {
        "id": "5a5aa2c2317b2730",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "DEcons_Downstairs",
        "links": [
            "63220a70.24ebb4"
        ],
        "x": 1545,
        "y": 780,
        "wires": [
            [
                "f267683663f2dca9"
            ]
        ]
    },
    {
        "id": "731a1f20b5c89507",
        "type": "change",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "set Auto",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Auto",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1680,
        "y": 580,
        "wires": [
            [
                "bbb00f8bf1437a19",
                "f3c851ce3f4bb01f",
                "e36e9d4f8caf4e7c"
            ]
        ]
    },
    {
        "id": "0f094dee2e4348c9",
        "type": "change",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "Nightmode OFF",
        "rules": [
            {
                "t": "set",
                "p": "Nightmode",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1480,
        "y": 580,
        "wires": [
            [
                "731a1f20b5c89507"
            ]
        ]
    },
    {
        "id": "ad963eccab3159c2",
        "type": "subflow:9fbb2608fbbaf87a",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "name": "B-Presence",
        "x": 570,
        "y": 580,
        "wires": [
            [
                "ee65e366a035b490"
            ]
        ]
    },
    {
        "id": "54f7718144729c48",
        "type": "subflow:9fbb2608fbbaf87a",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "name": "BA-Presence",
        "env": [
            {
                "name": "presence",
                "value": "BA-Presence",
                "type": "str"
            }
        ],
        "x": 570,
        "y": 620,
        "wires": [
            [
                "8859702d4e0dda25"
            ]
        ]
    },
    {
        "id": "1107db891bfcee07",
        "type": "subflow:9fbb2608fbbaf87a",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "name": "ST-presence",
        "env": [
            {
                "name": "presence",
                "value": "ST-presence",
                "type": "str"
            }
        ],
        "x": 570,
        "y": 660,
        "wires": [
            [
                "86476bd49731fa2c"
            ]
        ]
    },
    {
        "id": "135724c94b4da9e3",
        "type": "subflow:9fbb2608fbbaf87a",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "name": "HA-Presence",
        "env": [
            {
                "name": "presence",
                "value": "HA-Presence",
                "type": "str"
            }
        ],
        "x": 570,
        "y": 700,
        "wires": [
            [
                "aa0430d69264a383"
            ]
        ]
    },
    {
        "id": "014cc1262b6a5534",
        "type": "subflow:9fbb2608fbbaf87a",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "name": "KO-presence",
        "env": [
            {
                "name": "presence",
                "value": "KO-presence",
                "type": "str"
            }
        ],
        "x": 570,
        "y": 740,
        "wires": [
            [
                "1dcdfd1b4bbd46e1"
            ]
        ]
    },
    {
        "id": "81fda15dc62d9a91",
        "type": "subflow:9fbb2608fbbaf87a",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "name": "O-presence",
        "env": [
            {
                "name": "presence",
                "value": "O-presence",
                "type": "str"
            }
        ],
        "x": 570,
        "y": 780,
        "wires": [
            [
                "dcc90d5280e1aeb8"
            ]
        ]
    },
    {
        "id": "c3d029127d9b687e",
        "type": "subflow:9fbb2608fbbaf87a",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "name": "C-Presence",
        "env": [
            {
                "name": "presence",
                "value": "C-Presence",
                "type": "str"
            }
        ],
        "x": 570,
        "y": 820,
        "wires": [
            [
                "6ad7524469d27c5e"
            ]
        ]
    },
    {
        "id": "9980b08f3c9badd5",
        "type": "subflow:9fbb2608fbbaf87a",
        "z": "61f713462b422a81",
        "g": "a4a9170e6f87bab8",
        "name": "V-Presence",
        "env": [
            {
                "name": "presence",
                "value": "V-Presence",
                "type": "str"
            }
        ],
        "x": 570,
        "y": 860,
        "wires": [
            [
                "32a3ea9d827e0d64"
            ]
        ]
    },
    {
        "id": "e36e9d4f8caf4e7c",
        "type": "link out",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "link out 6",
        "mode": "link",
        "links": [
            "6a2e573bd6e53025"
        ],
        "x": 1995,
        "y": 580,
        "wires": []
    },
    {
        "id": "6a2e573bd6e53025",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "link in 1",
        "links": [
            "e36e9d4f8caf4e7c"
        ],
        "x": 1765,
        "y": 980,
        "wires": [
            [
                "798ec501490403d7"
            ]
        ]
    },
    {
        "id": "0259d792f5b75f52",
        "type": "inject",
        "z": "61f713462b422a81",
        "g": "53115130f657b882",
        "name": "night",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "00 21 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "night",
        "payloadType": "str",
        "x": 790,
        "y": 140,
        "wires": [
            [
                "9eea7aeb43d074a3"
            ]
        ]
    },
    {
        "id": "9eea7aeb43d074a3",
        "type": "change",
        "z": "61f713462b422a81",
        "g": "53115130f657b882",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "status",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "b8d1aea9ca80ad0d",
        "type": "inject",
        "z": "61f713462b422a81",
        "g": "53115130f657b882",
        "name": "day",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "00 06 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "day",
        "payloadType": "str",
        "x": 790,
        "y": 200,
        "wires": [
            [
                "9eea7aeb43d074a3"
            ]
        ]
    },
    {
        "id": "8456ad2c.7b492",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "53115130f657b882",
        "name": "",
        "links": [],
        "x": 745,
        "y": 260,
        "wires": [
            [
                "2b18f71498965dd7"
            ]
        ]
    },
    {
        "id": "2b18f71498965dd7",
        "type": "change",
        "z": "61f713462b422a81",
        "g": "53115130f657b882",
        "name": "Set Values",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "{\"topic\":\"ui-property:<property>\",\"payload\":\"value\"}",
                "tot": "json",
                "dc": true
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Mode",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 870,
        "y": 260,
        "wires": [
            [
                "631efbfdf57fe8fc"
            ]
        ]
    },
    {
        "id": "42dcb01a8a2dd3b0",
        "type": "inject",
        "z": "61f713462b422a81",
        "g": "53115130f657b882",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 780,
        "y": 300,
        "wires": [
            [
                "2b18f71498965dd7"
            ]
        ]
    },
    {
        "id": "631efbfdf57fe8fc",
        "type": "ui-switch",
        "z": "61f713462b422a81",
        "g": "53115130f657b882",
        "name": "Home Status",
        "label": "Home Status",
        "group": "3f286b473c9966df",
        "order": 3,
        "width": "2",
        "height": "1",
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "onvalue": "home",
        "onvalueType": "str",
        "onicon": "home",
        "oncolor": "green",
        "offvalue": "away",
        "offvalueType": "str",
        "officon": "home-off",
        "offcolor": "red",
        "x": 1030,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "d871d736.d19838",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "1f543c3859db0ffb",
        "name": "",
        "links": [
            "772b0560.6b8bcc"
        ],
        "x": 235,
        "y": 160,
        "wires": [
            [
                "fe7d3938.a5fd88"
            ]
        ]
    },
    {
        "id": "84abded8.462ac",
        "type": "link in",
        "z": "61f713462b422a81",
        "g": "1f543c3859db0ffb",
        "name": "",
        "links": [
            "47763aff.5ff334"
        ],
        "x": 235,
        "y": 200,
        "wires": [
            [
                "f4cc46fb.79d698"
            ]
        ]
    },
    {
        "id": "f4cc46fb.79d698",
        "type": "change",
        "z": "61f713462b422a81",
        "g": "1f543c3859db0ffb",
        "name": "Karina",
        "rules": [
            {
                "t": "set",
                "p": "Karina",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 200,
        "wires": [
            [
                "5f74b04523ff3784"
            ]
        ]
    },
    {
        "id": "fe7d3938.a5fd88",
        "type": "change",
        "z": "61f713462b422a81",
        "g": "1f543c3859db0ffb",
        "name": "Øivind",
        "rules": [
            {
                "t": "set",
                "p": "oivheg",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 160,
        "wires": [
            [
                "d80abf17ba04b0a2"
            ]
        ]
    },
    {
        "id": "5f74b04523ff3784",
        "type": "ui-switch",
        "z": "61f713462b422a81",
        "g": "1f543c3859db0ffb",
        "name": "Karina",
        "label": "Karina",
        "group": "3f286b473c9966df",
        "order": 6,
        "width": "2",
        "height": "1",
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "account",
        "oncolor": "green",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "account",
        "offcolor": "orange",
        "x": 510,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "d80abf17ba04b0a2",
        "type": "ui-switch",
        "z": "61f713462b422a81",
        "g": "1f543c3859db0ffb",
        "name": "Øivind",
        "label": "Øivind",
        "group": "3f286b473c9966df",
        "order": 5,
        "width": "2",
        "height": "1",
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "account",
        "oncolor": "green",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "account",
        "offcolor": "orange",
        "x": 510,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "8ce548c3e4cefcd9",
        "type": "inject",
        "z": "61f713462b422a81",
        "g": "0cc1d007b784b6ed",
        "name": "WEEKEND",
        "props": [
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "00 08 * * 6,0",
        "once": false,
        "onceDelay": "2",
        "topic": "Auto",
        "x": 1270,
        "y": 620,
        "wires": [
            [
                "0f094dee2e4348c9"
            ]
        ]
    },
    {
        "id": "vm_sched_activate",
        "type": "function",
        "z": "visitor_mode_tab",
        "name": "Activate House Sitter Mode",
        "func": "// Get current visitor mode config or create new\nconst visitorMode = global.get('VisitorMode') || {};\n\n// Activate with house sitter configuration\nvisitorMode.enabled = true;\nvisitorMode.type = 'house_sitter';\nvisitorMode.startTime = Date.now();\nvisitorMode.expectedEndTime = null; // Set by schedule\nvisitorMode.allowedAreas = ['kitchen', 'living_room', 'bathroom', 'hallway', 'stairs', 'basement'];\nvisitorMode.restrictedAreas = ['bedroom', 'office'];\nvisitorMode.autoLightsEnabled = true;\nvisitorMode.climateAdjusted = true;\n\nglobal.set('VisitorMode', visitorMode);\n\nnode.status({fill: \"blue\", shape: \"dot\", text: \"House Sitter Mode Active\"});\n\nmsg.text = \"House Sitter Mode Activated - Vacation started\";\nmsg.visitorMode = visitorMode;\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 100,
        "wires": [
            [
                "vm_sched_notify",
                "vm_sched_announce"
            ]
        ]
    },
    {
        "id": "vm_sched_deactivate",
        "type": "function",
        "z": "visitor_mode_tab",
        "name": "Deactivate Visitor Mode",
        "func": "// Get current visitor mode\nconst visitorMode = global.get('VisitorMode') || {};\n\n// Deactivate\nvisitorMode.enabled = false;\nvisitorMode.endTime = Date.now();\n\nglobal.set('VisitorMode', visitorMode);\n\nnode.status({fill: \"green\", shape: \"ring\", text: \"Visitor Mode OFF\"});\n\nmsg.text = \"Visitor Mode Deactivated - Welcome home!\";\nmsg.visitorMode = visitorMode;\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 200,
        "wires": [
            [
                "vm_sched_notify",
                "vm_sched_announce"
            ]
        ]
    },
    {
        "id": "vm_sched_notify",
        "type": "ui-notification",
        "z": "visitor_mode_tab",
        "ui": "7f0c45a9432dc256",
        "position": "top right",
        "colorDefault": true,
        "color": "#000000",
        "displayTime": "5",
        "showCountdown": true,
        "outputs": 0,
        "allowDismiss": true,
        "dismissText": "Close",
        "allowConfirm": false,
        "confirmText": "",
        "raw": false,
        "className": "",
        "name": "",
        "x": 660,
        "y": 140,
        "wires": []
    },
    {
        "id": "vm_sched_announce",
        "type": "link out",
        "z": "visitor_mode_tab",
        "name": "Announce Visitor Mode Change",
        "mode": "link",
        "links": [
            "5cfbdbd83670143c"
        ],
        "x": 665,
        "y": 180,
        "wires": []
    },
    {
        "id": "vm_config_type_dropdown",
        "type": "ui-dropdown",
        "z": "visitor_mode_tab",
        "group": "38fdc7977d890ccd",
        "name": "Visitor Type",
        "label": "Visitor Type",
        "tooltip": "",
        "order": 2,
        "width": "4",
        "height": "1",
        "passthru": false,
        "multiple": false,
        "chips": false,
        "clearable": false,
        "options": [
            {
                "label": "Day Visit",
                "value": "day_visit",
                "type": "str"
            },
            {
                "label": "Overnight Guest",
                "value": "overnight",
                "type": "str"
            },
            {
                "label": "House Sitter",
                "value": "house_sitter",
                "type": "str"
            },
            {
                "label": "Vacation",
                "value": "Vacation",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "visitor_type",
        "topicType": "str",
        "className": "",
        "typeIsComboBox": true,
        "msgTrigger": "onChange",
        "x": 150,
        "y": 300,
        "wires": [
            [
                "vm_config_set_type"
            ]
        ]
    },
    {
        "id": "vm_config_set_type",
        "type": "function",
        "z": "visitor_mode_tab",
        "name": "Update Visitor Type",
        "func": "// Update visitor mode type\nconst visitorMode = global.get('VisitorMode') || { enabled: false };\nvisitorMode.type = msg.payload;\n\n// Adjust configuration based on type\nif (msg.payload === 'day_visit') {\n    visitorMode.allowedAreas = ['kitchen', 'living_room', 'bathroom', 'hallway'];\n    visitorMode.restrictedAreas = ['bedroom', 'office', 'basement'];\n} else if (msg.payload === 'overnight') {\n    visitorMode.allowedAreas = ['kitchen', 'living_room', 'bathroom', 'hallway', 'stairs'];\n    visitorMode.restrictedAreas = ['bedroom', 'office'];\n} else if (msg.payload === 'house_sitter') {\n    visitorMode.allowedAreas = ['kitchen', 'living_room', 'bathroom', 'hallway', 'stairs', 'basement'];\n    visitorMode.restrictedAreas = ['bedroom', 'office'];\n}\n\nglobal.set('VisitorMode', visitorMode);\nnode.status({fill: \"blue\", shape: \"dot\", text: \"Type: \" + msg.payload});\n\nmsg.payload = \"Visitor type updated to: \" + msg.payload;\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 300,
        "wires": [
            [
                "vm_sched_notify"
            ]
        ]
    },
    {
        "id": "vm_status_display",
        "type": "ui-text",
        "z": "visitor_mode_tab",
        "group": "3f286b473c9966df",
        "order": 4,
        "width": "6",
        "height": "2",
        "name": "Visitor Mode Status",
        "label": "Current Status",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 660,
        "y": 400,
        "wires": []
    },
    {
        "id": "vm_status_update",
        "type": "inject",
        "z": "visitor_mode_tab",
        "name": "Update Status Display",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "30",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 400,
        "wires": [
            [
                "vm_status_format"
            ]
        ]
    },
    {
        "id": "vm_status_format",
        "type": "function",
        "z": "visitor_mode_tab",
        "name": "Format Status",
        "func": "const visitorMode = global.get('VisitorMode') || { enabled: false };\n\nif (visitorMode.enabled) {\n    const startTime = visitorMode.startTime ? new Date(visitorMode.startTime).toLocaleString() : 'N/A';\n    const type = visitorMode.type || 'unknown';\n    const areas = visitorMode.allowedAreas ? visitorMode.allowedAreas.join(', ') : 'N/A';\n    \n    msg.payload = `<b>✓ ACTIVE</b><br>Type: ${type}<br>Started: ${startTime}<br>Allowed: ${areas}`;\n} else {\n    msg.payload = '<b>✗ INACTIVE</b><br>No visitor mode active';\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 400,
        "wires": [
            [
                "vm_status_display"
            ]
        ]
    },
    {
        "id": "vm_comment_1",
        "type": "comment",
        "z": "visitor_mode_tab",
        "name": "Scheduled Vacation Mode Triggers",
        "info": "These inject nodes can be configured with specific dates/times\\nfor automatic visitor mode activation when going on vacation",
        "x": 200,
        "y": 60,
        "wires": []
    },
    {
        "id": "vm_comment_2",
        "type": "comment",
        "z": "visitor_mode_tab",
        "name": "Manual Configuration",
        "info": "Configure visitor type and settings manually via dashboard",
        "x": 170,
        "y": 260,
        "wires": []
    },
    {
        "id": "vm_comment_3",
        "type": "comment",
        "z": "visitor_mode_tab",
        "name": "Live Status Display",
        "info": "Updates every 30 seconds to show current visitor mode status",
        "x": 170,
        "y": 360,
        "wires": []
    },
    {
        "id": "60a920a2e6eb0a57",
        "type": "ui-scheduler",
        "z": "visitor_mode_tab",
        "name": "scheduler",
        "group": "38fdc7977d890ccd",
        "order": 1,
        "label": "Scheduler",
        "width": 6,
        "height": "10",
        "outputField": "payload",
        "locale": "en",
        "timeZone": "",
        "use24HourFormat": true,
        "storeName": "local_file_system",
        "commandResponseMsgOutput": "fanOut",
        "defaultLocation": "58.84724816282459 5.7369232177734375",
        "defaultLocationType": "fixed",
        "sendStateInterval": 60,
        "sendActiveState": false,
        "sendInactiveState": false,
        "topics": [
            "Vacation",
            "VisitorMode"
        ],
        "customPayloads": [
            {
                "label": "Custom 1",
                "value": "1",
                "type": "str",
                "id": "abb679a9dfdf6abf"
            }
        ],
        "outputs": 3,
        "options": [],
        "uiOptionTime": true,
        "uiOptionSolar": true,
        "uiOptionCron": true,
        "uiOptionMinute": true,
        "uiOptionHour": true,
        "uiOptionDay": true,
        "uiOptionWeek": true,
        "uiOptionMonth": true,
        "uiOptionYear": true,
        "uiOptionTopic": true,
        "uiOptionTimespan": true,
        "uiOptionCustomOutput": true,
        "uiOptionNewTimePicker": false,
        "x": 350,
        "y": 580,
        "wires": [
            [],
            [
                "61480285cb98de2d"
            ],
            [
                "7327cb4e8ff483cb"
            ]
        ]
    },
    {
        "id": "7327cb4e8ff483cb",
        "type": "switch",
        "z": "visitor_mode_tab",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 510,
        "y": 600,
        "wires": [
            [
                "vm_sched_activate"
            ],
            [
                "vm_sched_deactivate"
            ]
        ]
    },
    {
        "id": "61480285cb98de2d",
        "type": "switch",
        "z": "visitor_mode_tab",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 510,
        "y": 560,
        "wires": [
            [
                "b6ce0f321a83eba0"
            ],
            [
                "6929bc641b70d921"
            ]
        ]
    },
    {
        "id": "b6ce0f321a83eba0",
        "type": "link out",
        "z": "visitor_mode_tab",
        "name": "link out 10",
        "mode": "link",
        "links": [
            "06a76cb3da5742c4"
        ],
        "x": 685,
        "y": 540,
        "wires": []
    },
    {
        "id": "6929bc641b70d921",
        "type": "link out",
        "z": "visitor_mode_tab",
        "name": "link out 17",
        "mode": "link",
        "links": [
            "b3f9adc55b666094"
        ],
        "x": 685,
        "y": 580,
        "wires": []
    },
    {
        "id": "eb2aafde2a5d66f5",
        "type": "weather data",
        "z": "5f6e89b4b8794e08",
        "yrconfig": "5917da18bf053368",
        "latitude": "58.87981",
        "longitude": "5.7629",
        "forecastType": "compact",
        "name": "",
        "x": 430,
        "y": 160,
        "wires": [
            [
                "214e0d56709b3194"
            ]
        ]
    },
    {
        "id": "86f8c2cf99faba90",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "0 0-22 * * *",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 250,
        "y": 160,
        "wires": [
            [
                "eb2aafde2a5d66f5"
            ]
        ]
    },
    {
        "id": "214e0d56709b3194",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "OutsideTemp",
                "pt": "flow",
                "to": "payload.properties.timeseries[0].data.instant.details.air_temperature",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 640,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "865cee0d39743e16",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "120",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 210,
        "y": 240,
        "wires": [
            [
                "80456db52b23c121"
            ]
        ]
    },
    {
        "id": "80456db52b23c121",
        "type": "sensibo in",
        "z": "5f6e89b4b8794e08",
        "sensiboAPI": "8500b44945f22748",
        "name": "",
        "pod": "VfTc6vFm",
        "getconfig": true,
        "getACState": false,
        "polltime": "0",
        "x": 420,
        "y": 240,
        "wires": [
            [
                "9f8f03f23131cf65"
            ]
        ]
    },
    {
        "id": "9f8f03f23131cf65",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "Set Temp (with offset & fallback)",
        "rules": [
            {
                "t": "set",
                "p": "upstairsCurrentTemp",
                "pt": "flow",
                "to": "$number(result.measurements.temperature) ? result.measurements.temperature : $flowContext('lastUpstairs', 20)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "downstairsCurrentTemp",
                "pt": "flow",
                "to": "$number(result.motionSensors[0].measurements.temperature) ? result.motionSensors[0].measurements.temperature : $flowContext('lastDownstairs', 20)",
                "tot": "jsonata"
            }
        ],
        "x": 630,
        "y": 240,
        "wires": [
            [
                "22ac35501eb0a501"
            ]
        ]
    },
    {
        "id": "ee42c6afdcefc3de",
        "type": "light-scheduler",
        "z": "5f6e89b4b8794e08",
        "settings": "b257c3b61872d5b6",
        "events": "[{\"start\":{\"dow\":4,\"mod\":390},\"end\":{\"dow\":4,\"mod\":480}},{\"start\":{\"dow\":3,\"mod\":390},\"end\":{\"dow\":3,\"mod\":485}},{\"start\":{\"dow\":1,\"mod\":390},\"end\":{\"dow\":1,\"mod\":480}},{\"start\":{\"dow\":5,\"mod\":390},\"end\":{\"dow\":5,\"mod\":480}},{\"start\":{\"dow\":2,\"mod\":390},\"end\":{\"dow\":2,\"mod\":480}},{\"start\":{\"dow\":0,\"mod\":480},\"end\":{\"dow\":0,\"mod\":1290}},{\"start\":{\"dow\":6,\"mod\":480},\"end\":{\"dow\":6,\"mod\":1290}},{\"start\":{\"dow\":1,\"mod\":840},\"end\":{\"dow\":1,\"mod\":1290}},{\"start\":{\"dow\":2,\"mod\":840},\"end\":{\"dow\":2,\"mod\":1290}},{\"start\":{\"dow\":3,\"mod\":840},\"end\":{\"dow\":3,\"mod\":1290}},{\"start\":{\"dow\":4,\"mod\":840},\"end\":{\"dow\":4,\"mod\":1290}},{\"start\":{\"dow\":5,\"mod\":840},\"end\":{\"dow\":5,\"mod\":1290}},{\"start\":{\"dow\":5,\"mod\":480},\"end\":{\"dow\":5,\"mod\":840}},{\"start\":{\"dow\":4,\"mod\":480},\"end\":{\"dow\":4,\"mod\":835}},{\"start\":{\"dow\":3,\"mod\":485},\"end\":{\"dow\":3,\"mod\":840}},{\"start\":{\"dow\":2,\"mod\":480},\"end\":{\"dow\":2,\"mod\":840}},{\"start\":{\"dow\":1,\"mod\":480},\"end\":{\"dow\":1,\"mod\":840}}]",
        "topic": "",
        "name": "HEATPUMP SCHEDULE",
        "onPayload": "true",
        "onPayloadType": "bool",
        "offPayload": "false",
        "offPayloadType": "bool",
        "onlyWhenDark": false,
        "scheduleRndMax": 0,
        "sunElevationThreshold": 6,
        "sunShowElevationInStatus": false,
        "outputfreq": "output.statechange.startup",
        "x": 1460,
        "y": 440,
        "wires": [
            [
                "91127c1da1eae8ab"
            ]
        ]
    },
    {
        "id": "91127c1da1eae8ab",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "tempOn",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1690,
        "y": 440,
        "wires": [
            [
                "5bdcf016e1f85dbb"
            ]
        ]
    },
    {
        "id": "e3550bada4aa7e84",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "set Auto",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "auto",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1150,
        "y": 380,
        "wires": [
            [
                "ee42c6afdcefc3de",
                "eafd3eb92b7d559c"
            ]
        ]
    },
    {
        "id": "97f665b7d0f37edb",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "set on",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 420,
        "wires": [
            [
                "ee42c6afdcefc3de"
            ]
        ]
    },
    {
        "id": "f21c93b649b3b7c3",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "set OFF",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1150,
        "y": 460,
        "wires": [
            [
                "ee42c6afdcefc3de"
            ]
        ]
    },
    {
        "id": "c31638839d6b5383",
        "type": "sensibo send",
        "z": "5f6e89b4b8794e08",
        "sensiboAPI": "8500b44945f22748",
        "name": "",
        "pod": "VfTc6vFm",
        "podSelector": "",
        "x": 2590,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "285cb9c7972e3fbe",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "set off",
        "rules": [
            {
                "t": "set",
                "p": "on",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2170,
        "y": 480,
        "wires": [
            [
                "9822aadb4fefc223"
            ]
        ]
    },
    {
        "id": "b98ed43ed434f592",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "on",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2190,
        "y": 440,
        "wires": [
            [
                "9822aadb4fefc223"
            ]
        ]
    },
    {
        "id": "5bdcf016e1f85dbb",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "name": "tempOn",
        "property": "tempOn",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1850,
        "y": 440,
        "wires": [
            [
                "b98ed43ed434f592",
                "7fc89e135a3adee4"
            ],
            [
                "285cb9c7972e3fbe"
            ]
        ]
    },
    {
        "id": "e918f8d13fc04e78",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "name": "tempOn",
        "property": "tempOn",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1630,
        "y": 340,
        "wires": [
            [
                "08333d7b6ea2e379",
                "62675ffd5dce14c9",
                "ddb970b756679f1f",
                "debf4b12354eb325"
            ],
            []
        ]
    },
    {
        "id": "c5143baa6f42424a",
        "type": "ui-button",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "name": "",
        "label": "ON",
        "order": 3,
        "width": 1,
        "height": 1,
        "emulateClick": true,
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "iconPosition": "left",
        "payload": "true",
        "payloadType": "bool",
        "topic": "topic",
        "topicType": "msg",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "enableClick": true,
        "enablePointerdown": false,
        "pointerdownPayload": "",
        "pointerdownPayloadType": "str",
        "enablePointerup": false,
        "pointerupPayload": "",
        "pointerupPayloadType": "str",
        "x": 2530,
        "y": 940,
        "wires": [
            [
                "89039e1970a0a5d1"
            ]
        ]
    },
    {
        "id": "c5312556de1c1814",
        "type": "ui-button",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "name": "",
        "label": "OFF",
        "order": 5,
        "width": 1,
        "height": 1,
        "emulateClick": true,
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "iconPosition": "left",
        "payload": "false",
        "payloadType": "bool",
        "topic": "topic",
        "topicType": "msg",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "enableClick": true,
        "enablePointerdown": false,
        "pointerdownPayload": "",
        "pointerdownPayloadType": "str",
        "enablePointerup": false,
        "pointerupPayload": "",
        "pointerupPayloadType": "str",
        "x": 2530,
        "y": 900,
        "wires": [
            [
                "bc012315bdc1402b"
            ]
        ]
    },
    {
        "id": "743270c506954acb",
        "type": "ui-button",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "name": "",
        "label": "AUTO",
        "order": 4,
        "width": 2,
        "height": 1,
        "emulateClick": true,
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "iconPosition": "left",
        "payload": "true",
        "payloadType": "bool",
        "topic": "topic",
        "topicType": "msg",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "enableClick": true,
        "enablePointerdown": false,
        "pointerdownPayload": "",
        "pointerdownPayloadType": "str",
        "enablePointerup": false,
        "pointerupPayload": "",
        "pointerupPayloadType": "str",
        "x": 2530,
        "y": 980,
        "wires": [
            [
                "cc4503be27c747c6"
            ]
        ]
    },
    {
        "id": "467c6dd614d1b0b2",
        "type": "ui-text",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "order": 12,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "Upstairs",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 3160,
        "y": 900,
        "wires": []
    },
    {
        "id": "f931fb38293f9459",
        "type": "ui-text",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "order": 11,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "Downstairs",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 3150,
        "y": 940,
        "wires": []
    },
    {
        "id": "5006051d4b49212f",
        "type": "ui-text",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "order": 8,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "Desired",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "className": "",
        "x": 3160,
        "y": 980,
        "wires": []
    },
    {
        "id": "6a5b52aba9f3ece5",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "upstairsCurrentTemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2960,
        "y": 900,
        "wires": [
            [
                "467c6dd614d1b0b2"
            ]
        ]
    },
    {
        "id": "cfea2d055c08f19c",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "downstairsCurrentTemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2960,
        "y": 940,
        "wires": [
            [
                "f931fb38293f9459"
            ]
        ]
    },
    {
        "id": "9eeb81e767f51acc",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "desiredTemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2960,
        "y": 980,
        "wires": [
            [
                "5006051d4b49212f"
            ]
        ]
    },
    {
        "id": "1449198c82b3b119",
        "type": "ui-text",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "order": 10,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "correctedTemp",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "wrapText": false,
        "className": "",
        "x": 3140,
        "y": 860,
        "wires": []
    },
    {
        "id": "53679c15849cd0c8",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "correctedTemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2960,
        "y": 860,
        "wires": [
            [
                "1449198c82b3b119"
            ]
        ]
    },
    {
        "id": "06ebc71a4ab3f5f7",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "INform UI",
        "links": [
            "457692128ee23e46"
        ],
        "x": 2745,
        "y": 1060,
        "wires": [
            [
                "1475022137865372",
                "74aa829f48fc2100"
            ]
        ]
    },
    {
        "id": "52bd0ca5bdbd2508",
        "type": "ui-text",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "order": 13,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "Fanlevel",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "wrapText": false,
        "className": "",
        "x": 3160,
        "y": 1020,
        "wires": []
    },
    {
        "id": "62f0f4d01db09a70",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "fanlevel",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2960,
        "y": 1020,
        "wires": [
            [
                "52bd0ca5bdbd2508"
            ]
        ]
    },
    {
        "id": "4f925d17b1ea8d73",
        "type": "ui-text",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "order": 9,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "Mode",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "wrapText": false,
        "className": "",
        "x": 3150,
        "y": 820,
        "wires": []
    },
    {
        "id": "d52401a79cb512dd",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "mode",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2960,
        "y": 820,
        "wires": [
            [
                "4f925d17b1ea8d73"
            ]
        ]
    },
    {
        "id": "1869abf7f9728544",
        "type": "ui-text",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "order": 14,
        "width": "2",
        "height": "1",
        "name": "",
        "label": "Swing",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "wrapText": false,
        "className": "",
        "x": 3150,
        "y": 1060,
        "wires": []
    },
    {
        "id": "74aa829f48fc2100",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "swing",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2960,
        "y": 1060,
        "wires": [
            [
                "1869abf7f9728544"
            ]
        ]
    },
    {
        "id": "bb8a6a517e03101b",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "controlReason",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2960,
        "y": 780,
        "wires": [
            [
                "23a0a23e83bb2272"
            ]
        ]
    },
    {
        "id": "23a0a23e83bb2272",
        "type": "ui-text",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "group": "f9c985920afe1003",
        "order": 2,
        "width": "4",
        "height": 1,
        "name": "controlReason",
        "label": "controlReason",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#717171",
        "wrapText": true,
        "className": "",
        "x": 3180,
        "y": 780,
        "wires": []
    },
    {
        "id": "15d4b4feb7098d7e",
        "type": "ui-event",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "ui": "7f0c45a9432dc256",
        "name": "",
        "x": 2530,
        "y": 800,
        "wires": [
            [
                "1475022137865372"
            ]
        ]
    },
    {
        "id": "bc012315bdc1402b",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "Set OFF",
        "mode": "link",
        "links": [
            "be9ef2d4c60fd585"
        ],
        "x": 2645,
        "y": 900,
        "wires": []
    },
    {
        "id": "89039e1970a0a5d1",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "Set ON",
        "mode": "link",
        "links": [
            "8985e65480168482"
        ],
        "x": 2645,
        "y": 940,
        "wires": []
    },
    {
        "id": "cc4503be27c747c6",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "Set Auto",
        "mode": "link",
        "links": [
            "e86152c2ae37059a",
            "79507ddcefcbb384"
        ],
        "x": 2645,
        "y": 980,
        "wires": []
    },
    {
        "id": "e86152c2ae37059a",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "name": "set auto",
        "links": [
            "cc4503be27c747c6",
            "ea220f9a35ae94f7"
        ],
        "x": 1025,
        "y": 380,
        "wires": [
            [
                "e3550bada4aa7e84"
            ]
        ]
    },
    {
        "id": "8985e65480168482",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "name": "set on",
        "links": [
            "89039e1970a0a5d1"
        ],
        "x": 1025,
        "y": 420,
        "wires": [
            [
                "97f665b7d0f37edb"
            ]
        ]
    },
    {
        "id": "be9ef2d4c60fd585",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "name": "set off",
        "links": [
            "bc012315bdc1402b"
        ],
        "x": 1025,
        "y": 460,
        "wires": [
            [
                "f21c93b649b3b7c3"
            ]
        ]
    },
    {
        "id": "4612eef7681e0d1a",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2380,
        "y": 880,
        "wires": [
            [
                "c5312556de1c1814"
            ]
        ]
    },
    {
        "id": "9f623d1ae551f25d",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2380,
        "y": 940,
        "wires": [
            [
                "c5143baa6f42424a"
            ]
        ]
    },
    {
        "id": "121734b2adcf737b",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "g": "f47df439800601fb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 2380,
        "y": 980,
        "wires": [
            [
                "743270c506954acb"
            ]
        ]
    },
    {
        "id": "25b66e388ba658c4",
        "type": "api-call-service",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "server": "c8d8b6d992397cb8",
        "version": 7,
        "debugenabled": false,
        "action": "climate.turn_on",
        "floorId": [],
        "areaId": [],
        "deviceId": [
            "5a4e2f4e0df2023b5ff44b3687215459"
        ],
        "entityId": [],
        "labelId": [],
        "data": "20",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "blockInputOverrides": true,
        "domain": "climate",
        "service": "turn_on",
        "x": 2080,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "9f82fb748a2d0efe",
        "type": "function",
        "z": "5f6e89b4b8794e08",
        "name": "Initialize Configuration",
        "func": "// ═══════════════════════════════════════════════════════════════════════\n// HEAT PUMP CONTROL CONFIGURATION\n// Initialize all constants and defaults for the heat pump control system\n// ═══════════════════════════════════════════════════════════════════════\n\n// Temperature limits\nflow.set('minTemp', 20);\nflow.set('maxTemp', 30);\nflow.set('safetyMin', 15);\nflow.set('safetyMax', 30);\n\n// Control parameters\nflow.set('comfortTolerance', 0.5);          // Degrees +/- for comfort range\nflow.set('minOnOffTimeSec', 600);           // 10 minutes minimum between mode changes\nflow.set('learningRate', 0.08);             // Performance adjustment factor\nflow.set('maxTempHistory', 12);             // History records to maintain\n\n// Zone balancing\nflow.set('maxZoneDifference', 2.5);         // Max acceptable temp diff between zones\nflow.set('upstairsComfortMin', 19.5);       // Minimum upstairs comfort in winter\nflow.set('circulationTempDiff', 1.8);       // Trigger circulation threshold\n\n// Seasonal thresholds\nflow.set('summerMorningHeatThreshold', 20); // Summer morning heat trigger\nflow.set('airCirculationThreshold', 23.0);  // Summer circulation trigger\n\n// Safety validation\nflow.set('absoluteMinTemp', 15);            // Hard minimum\nflow.set('absoluteMaxTemp', 30);            // Hard maximum\nflow.set('crossFloorLimit', 5);             // Max temp difference for safety\n\n// Default modes\nflow.set('defaultSwing', 'fixedBottom');\nflow.set('primaryMode', 'auto');\nflow.set('focusArea', 'downstairs');\nflow.set('seasonName', 'Winter');\n\nnode.status({fill:\"green\", shape:\"dot\", text:\"Configuration loaded\"});\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 880,
        "wires": [
            []
        ]
    },
    {
        "id": "3dbf20e9a1e7229c",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "name": "Update Season",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 5,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 920,
        "wires": [
            [
                "f6841127ca7f8591",
                "9f82fb748a2d0efe"
            ]
        ]
    },
    {
        "id": "f6841127ca7f8591",
        "type": "function",
        "z": "5f6e89b4b8794e08",
        "name": "Enhanced Seasonal Detection",
        "func": "// ═══════════════════════════════════════════════════════════════════════\n// ENHANCED SEASONAL DETECTION WITH OUTSIDE TEMPERATURE WEIGHTING\n// Combines month-based detection with actual weather for smart mode selection\n// ═══════════════════════════════════════════════════════════════════════\n\nconst currentMonth = new Date().getMonth() + 1; // 1-12\nconst currentDate = new Date();\nconst outsideTemp = Number(flow.get('OutsideTemp')) || 10;\nconst manualSummer = flow.get('SummerTime');\n\n// Get or initialize temperature history for trend analysis\nlet tempHistory = flow.get('outsideTempHistory') || [];\ntempHistory.unshift(outsideTemp);\nif (tempHistory.length > 7) tempHistory = tempHistory.slice(0, 7); // Keep 7 readings\nflow.set('outsideTempHistory', tempHistory);\n\nconst avgOutsideTemp = tempHistory.reduce((a, b) => a + b, 0) / tempHistory.length;\n\n// Auto-detect base season from calendar\nlet baseSeasonSummer = currentMonth >= 5 && currentMonth <= 9;\n\n// ─────────────────────────────────────────────────────────────────────\n// WEIGHTED SEASONAL DECISION\n// Consider both month and actual outdoor temperature\n// ─────────────────────────────────────────────────────────────────────\nlet isSummer = baseSeasonSummer;\nlet seasonOverrideReason = null;\n\n// If auto-detected winter BUT outside is warm for 3+ days, enable cooling capability\nif (!baseSeasonSummer && tempHistory.length >= 3) {\n    const recentWarm = tempHistory.slice(0, 3).every(t => t > 18);\n    if (recentWarm && avgOutsideTemp > 18) {\n        isSummer = true;\n        seasonOverrideReason = 'Warm winter weather - cooling enabled';\n    }\n}\n\n// If auto-detected summer BUT outside is cold, enable heating priority\nif (baseSeasonSummer && avgOutsideTemp < 12) {\n    isSummer = false;\n    seasonOverrideReason = 'Cold summer weather - heating priority';\n}\n\n// Manual override always wins (for testing/special cases)\nif (manualSummer !== undefined) {\n    isSummer = manualSummer;\n    seasonOverrideReason = 'Manual override';\n}\n\n// ─────────────────────────────────────────────────────────────────────\n// SET SEASONAL PARAMETERS\n// ─────────────────────────────────────────────────────────────────────\nconst seasonName = isSummer ? 'Summer' : 'Winter';\nconst focusArea = isSummer ? 'Upstairs' : 'Downstairs';\nconst primaryMode = isSummer ? 'cool' : 'heat';\nconst defaultSwing = isSummer ? 'fixedTop' : 'fixedBottom';\n\n// Temperature safety ranges\nconst safetyMin = isSummer ? 18 : 20;\nconst safetyMax = isSummer ? 24 : 25;\nconst comfortRange = isSummer ? '18-24°C' : '20-25°C';\n\n// Store in flow context\nflow.set('SummerTime', isSummer);\nflow.set('seasonName', seasonName);\nflow.set('focusArea', focusArea);\nflow.set('primaryMode', primaryMode);\nflow.set('defaultSwing', defaultSwing);\nflow.set('safetyMin', safetyMin);\nflow.set('safetyMax', safetyMax);\nflow.set('seasonOverrideReason', seasonOverrideReason);\n\n// Enhanced status display\nconst statusText = seasonOverrideReason \n    ? `${seasonName} (${seasonOverrideReason}) - ${avgOutsideTemp.toFixed(1)}°C outside`\n    : `${seasonName} Mode - ${focusArea} focus (${comfortRange})`;\n\nnode.status({\n    fill: isSummer ? 'yellow' : 'blue',\n    shape: 'dot',\n    text: statusText\n});\n\nreturn {\n    payload: {\n        season: seasonName,\n        isSummer: isSummer,\n        focusArea: focusArea,\n        primaryMode: primaryMode,\n        defaultSwing: defaultSwing,\n        safetyRange: comfortRange,\n        outsideTemp: outsideTemp,\n        avgOutsideTemp: avgOutsideTemp.toFixed(1),\n        baseSeasonSummer: baseSeasonSummer,\n        overrideReason: seasonOverrideReason,\n        autoDetected: manualSummer === undefined,\n        timestamp: currentDate.toISOString()\n    }\n};",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "653ee69479574493",
        "type": "time-range-switch",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "06:30",
        "endTime": "08:30",
        "startOffset": 0,
        "endOffset": 0,
        "x": 910,
        "y": 300,
        "wires": [
            [
                "f77cb4061dc4397a"
            ],
            [
                "630cbb9487fd2a7e"
            ]
        ]
    },
    {
        "id": "f77cb4061dc4397a",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "MorningHeat",
        "rules": [
            {
                "t": "set",
                "p": "isMorning",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1070,
        "y": 280,
        "wires": [
            [
                "ba8ce925d1c791d1"
            ]
        ]
    },
    {
        "id": "630cbb9487fd2a7e",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "Not MOrning",
        "rules": [
            {
                "t": "set",
                "p": "isMorning",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1070,
        "y": 320,
        "wires": [
            [
                "ba8ce925d1c791d1"
            ]
        ]
    },
    {
        "id": "ba8ce925d1c791d1",
        "type": "function",
        "z": "5f6e89b4b8794e08",
        "name": "Improved Temperature Control",
        "func": "// ═══════════════════════════════════════════════════════════════════════\n// INTELLIGENT HEAT PUMP TEMPERATURE CONTROL - V2 (WINTER HEAT ONLY)\n// Simplified, cleaner logic - WINTER MODE IS ALWAYS HEAT\n// ═══════════════════════════════════════════════════════════════════════\n\n// ─────────────────────────────────────────────────────────────────────\n// CONFIGURATION & CONSTANTS\n// ─────────────────────────────────────────────────────────────────────\nconst CONFIG = {\n    // Comfort ranges\n    COMFORT_TARGET_MIN: 20,\n    COMFORT_TARGET_MAX: 23,\n    COMFORT_TOLERANCE: 0.5,\n\n    // Zone temperature management\n    MAX_ZONE_DIFF: 2.5,           // Max acceptable difference between zones\n    UPSTAIRS_MIN_COMFORT: 19.5,   // Minimum upstairs comfort in winter\n\n    // Thresholds for mode selection based on outside temp\n    HEAT_BELOW_OUTSIDE: 10,       // If outside < 10°C, prioritize heat\n    COOL_ABOVE_OUTSIDE: 25,       // If outside > 25°C, prioritize cool\n\n    // Timing & control\n    MIN_MODE_CHANGE_SEC: 600,     // 10 minutes between mode changes\n    MORNING_START_HOUR: 6,\n    MORNING_END_HOUR: 8,\n    EVENING_START_HOUR: 20,\n\n    // Away mode\n    AWAY_UPDATE_INTERVAL_SEC: 1200, // 20 minutes between away commands\n};\n\n// ─────────────────────────────────────────────────────────────────────\n// INPUT SENSORS & STATE\n// ─────────────────────────────────────────────────────────────────────\nconst upstairsTemp = Number(flow.get('upstairsCurrentTemp')) || 20;\nconst downstairsTemp = Number(flow.get('downstairsCurrentTemp')) || 20;\nconst outsideTemp = Number(flow.get('OutsideTemp')) || 15;\nconst desiredTemp = Number(flow.get('desiredTemp')) || 21;\n\nconst isSummer = flow.get('SummerTime') || false;\nconst homeStatus = global.get('Mode') || 'home';    // home, away, sleep, vacation\nconst currentHour = new Date().getHours();\nconst isWeekend = global.get('isWeekend') || false;\n\n\n// State tracking\nconst now = Date.now();\nconst lastModeChangeTime = flow.get('lastModeChangeTime') || 0;\nconst lastAwayCommandTime = flow.get('lastAwayCommandTime') || 0;\nconst lastAwayCommand = flow.get('lastAwayCommand') || null;\n\n// ─────────────────────────────────────────────────────────────────────\n// HELPER FUNCTIONS\n// ─────────────────────────────────────────────────────────────────────\n\nfunction clamp(value, min, max) {\n    return Math.max(min, Math.min(max, value));\n}\n\nfunction getOutsideTempFactor() {\n    // Returns heating/cooling aggression multiplier based on outside temp\n    if (outsideTemp <= -5) return 1.5;    // Very cold - aggressive heat\n    if (outsideTemp <= 0) return 1.3;\n    if (outsideTemp <= 5) return 1.15;\n    if (outsideTemp >= 30) return 1.4;    // Very hot - aggressive cool\n    if (outsideTemp >= 25) return 1.2;\n    return 1.0;                            // Mild - normal\n}\n\nfunction getWeightedTemp(upstairs, downstairs, season) {\n    // Winter: favor downstairs (warm air rises, so downstairs gets cooler)\n    // Summer: favor upstairs (cool air falls, so upstairs gets warmer)\n    const upWeight = season ? 0.65 : 0.35; // isSummer ? 0.65 : 0.35\n    return upstairs * upWeight + downstairs * (1 - upWeight);\n}\n\nfunction getZoneDifference() {\n    return Math.abs(upstairsTemp - downstairsTemp);\n}\n\nfunction isMorningTime() {\n    return currentHour >= CONFIG.MORNING_START_HOUR &&\n        currentHour < CONFIG.MORNING_END_HOUR;\n}\n\nfunction isQuietTime() {\n    // Quiet hours: weekend before 10am, or bedtime mode\n    return (isWeekend && currentHour < 10) ;\n}\n\nfunction getFanLevel(tempDiff) {\n    // Map temperature difference to fan level\n    if (tempDiff <= 0.5) return 'low';\n    if (tempDiff <= 1.0) return 'medium';\n    if (tempDiff <= 3.0) return 'medium_high';\n    return 'high';\n}\n\nfunction limitFan(fan) {\n    // Respect quiet times\n    if (!isQuietTime()) return fan;\n    const fanLevels = ['quiet', 'low', 'medium', 'medium_high', 'high', 'strong'];\n    const quietMax = 'low' ;\n    const maxIdx = fanLevels.indexOf(quietMax);\n    const currentIdx = fanLevels.indexOf(fan);\n    return currentIdx > maxIdx ? quietMax : fan;\n}\n\nfunction canChangeMode() {\n    const secSinceChange = (now - lastModeChangeTime) / 1000;\n    return secSinceChange >= CONFIG.MIN_MODE_CHANGE_SEC;\n}\n\nfunction commandToHash(cmd) {\n    // Convert command to hashable string for deduplication\n    return JSON.stringify({\n        mode: cmd.mode,\n        temp: cmd.targetTemp,\n        fan: cmd.fanLevel,\n        swing: cmd.swing\n    });\n}\n\n// ─────────────────────────────────────────────────────────────────────\n// MAIN CONTROL LOGIC\n// ─────────────────────────────────────────────────────────────────────\n\n// FIXED: Initialize mode based on season - winter defaults to 'heat', never 'fan'\nlet mode = isSummer ? 'fan' : 'heat';\nlet targetTemp = desiredTemp;\nlet fanLevel = 'low';\nlet swing = isSummer ? 'fixedTop' : 'fixedBottom';\nlet shouldTurnOn = false;\nlet reason = '';\n\n// ═══════════════════════════════════════════════════════════════════════\n// AWAY MODE: Dog protection with reduced cycling\n// ═══════════════════════════════════════════════════════════════════════\nif (homeStatus === 'away') {\n    const AWAY_TARGET_MIN = 20;\n    const AWAY_TARGET_MAX = 23;\n    const AWAY_DOWNSTAIRS_SAFETY = 18;  // Never let it get too cold\n\n    const zoneDiff = getZoneDifference();\n    const avgTemp = getWeightedTemp(upstairsTemp, downstairsTemp, isSummer);\n\n    // Check throttle: don't send identical commands more than every 20 min\n    const timeSinceLastAway = (now - lastAwayCommandTime) / 1000;\n    const currentCommandHash = commandToHash({\n        mode: mode,\n        targetTemp: targetTemp,\n        fanLevel: fanLevel,\n        swing: swing\n    });\n\n    if (currentCommandHash === lastAwayCommand && timeSinceLastAway < CONFIG.AWAY_UPDATE_INTERVAL_SEC) {\n        shouldTurnOn = false;\n        reason = `Away mode: throttled (${Math.round(timeSinceLastAway / 60)}m)`;\n    } else {\n        // Determine strategy based on outside temperature\n        if (isSummer && outsideTemp > 25) {\n            // Hot summer: cool upstairs for dog comfort\n            if (upstairsTemp > AWAY_TARGET_MAX) {\n                mode = 'cool';\n                targetTemp = AWAY_TARGET_MAX - 1;\n                fanLevel = limitFan('medium');\n                swing = 'fixedTop';\n                shouldTurnOn = true;\n                reason = `Away summer: cooling upstairs (${upstairsTemp.toFixed(1)}°C)`;\n            } else {\n                shouldTurnOn = false;\n                reason = `Away summer: within range`;\n            }\n        } else if (outsideTemp < 10) {\n            // Cold winter: maintain warmth for dog\n            if (avgTemp < AWAY_TARGET_MIN) {\n                mode = 'heat';\n                targetTemp = AWAY_TARGET_MIN + 1;\n                fanLevel = limitFan('low');\n                swing = downstairsTemp < upstairsTemp ? 'fixedBottom' : 'fixedTop';\n                shouldTurnOn = true;\n                reason = `Away winter: heating (avg ${avgTemp.toFixed(1)}°C)`;\n            } else {\n                shouldTurnOn = false;\n                reason = `Away winter: within range`;\n            }\n        } else {\n            // Mild weather: minimal intervention\n            if (downstairsTemp < AWAY_DOWNSTAIRS_SAFETY) {\n                mode = 'heat';\n                targetTemp = AWAY_TARGET_MIN;\n                fanLevel = limitFan('low');\n                shouldTurnOn = true;\n                reason = `Away: preventing cold (downstairs ${downstairsTemp.toFixed(1)}°C)`;\n            } else {\n                shouldTurnOn = false;\n                reason = `Away mild: comfortable`;\n            }\n        }\n\n        // Update throttle tracking\n        flow.set('lastAwayCommandTime', now);\n        flow.set('lastAwayCommand', currentCommandHash);\n    }\n    reason += ' [AWAY]';\n}\n\n// ═══════════════════════════════════════════════════════════════════════\n// NORMAL HOME MODE\n// ═══════════════════════════════════════════════════════════════════════\nelse if (homeStatus === 'home') {\n    const zoneDiff = getZoneDifference();\n    const weighted = getWeightedTemp(upstairsTemp, downstairsTemp, isSummer);\n    const outsideFactor = getOutsideTempFactor();\n\n    // ─────────────────────────────────────────────────────────────────\n    // MORNING TIME: Gentle heating to wake up\n    // ─────────────────────────────────────────────────────────────────\n    if (isMorningTime()) {\n        if (downstairsTemp < desiredTemp) {\n            mode = 'heat';\n            targetTemp = desiredTemp;\n            fanLevel = limitFan('low');\n            swing = 'fixedBottom';\n            shouldTurnOn = true;\n            reason = `Morning: gentle wake-up heating`;\n        } else {\n            shouldTurnOn = false;\n            reason = `Morning: comfortable`;\n        }\n    }\n\n    // ─────────────────────────────────────────────────────────────────\n    // SUMMER OPERATION\n    // ─────────────────────────────────────────────────────────────────\n    else if (isSummer) {\n        if (upstairsTemp > CONFIG.COMFORT_TARGET_MAX + 1) {\n            // Active cooling needed\n            mode = 'cool';\n            const tempExcess = upstairsTemp - CONFIG.COMFORT_TARGET_MAX;\n            targetTemp = clamp(desiredTemp - (tempExcess * outsideFactor), 18, desiredTemp);\n            fanLevel = limitFan(getFanLevel(tempExcess));\n            swing = 'fixedTop';\n            shouldTurnOn = true;\n            reason = `Summer cooling: upstairs ${upstairsTemp.toFixed(1)}°C`;\n        }\n        else if (zoneDiff > CONFIG.MAX_ZONE_DIFF) {\n            // Zone balancing - circulation (only in summer)\n            mode = 'fan';\n            fanLevel = limitFan('low');\n            swing = 'rangeFull';\n            shouldTurnOn = true;\n            reason = `Summer: zone balancing (diff ${zoneDiff.toFixed(1)}°C)`;\n        }\n        else if (weighted < CONFIG.COMFORT_TARGET_MIN) {\n            // Comfort heating (rare in summer)\n            mode = 'heat';\n            targetTemp = desiredTemp;\n            fanLevel = limitFan('low');\n            swing = 'fixedBottom';\n            shouldTurnOn = true;\n            reason = `Summer: comfort heating (avg ${weighted.toFixed(1)}°C)`;\n        }\n        else {\n            shouldTurnOn = false;\n            reason = `Summer: comfortable`;\n        }\n    }\n\n    // ─────────────────────────────────────────────────────────────────\n    // WINTER OPERATION - ALWAYS HEAT, NEVER FAN MODE\n    // ─────────────────────────────────────────────────────────────────\n    else {\n        // Priority 1: Downstairs main heating\n        if (downstairsTemp < desiredTemp - CONFIG.COMFORT_TOLERANCE) {\n            mode = 'heat';\n            const deficit = desiredTemp - downstairsTemp;\n            targetTemp = clamp(desiredTemp + (deficit * 0.5 * outsideFactor), desiredTemp, desiredTemp + 3);\n            fanLevel = limitFan(getFanLevel(deficit));\n            swing = 'fixedBottom';  // Heat sinks, so bottom blower\n            shouldTurnOn = true;\n            reason = `Winter: downstairs primary heating (${downstairsTemp.toFixed(1)}°C)`;\n        }\n\n        // Priority 2: Upstairs comfort heating\n        else if (upstairsTemp < CONFIG.UPSTAIRS_MIN_COMFORT &&\n            downstairsTemp > desiredTemp - 0.5) {\n            mode = 'heat';\n            targetTemp = desiredTemp;\n            fanLevel = limitFan('low');\n            swing = 'fixedTop';  // Boost upstairs\n            shouldTurnOn = true;\n            reason = `Winter: upstairs comfort (${upstairsTemp.toFixed(1)}°C < ${CONFIG.UPSTAIRS_MIN_COMFORT}°C)`;\n        }\n\n        // Priority 3: Zone balancing - HEAT, NEVER FAN\n        else if (zoneDiff > CONFIG.MAX_ZONE_DIFF) {\n            if (downstairsTemp < upstairsTemp - CONFIG.MAX_ZONE_DIFF) {\n                // Downstairs too cold - heat it aggressively\n                mode = 'heat';\n                targetTemp = desiredTemp;\n                fanLevel = limitFan('medium_high');\n                swing = 'fixedBottom';\n                shouldTurnOn = true;\n                reason = `Winter: zone balance heating (downstairs ${zoneDiff.toFixed(1)}°C colder)`;\n            } else {\n                // Upstairs too cold - heat with top blower\n                mode = 'heat';\n                targetTemp = desiredTemp;\n                fanLevel = limitFan('medium');\n                swing = 'fixedTop';\n                shouldTurnOn = true;\n                reason = `Winter: zone balance heating (upstairs ${zoneDiff.toFixed(1)}°C colder)`;\n            }\n        }\n\n        // Priority 4: General comfort maintenance\n        else if (weighted < desiredTemp - CONFIG.COMFORT_TOLERANCE) {\n            mode = 'heat';\n            targetTemp = desiredTemp;\n            fanLevel = limitFan('low');\n            swing = 'fixedBottom';\n            shouldTurnOn = true;\n            reason = `Winter: maintain comfort (avg ${weighted.toFixed(1)}°C)`;\n        }\n\n        // Comfortable - turn off, don't use fan circulation\n        else {\n            shouldTurnOn = false;\n            reason = `Winter: comfortable (avg ${weighted.toFixed(1)}°C) - off`;\n        }\n    }\n}\n\n// ═══════════════════════════════════════════════════════════════════════\n// OTHER MODES: Sleep & Vacation\n// ═══════════════════════════════════════════════════════════════════════\nelse if (homeStatus === 'sleep' || homeStatus === 'vacation') {\n    // Bedtime is handled by separate Bedtime Controller\n    // Vacation: system should be OFF (handled by main flow)\n    shouldTurnOn = false;\n    reason = `${homeStatus} mode: minimal control`;\n}\n\n// ─────────────────────────────────────────────────────────────────────\n// SAFETY LIMITS & MODE CHANGE PROTECTION\n// ─────────────────────────────────────────────────────────────────────\nconst lastMode = flow.get('lastControlMode') || mode;\nif (mode !== lastMode && !canChangeMode()) {\n    // FIXED: Don't default to 'fan' when blocking mode changes in winter\n    shouldTurnOn = false;\n    // Keep the current mode instead of defaulting to fan\n    mode = lastMode;\n    reason += ` [Mode change blocked: ${Math.round((CONFIG.MIN_MODE_CHANGE_SEC - (now - lastModeChangeTime) / 1000))}s]`;\n} else if (mode !== lastMode) {\n    flow.set('lastModeChangeTime', now);\n    flow.set('lastControlMode', mode);\n}\n\n// Enforce safety limits\nif (upstairsTemp > 30 || downstairsTemp > 30) {\n    mode = 'cool';\n    fanLevel = 'high';\n    targetTemp = 24;\n    shouldTurnOn = true;\n    reason = `SAFETY: Emergency cooling (temp > 30°C)`;\n}\n\nif (upstairsTemp < 15 || downstairsTemp < 15) {\n    mode = 'heat';\n    fanLevel = 'high';\n    targetTemp = 22;\n    shouldTurnOn = true;\n    reason = `SAFETY: Emergency heating (temp < 15°C)`;\n}\n\n// ─────────────────────────────────────────────────────────────────────\n// FINALIZE OUTPUT\n// ─────────────────────────────────────────────────────────────────────\nflow.set('mode', mode);\nflow.set('swing', swing);\nflow.set('fanlevel', fanLevel);\nflow.set('correctedTemp', Math.round(targetTemp));\nflow.set('shouldTurnOn', shouldTurnOn);\nflow.set('controlReason', reason);\n\nreturn {\n    payload: {\n        mode: mode,\n        swing: swing,\n        fanLevel: fanLevel,\n        targetTemperature: Math.round(targetTemp),\n        shouldTurnOn: shouldTurnOn,\n        reason: reason,\n        status: {\n            upstairsTemp: upstairsTemp.toFixed(1),\n            downstairsTemp: downstairsTemp.toFixed(1),\n            outsideTemp: outsideTemp.toFixed(1),\n            zoneDiff: getZoneDifference().toFixed(1),\n            homeStatus: homeStatus,\n            season: isSummer ? 'Summer' : 'Winter',\n            weighted: getWeightedTemp(upstairsTemp, downstairsTemp, isSummer).toFixed(1)\n        },\n        timestamp: new Date().toISOString()\n    }\n};",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1330,
        "y": 300,
        "wires": [
            [
                "e918f8d13fc04e78"
            ]
        ]
    },
    {
        "id": "d7e26204bfd0191f",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "Heatpump Data",
        "rules": [
            {
                "t": "set",
                "p": "targetTemperature",
                "pt": "msg",
                "to": "correctedTemp",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "mode",
                "pt": "msg",
                "to": "mode",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "swing",
                "pt": "msg",
                "to": "fixedBottom",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fanlevel",
                "pt": "msg",
                "to": "fanlevel",
                "tot": "flow"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_msgid",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_event",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "on",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 520,
        "wires": [
            [
                "9822aadb4fefc223"
            ]
        ]
    },
    {
        "id": "a1360aa94e6f4fb6",
        "type": "function",
        "z": "5f6e89b4b8794e08",
        "name": "Unified Command Batcher",
        "func": "// ═══════════════════════════════════════════════════════════════════════\n// UNIFIED COMMAND BATCHER - Node-RED Best Practices\n// Prevents duplicate commands by batching changes over 10-second window\n// ═══════════════════════════════════════════════════════════════════════\n\nconst BATCH_WINDOW_MS = 10000;           // 10 second batching window\nconst MIN_IDENTICAL_INTERVAL_MS = 300000; // 5 minutes (prevent beeping)\n\n// Initialize state in flow context (survives across invocations)\nlet state = flow.get('batcherState') || {};\n\n// Build command from current message (only include values that exist)\nconst incoming = {\n    on: msg.on,\n    mode: msg.mode,\n    targetTemperature: msg.targetTemperature,\n    fanlevel: msg.fanlevel,\n    swing: msg.swing\n};\n\n// Accumulate changes into pending command\nstate.pending = Object.assign(state.pending || {}, \n    Object.fromEntries(\n        Object.entries(incoming).filter(([_, v]) => v !== undefined)\n    )\n);\n\n// Helper: Convert command to comparable string hash\nfunction getHash(cmd) {\n    if (!cmd) return '';\n    return JSON.stringify(cmd, Object.keys(cmd).sort());\n}\n\n// Cancel existing timer\nif (state.timer) clearTimeout(state.timer);\n\n// Set new timer to send batched command after window\nstate.timer = setTimeout(() => {\n    const pendingHash = getHash(state.pending);\n    const lastHash = getHash(state.lastSent);\n    const timeSinceLastSent = Date.now() - (state.lastSentTime || 0);\n\n    // Skip if identical command sent recently\n    if (pendingHash === lastHash && timeSinceLastSent < MIN_IDENTICAL_INTERVAL_MS) {\n        node.debug(`Blocked duplicate (${Math.round(timeSinceLastSent / 60000)}m ago)`);\n        state.pending = null;\n        state.timer = null;\n        flow.set('batcherState', state);\n        return;\n    }\n\n    // Send batched command\n    node.send(state.pending);\n    \n    // Update tracking\n    state.lastSent = state.pending;\n    state.lastSentTime = Date.now();\n    state.pending = null;\n    state.timer = null;\n    flow.set('batcherState', state);\n    \n    node.status({ fill: 'green', shape: 'dot', text: 'Sent' });\n}, BATCH_WINDOW_MS);\n\nflow.set('batcherState', state);\nnode.status({ fill: 'yellow', shape: 'ring', text: 'Batching...' });\n\nreturn null; // Don't pass through immediately",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 2220,
        "y": 280,
        "wires": [
            [
                "9822aadb4fefc223"
            ]
        ]
    },
    {
        "id": "debf4b12354eb325",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "Heatpump mode",
        "rules": [
            {
                "t": "set",
                "p": "mode",
                "pt": "msg",
                "to": "mode",
                "tot": "flow"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_msgid",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_event",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1780,
        "y": 200,
        "wires": [
            [
                "a1360aa94e6f4fb6"
            ]
        ]
    },
    {
        "id": "ddb970b756679f1f",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "Heatpump targetTemperature",
        "rules": [
            {
                "t": "set",
                "p": "targetTemperature",
                "pt": "msg",
                "to": "correctedTemp",
                "tot": "flow"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_msgid",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_event",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1810,
        "y": 240,
        "wires": [
            [
                "a1360aa94e6f4fb6"
            ]
        ]
    },
    {
        "id": "08333d7b6ea2e379",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "Heatpump swing",
        "rules": [
            {
                "t": "set",
                "p": "swing",
                "pt": "msg",
                "to": "swing",
                "tot": "flow"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_msgid",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_event",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1820,
        "y": 340,
        "wires": [
            [
                "a1360aa94e6f4fb6"
            ]
        ]
    },
    {
        "id": "62675ffd5dce14c9",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "Heatpump fanlevel",
        "rules": [
            {
                "t": "set",
                "p": "fanlevel",
                "pt": "msg",
                "to": "fanlevel",
                "tot": "flow"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_msgid",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_event",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1780,
        "y": 280,
        "wires": [
            [
                "a1360aa94e6f4fb6"
            ]
        ]
    },
    {
        "id": "1e99da1c3a5ae1c2",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "name": "to batcher",
        "mode": "link",
        "links": [
            "a1360aa94e6f4fb6"
        ],
        "x": 2030,
        "y": 300,
        "wires": []
    },
    {
        "id": "3b107d2e2c2c601c",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "name": "to batcher",
        "mode": "link",
        "links": [
            "a1360aa94e6f4fb6"
        ],
        "x": 2080,
        "y": 260,
        "wires": []
    },
    {
        "id": "2b89b624ac60ea94",
        "type": "debug",
        "z": "5f6e89b4b8794e08",
        "name": "DebugMode",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2590,
        "y": 300,
        "wires": []
    },
    {
        "id": "40f942f5d83d58fa",
        "type": "ui-button",
        "z": "5f6e89b4b8794e08",
        "g": "f71cc26218871cfd",
        "group": "f9c985920afe1003",
        "name": "BEDTIME COOL",
        "label": "BEDTIME COOL",
        "order": 6,
        "width": 2,
        "height": 1,
        "emulateClick": false,
        "className": "",
        "icon": "",
        "iconPosition": "left",
        "payload": "true",
        "payloadType": "bool",
        "topic": "",
        "topicType": "str",
        "buttonColor": "",
        "textColor": "",
        "iconColor": "",
        "enableClick": true,
        "enablePointerdown": false,
        "pointerdownPayload": "",
        "pointerdownPayloadType": "str",
        "enablePointerup": false,
        "pointerupPayload": "",
        "pointerupPayloadType": "str",
        "x": 330,
        "y": 1200,
        "wires": [
            [
                "05655572c95c865b"
            ]
        ]
    },
    {
        "id": "05655572c95c865b",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "g": "f71cc26218871cfd",
        "name": "Only if HOME",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "neq",
                "v": "away",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 1,
        "x": 400,
        "y": 1160,
        "wires": [
            [
                "88b2a7e6a183531d"
            ]
        ]
    },
    {
        "id": "02b52a19fb9a94a8",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "g": "f71cc26218871cfd",
        "name": "Bedtime (20:31 every day)",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "31 20 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 240,
        "y": 1080,
        "wires": [
            [
                "1eed1292708f5cdc"
            ]
        ]
    },
    {
        "id": "88b2a7e6a183531d",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f71cc26218871cfd",
        "name": "Set Bedtime Flags (block auto)",
        "rules": [
            {
                "t": "set",
                "p": "bedTimeMode",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "bedtimeTries",
                "pt": "flow",
                "to": "0",
                "tot": "num"
            }
        ],
        "x": 670,
        "y": 1120,
        "wires": [
            [
                "ce73bb0b0b9d3fe1"
            ]
        ]
    },
    {
        "id": "e649ec85d54ffc64",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f71cc26218871cfd",
        "name": "Reset Bedtime Flags (resume auto)",
        "rules": [
            {
                "t": "set",
                "p": "bedTimeMode",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "x": 440,
        "y": 1240,
        "wires": [
            []
        ]
    },
    {
        "id": "79507ddcefcbb384",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "f71cc26218871cfd",
        "name": "link in 7",
        "links": [
            "cc4503be27c747c6",
            "ea220f9a35ae94f7"
        ],
        "x": 225,
        "y": 1240,
        "wires": [
            [
                "e649ec85d54ffc64"
            ]
        ]
    },
    {
        "id": "f40935489ff9f776",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "f71cc26218871cfd",
        "name": "link in 8",
        "links": [
            "5ac0b196c60ad0dc"
        ],
        "x": 225,
        "y": 1160,
        "wires": [
            [
                "05655572c95c865b"
            ]
        ]
    },
    {
        "id": "1eed1292708f5cdc",
        "type": "subflow:05933d2d8abb4be7",
        "z": "5f6e89b4b8794e08",
        "g": "f71cc26218871cfd",
        "name": "",
        "x": 610,
        "y": 1080,
        "wires": [
            [
                "05655572c95c865b"
            ],
            [
                "05655572c95c865b"
            ]
        ]
    },
    {
        "id": "04e29a17e3a533be",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "name": "link in 14",
        "links": [],
        "x": 1955,
        "y": 520,
        "wires": [
            [
                "285cb9c7972e3fbe"
            ]
        ]
    },
    {
        "id": "177852695ff0ce80",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "name": "link in 16",
        "links": [],
        "x": 1885,
        "y": 400,
        "wires": [
            [
                "b98ed43ed434f592"
            ]
        ]
    },
    {
        "id": "b14ce65dd4d93e88",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "Bedtime temp",
        "links": [
            "4d769e70a92d266c"
        ],
        "x": 1075,
        "y": 880,
        "wires": [
            [
                "38d2ddc12814d3d4"
            ]
        ]
    },
    {
        "id": "38d2ddc12814d3d4",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "bedTimeMode",
        "property": "bedTimeMode",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1200,
        "y": 880,
        "wires": [
            [
                "5ac0b196c60ad0dc",
                "aab04bacfe6565e6"
            ],
            [
                "bacc30e8d43df5d6"
            ]
        ]
    },
    {
        "id": "5ac0b196c60ad0dc",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "link out 14",
        "mode": "link",
        "links": [
            "f40935489ff9f776"
        ],
        "x": 1615,
        "y": 860,
        "wires": []
    },
    {
        "id": "b8843fd017841e94",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "Pause Cool",
        "links": [
            "c4c2684c239161a6"
        ],
        "x": 1055,
        "y": 980,
        "wires": [
            [
                "c27277fd9ecc9863",
                "3652a03fbf49da8d"
            ]
        ]
    },
    {
        "id": "1348ee29e0af4c71",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "On/OFF",
        "property": "tempOn",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1440,
        "y": 980,
        "wires": [
            [
                "38e99d1fa9c9fc8d"
            ]
        ]
    },
    {
        "id": "3652a03fbf49da8d",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "",
        "property": "ovverideFanLevel",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1150,
        "y": 980,
        "wires": [
            [
                "1348ee29e0af4c71"
            ]
        ]
    },
    {
        "id": "bacc30e8d43df5d6",
        "type": "trigger",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "",
        "op1": "",
        "op2": "",
        "op1type": "nul",
        "op2type": "payl",
        "duration": "2",
        "extend": false,
        "overrideDelay": false,
        "units": "min",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 1270,
        "y": 940,
        "wires": [
            [
                "aab04bacfe6565e6"
            ]
        ]
    },
    {
        "id": "aab04bacfe6565e6",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "revert ovveride",
        "rules": [
            {
                "t": "set",
                "p": "ovverideFanLevel",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1450,
        "y": 900,
        "wires": [
            []
        ]
    },
    {
        "id": "c27277fd9ecc9863",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1160,
        "y": 1040,
        "wires": [
            [
                "bacc30e8d43df5d6"
            ]
        ]
    },
    {
        "id": "38e99d1fa9c9fc8d",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "450973d0c0bd450b",
        "name": "Override settings",
        "rules": [
            {
                "t": "set",
                "p": "ovverideFanLevel",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1510,
        "y": 1040,
        "wires": [
            []
        ]
    },
    {
        "id": "7901c75255cd967d",
        "type": "api-call-service",
        "z": "5f6e89b4b8794e08",
        "g": "73335ee4571578d7",
        "name": "",
        "server": "c8d8b6d992397cb8",
        "version": 7,
        "debugenabled": false,
        "action": "climate.set_temperature",
        "floorId": [],
        "areaId": [],
        "deviceId": [
            "5a4e2f4e0df2023b5ff44b3687215459"
        ],
        "entityId": [],
        "labelId": [],
        "data": "{}",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "blockInputOverrides": false,
        "domain": "climate",
        "service": "set_temperature",
        "x": 1450,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "4b488f47e0f68614",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "73335ee4571578d7",
        "name": "23 temp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "payload.data.temperature",
                "pt": "msg",
                "to": "23",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1200,
        "y": 680,
        "wires": [
            [
                "7d33a1463de50c5e"
            ]
        ]
    },
    {
        "id": "06e536f2bf6e0268",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "73335ee4571578d7",
        "name": "desiredTemp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "payload.data.temperature",
                "pt": "msg",
                "to": "$flowContext(\"desiredTemp\") \t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1210,
        "y": 720,
        "wires": [
            [
                "7d33a1463de50c5e"
            ]
        ]
    },
    {
        "id": "e90cdd3f58fa4665",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "73335ee4571578d7",
        "name": "link in 11",
        "links": [
            "ea220f9a35ae94f7"
        ],
        "x": 1085,
        "y": 680,
        "wires": [
            [
                "4b488f47e0f68614"
            ]
        ]
    },
    {
        "id": "51fab1af45e1f20e",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "73335ee4571578d7",
        "name": "link in 12",
        "links": [],
        "x": 1085,
        "y": 720,
        "wires": [
            [
                "06e536f2bf6e0268"
            ]
        ]
    },
    {
        "id": "0ac81ceb0e89f5ed",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "73335ee4571578d7",
        "name": "18 temp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{}",
                "tot": "json"
            },
            {
                "t": "set",
                "p": "payload.data.temperature",
                "pt": "msg",
                "to": "17",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1200,
        "y": 760,
        "wires": [
            [
                "7d33a1463de50c5e"
            ]
        ]
    },
    {
        "id": "0d106dc05c444d7d",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "73335ee4571578d7",
        "name": "link in 17",
        "links": [
            "f4659f50d862b4c5",
            "ce73bb0b0b9d3fe1"
        ],
        "x": 1085,
        "y": 760,
        "wires": [
            [
                "0ac81ceb0e89f5ed"
            ]
        ]
    },
    {
        "id": "6b7e4bb182923447",
        "type": "api-call-service",
        "z": "5f6e89b4b8794e08",
        "g": "73335ee4571578d7",
        "name": "",
        "server": "c8d8b6d992397cb8",
        "version": 7,
        "debugenabled": false,
        "action": "climate.turn_off",
        "floorId": [],
        "areaId": [],
        "deviceId": [
            "5a4e2f4e0df2023b5ff44b3687215459"
        ],
        "entityId": [],
        "labelId": [],
        "data": "20",
        "dataType": "json",
        "mergeContext": "",
        "mustacheAltTags": false,
        "outputProperties": [],
        "queue": "none",
        "blockInputOverrides": true,
        "domain": "climate",
        "service": "turn_off",
        "x": 1420,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "8c495f7925e167e4",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "Mode",
        "property": "Mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "away",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "sleep",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "vacation",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 4,
        "x": 530,
        "y": 700,
        "wires": [
            [
                "be40615f64952ea5"
            ],
            [
                "59f358e36608bc4a"
            ],
            [],
            [
                "f4659f50d862b4c5"
            ]
        ]
    },
    {
        "id": "764b200b3cf0e394",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "Set Temperature",
        "links": [
            "5c5afd3abb577912"
        ],
        "x": 235,
        "y": 700,
        "wires": [
            [
                "54bc3157303b989c"
            ]
        ]
    },
    {
        "id": "54bc3157303b989c",
        "type": "subflow:05933d2d8abb4be7",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "",
        "x": 370,
        "y": 700,
        "wires": [
            [
                "8c495f7925e167e4"
            ],
            []
        ]
    },
    {
        "id": "ea220f9a35ae94f7",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "Home",
        "mode": "link",
        "links": [
            "e90cdd3f58fa4665",
            "79507ddcefcbb384",
            "e86152c2ae37059a"
        ],
        "x": 965,
        "y": 620,
        "wires": []
    },
    {
        "id": "f4659f50d862b4c5",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "link out 15",
        "mode": "link",
        "links": [
            "0d106dc05c444d7d"
        ],
        "x": 725,
        "y": 760,
        "wires": []
    },
    {
        "id": "00cfb10ade246cfb",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "Get storedDesiredTemp",
        "rules": [
            {
                "t": "set",
                "p": "desiredTemp",
                "pt": "flow",
                "to": "storedDesiredTemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 620,
        "wires": [
            [
                "ea220f9a35ae94f7"
            ]
        ]
    },
    {
        "id": "59f358e36608bc4a",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "SummerTime",
        "property": "SummerTime",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 780,
        "y": 720,
        "wires": [
            [],
            [
                "7c316b4844045fd5"
            ]
        ]
    },
    {
        "id": "da2e7da80004f2df",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "Mode: sleep",
        "property": "mode",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "sleep",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "home",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 590,
        "y": 580,
        "wires": [
            [
                "be40615f64952ea5"
            ],
            [
                "be40615f64952ea5"
            ]
        ]
    },
    {
        "id": "be40615f64952ea5",
        "type": "time-range-switch",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "",
        "lat": "58.851468",
        "lon": "5.748852",
        "startTime": "21:00",
        "endTime": "05:00",
        "startOffset": 0,
        "endOffset": 0,
        "x": 590,
        "y": 620,
        "wires": [
            [],
            [
                "00cfb10ade246cfb"
            ]
        ]
    },
    {
        "id": "2b67f1929a03d2e8",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "Set AUTO MORNING",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "58 05 * * *",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 160,
        "y": 600,
        "wires": [
            [
                "e3586fc03b33a4af",
                "cd17276995992e32"
            ]
        ]
    },
    {
        "id": "e3586fc03b33a4af",
        "type": "subflow:05933d2d8abb4be7",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "",
        "x": 350,
        "y": 580,
        "wires": [
            [
                "da2e7da80004f2df"
            ],
            []
        ]
    },
    {
        "id": "ce73bb0b0b9d3fe1",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "g": "f71cc26218871cfd",
        "name": "link out 3",
        "mode": "link",
        "links": [
            "0d106dc05c444d7d"
        ],
        "x": 855,
        "y": 1120,
        "wires": []
    },
    {
        "id": "601ddd0174583052",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 1210,
        "y": 1180,
        "wires": [
            [
                "4cb1f9254274a35d"
            ]
        ]
    },
    {
        "id": "4cb1f9254274a35d",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "happyHome",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 1180,
        "wires": [
            [
                "195a3609997039ef"
            ]
        ]
    },
    {
        "id": "60cf4012aaea24e4",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "SummerTime",
        "rules": [
            {
                "t": "set",
                "p": "SummerTime",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 1240,
        "wires": [
            [
                "785f69e7629bfe8b"
            ]
        ]
    },
    {
        "id": "caab8e5848de50c4",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 1220,
        "y": 1240,
        "wires": [
            [
                "60cf4012aaea24e4"
            ]
        ]
    },
    {
        "id": "258215825cf08f1e",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "send Temp to Input",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "desiredTemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 1300,
        "wires": [
            [
                "aee0f1c4f42880d2"
            ]
        ]
    },
    {
        "id": "10442ba043aac34e",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "desiredTemp",
                "pt": "flow",
                "to": "$number(payload)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "storedDesiredTemp",
                "pt": "flow",
                "to": "desiredTemp",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1960,
        "y": 1300,
        "wires": [
            [
                "3094a65eb53406e6"
            ]
        ]
    },
    {
        "id": "0ec58e082421413e",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "d": true,
        "g": "f7fdebd4481aa8ea",
        "name": "Set Temperature",
        "links": [
            "32a0b9d95d5f01ed"
        ],
        "x": 1605,
        "y": 1380,
        "wires": [
            [
                "a63ed48c79d99436"
            ]
        ]
    },
    {
        "id": "c2b2bf251a83974e",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "tempoverride",
        "rules": [
            {
                "t": "set",
                "p": "tempoverride",
                "pt": "flow",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1770,
        "y": 1300,
        "wires": [
            [
                "10442ba043aac34e"
            ]
        ]
    },
    {
        "id": "a63ed48c79d99436",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "tempoverride",
        "property": "tempoverride",
        "propertyType": "flow",
        "rules": [
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1770,
        "y": 1340,
        "wires": [
            [
                "10442ba043aac34e"
            ]
        ]
    },
    {
        "id": "9676c78aafc21bfd",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "set tempoverride false",
        "links": [],
        "x": 1165,
        "y": 1380,
        "wires": [
            [
                "338a3e6fe35e806d"
            ]
        ]
    },
    {
        "id": "338a3e6fe35e806d",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "tempoverride",
        "rules": [
            {
                "t": "set",
                "p": "tempoverride",
                "pt": "flow",
                "to": "false",
                "tot": "bool"
            },
            {
                "t": "set",
                "p": "maxTemp",
                "pt": "flow",
                "to": "20",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 1380,
        "wires": [
            []
        ]
    },
    {
        "id": "457692128ee23e46",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "",
        "mode": "link",
        "links": [
            "14523e8cf10e8c99",
            "06ebc71a4ab3f5f7"
        ],
        "x": 2135,
        "y": 1340,
        "wires": []
    },
    {
        "id": "785f69e7629bfe8b",
        "type": "ui-switch",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "SummerTime",
        "label": "SummerTime",
        "group": "3f286b473c9966df",
        "order": 10,
        "width": "2",
        "height": "1",
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 1660,
        "y": 1240,
        "wires": [
            [
                "60cf4012aaea24e4"
            ]
        ]
    },
    {
        "id": "195a3609997039ef",
        "type": "ui-switch",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "HappyHome",
        "label": "HappyHome",
        "group": "3f286b473c9966df",
        "order": 9,
        "width": "2",
        "height": "1",
        "passthru": false,
        "topic": "topic",
        "topicType": "msg",
        "style": "",
        "className": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 1650,
        "y": 1180,
        "wires": [
            [
                "4cb1f9254274a35d"
            ]
        ]
    },
    {
        "id": "aee0f1c4f42880d2",
        "type": "ui-text-input",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "group": "f9c985920afe1003",
        "name": "",
        "label": "Temperature",
        "order": 7,
        "width": "2",
        "height": "1",
        "topic": "topic",
        "topicType": "msg",
        "mode": "number",
        "delay": "500",
        "passthru": false,
        "sendOnDelay": true,
        "sendOnBlur": true,
        "sendOnEnter": true,
        "className": "",
        "x": 1590,
        "y": 1300,
        "wires": [
            [
                "c2b2bf251a83974e"
            ]
        ]
    },
    {
        "id": "226c751b587383e1",
        "type": "ui-control",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "",
        "ui": "7f0c45a9432dc256",
        "events": "connect",
        "x": 1200,
        "y": 1300,
        "wires": [
            [
                "258215825cf08f1e"
            ]
        ]
    },
    {
        "id": "3094a65eb53406e6",
        "type": "delay",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "3",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "allowrate": false,
        "outputs": 1,
        "x": 2000,
        "y": 1340,
        "wires": [
            [
                "457692128ee23e46"
            ]
        ]
    },
    {
        "id": "75e44db55cd595f3",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "DogSitterMode TEMP",
        "links": [],
        "x": 1845,
        "y": 1220,
        "wires": [
            [
                "27eca8d90a2153db"
            ]
        ]
    },
    {
        "id": "27eca8d90a2153db",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "f7fdebd4481aa8ea",
        "name": "DogSitterMode TEMP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "22",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2000,
        "y": 1240,
        "wires": [
            [
                "10442ba043aac34e"
            ]
        ]
    },
    {
        "id": "14523e8cf10e8c99",
        "type": "link in",
        "z": "5f6e89b4b8794e08",
        "name": "Trigger Update",
        "links": [
            "457692128ee23e46",
            "7f8b8eb11fcf513c"
        ],
        "x": 1025,
        "y": 200,
        "wires": [
            [
                "ba8ce925d1c791d1"
            ]
        ]
    },
    {
        "id": "7c316b4844045fd5",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "Get storedDesiredTemp",
        "rules": [
            {
                "t": "set",
                "p": "storedDesiredTemp",
                "pt": "flow",
                "to": "desiredTemp",
                "tot": "flow"
            },
            {
                "t": "set",
                "p": "desiredTemp",
                "pt": "flow",
                "to": "20",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 830,
        "y": 680,
        "wires": [
            [
                "7f8b8eb11fcf513c"
            ]
        ]
    },
    {
        "id": "7f8b8eb11fcf513c",
        "type": "link out",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "link out 5",
        "mode": "link",
        "links": [
            "14523e8cf10e8c99"
        ],
        "x": 975,
        "y": 680,
        "wires": []
    },
    {
        "id": "3814bc8c4ee5f20d",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "name": "isWeekend",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "00 03 * * 6,0",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 130,
        "y": 400,
        "wires": [
            [
                "5fda933270a57a66"
            ]
        ]
    },
    {
        "id": "5fda933270a57a66",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "isWeekend",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "797e9caaa5f9cd6d",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "name": "!isWeekend",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "00 03 * * 1,2,3,4,5",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 150,
        "y": 440,
        "wires": [
            [
                "5fda933270a57a66"
            ]
        ]
    },
    {
        "id": "9822aadb4fefc223",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "name": "DebugMode",
        "property": "debugMode",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 2390,
        "y": 340,
        "wires": [
            [
                "2b89b624ac60ea94"
            ],
            [
                "c31638839d6b5383",
                "308d1ec82884e280"
            ]
        ]
    },
    {
        "id": "03e9874dbfd92d1f",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 2550,
        "y": 120,
        "wires": [
            [
                "c8eec66e8febd7ac"
            ]
        ]
    },
    {
        "id": "c8eec66e8febd7ac",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "debugMode",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2810,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "c242ea70b3b1c305",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "false",
        "payloadType": "bool",
        "x": 2550,
        "y": 160,
        "wires": [
            [
                "c8eec66e8febd7ac"
            ]
        ]
    },
    {
        "id": "7fc89e135a3adee4",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "name": "DebugMode",
        "property": "debugMode",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1950,
        "y": 580,
        "wires": [
            [
                "e534ad8de2d6cbde"
            ],
            [
                "25b66e388ba658c4"
            ]
        ]
    },
    {
        "id": "7d33a1463de50c5e",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "name": "DebugMode",
        "property": "debugMode",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1416,
        "y": 759,
        "wires": [
            [
                "eba3a34ba3d25266"
            ],
            [
                "7901c75255cd967d"
            ]
        ]
    },
    {
        "id": "eba3a34ba3d25266",
        "type": "debug",
        "z": "5f6e89b4b8794e08",
        "g": "73335ee4571578d7",
        "name": "Debug MILL",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1650,
        "y": 760,
        "wires": []
    },
    {
        "id": "e534ad8de2d6cbde",
        "type": "debug",
        "z": "5f6e89b4b8794e08",
        "name": "Debug MILL",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2230,
        "y": 600,
        "wires": []
    },
    {
        "id": "cd17276995992e32",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "g": "df69d6023cecf206",
        "name": "DebugMode",
        "property": "debugMode",
        "propertyType": "flow",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 370,
        "y": 640,
        "wires": [
            [
                "00cfb10ade246cfb"
            ],
            []
        ]
    },
    {
        "id": "308d1ec82884e280",
        "type": "debug",
        "z": "5f6e89b4b8794e08",
        "name": "debug 1",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 2510,
        "y": 440,
        "wires": []
    },
    {
        "id": "f311011df2225cdc",
        "type": "inject",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1280,
        "y": 460,
        "wires": [
            [
                "d7e26204bfd0191f"
            ]
        ]
    },
    {
        "id": "7daefb76d5cc8611",
        "type": "function",
        "z": "5f6e89b4b8794e08",
        "name": "PREDICTIVE BEDTIME COOLER ",
        "func": "// ═══════════════════════════════════════════════════════════════════════\n// PREDICTIVE BEDTIME COOLER - Learns cooling time and optimizes pre-cooling\n// Calculates when to start cooling to reach target temp at bedtime\n// ═══════════════════════════════════════════════════════════════════════\n\nconst CONFIG = {\n    BEDTIME_TARGET_TEMP: 19,           // Target temperature at bedtime\n    BEDTIME_HOUR: 22,                  // When bedtime mode starts (10 PM)\n    BEDTIME_MINUTE: 0,\n    MIN_COOL_MINUTES: 15,              // Don't bother if less than 15 min away\n    MAX_COOL_MINUTES: 120,             // Don't cool more than 2 hours early\n    COOLING_HISTORY_SIZE: 14,          // Track last 14 days of data\n    OUTSIDE_TEMP_BINS: 5,              // Group outside temps into 5°C bins\n    CONFIDENCE_THRESHOLD: 0.6,         // Need 60% data points to trust estimate\n    FAN_BOOST_THRESHOLD: 1.5           // Cool 1.5°C above target = boost fan\n};\n\n// Get inputs\nconst downstairsTemp = Number(flow.get('downstairsCurrentTemp')) || 20;\nconst outsideTemp = Number(flow.get('OutsideTemp')) || 15;\nconst desiredBedtimeTemp = Number(flow.get('bedtimeTargetTemp')) || CONFIG.BEDTIME_TARGET_TEMP;\n\n// Initialize history if doesn't exist\nlet coolingHistory = flow.get('coolingHistory') || [];\nlet lastCoolingRecord = flow.get('lastCoolingRecord') || {\n    timestamp: Date.now(),\n    temp: downstairsTemp,\n    outsideTemp: outsideTemp\n};\n\n// Get current time info\nconst now = new Date();\nconst currentHour = now.getHours();\nconst currentMinute = now.getMinutes();\nconst bedtimeStart = new Date();\nbedtimeStart.setHours(CONFIG.BEDTIME_HOUR, CONFIG.BEDTIME_MINUTE, 0);\n\n// Calculate minutes until bedtime\nconst timeToBedtime = (bedtimeStart.getTime() - now.getTime()) / 1000 / 60;\n\n// Helper: Round outside temp to nearest 5°C bin\nfunction getTempBin(temp) {\n    return Math.round(temp / CONFIG.OUTSIDE_TEMP_BINS) * CONFIG.OUTSIDE_TEMP_BINS;\n}\n\n// Helper: Calculate cooling rate (degrees per minute)\nfunction calculateCoolingRate(outsideTempBin) {\n    const relevantRecords = coolingHistory.filter(record => \n        getTempBin(record.outsideTemp) === outsideTempBin\n    );\n    \n    if (relevantRecords.length < 2) return null;\n    \n    let totalCoolingRate = 0;\n    let validRates = 0;\n    \n    for (let i = 0; i < relevantRecords.length - 1; i++) {\n        const current = relevantRecords[i];\n        const previous = relevantRecords[i + 1];\n        \n        const timeDiff = (current.timestamp - previous.timestamp) / 1000 / 60; // minutes\n        const tempDiff = previous.temp - current.temp; // cooling = positive\n        \n        if (timeDiff > 0 && timeDiff < 120) { // Valid 1-120 minute intervals\n            const rate = tempDiff / timeDiff;\n            if (rate > 0 && rate < 2) { // Sanity check: 0-2°C per minute\n                totalCoolingRate += rate;\n                validRates++;\n            }\n        }\n    }\n    \n    const confidence = Math.min(validRates / CONFIG.COOLING_HISTORY_SIZE, 1.0);\n    \n    if (validRates === 0) return null;\n    \n    return {\n        rate: totalCoolingRate / validRates,  // °C per minute\n        confidence: confidence\n    };\n}\n\n// Helper: Estimate time needed to cool to target\nfunction estimateCoolingTime(currentTemp, targetTemp, outsideTempBin) {\n    if (currentTemp <= targetTemp) return 0;\n    \n    const coolingData = calculateCoolingRate(outsideTempBin);\n    if (!coolingData || coolingData.confidence < CONFIG.CONFIDENCE_THRESHOLD) {\n        // Use fallback estimate: ~0.3°C per minute for moderate conditions\n        const fallbackRate = 0.3;\n        return Math.ceil((currentTemp - targetTemp) / fallbackRate);\n    }\n    \n    const estimatedMinutes = (currentTemp - targetTemp) / coolingData.rate;\n    return Math.ceil(estimatedMinutes);\n}\n\n// Add new cooling data point\nfunction recordCoolingData() {\n    const timeSinceLastRecord = (now.getTime() - lastCoolingRecord.timestamp) / 1000 / 60;\n    \n    // Only record if significant time has passed (>2 minutes)\n    if (timeSinceLastRecord > 2) {\n        coolingHistory.unshift({\n            timestamp: now.getTime(),\n            temp: downstairsTemp,\n            outsideTemp: outsideTemp,\n            tempDrop: lastCoolingRecord.temp - downstairsTemp,\n            timeDiff: Math.round(timeSinceLastRecord)\n        });\n        \n        // Keep only recent history\n        if (coolingHistory.length > CONFIG.COOLING_HISTORY_SIZE * 24) { // ~2 weeks\n            coolingHistory = coolingHistory.slice(0, CONFIG.COOLING_HISTORY_SIZE * 24);\n        }\n        \n        flow.set('coolingHistory', coolingHistory);\n    }\n    \n    lastCoolingRecord = {\n        timestamp: now.getTime(),\n        temp: downstairsTemp,\n        outsideTemp: outsideTemp\n    };\n    flow.set('lastCoolingRecord', lastCoolingRecord);\n}\n\n// Main logic\nrecordCoolingData();\n\nlet shouldStartCooling = false;\nlet correctedTemp = downstairsTemp;\nlet fanSpeed = 'low';\nlet reason = '';\nlet estimateData = null;\n\n// Check if bedtime mode should activate\nif (timeToBedtime > 0 && timeToBedtime <= CONFIG.MAX_COOL_MINUTES) {\n    // Calculate required cooling\n    const tempDiff = downstairsTemp - desiredBedtimeTemp;\n    \n    if (tempDiff > 0.5) {\n        // Need to cool down\n        const outsideBin = getTempBin(outsideTemp);\n        const estimatedCoolingTime = estimateCoolingTime(downstairsTemp, desiredBedtimeTemp, outsideBin);\n        const coolingData = calculateCoolingRate(outsideBin);\n        \n        estimateData = {\n            currentTemp: downstairsTemp.toFixed(1),\n            targetTemp: desiredBedtimeTemp,\n            tempDiffNeeded: tempDiff.toFixed(2),\n            estimatedCoolingTime: estimatedCoolingTime,\n            minsToBedtime: Math.round(timeToBedtime),\n            coolingData: coolingData,\n            outsideTempBin: outsideBin,\n            historyDataPoints: coolingHistory.length\n        };\n        \n        // Decide if we should start cooling NOW\n        if (estimatedCoolingTime > 0 && estimatedCoolingTime <= timeToBedtime) {\n            shouldStartCooling = true;\n            \n            // Calculate aggressive settings to reach target in time\n            // Add safety margin (start cooling 5 min before estimated time)\n            const timeBuffer = 5;\n            const timeAvailable = timeToBedtime - timeBuffer;\n            \n            if (coolingData && coolingData.confidence >= CONFIG.CONFIDENCE_THRESHOLD) {\n                // We have good data - calculate precise target temp\n                const coolingCapacity = coolingData.rate * timeAvailable;\n                correctedTemp = Math.max(desiredBedtimeTemp, downstairsTemp - coolingCapacity);\n                \n                reason = `Predictive: cooling from ${downstairsTemp.toFixed(1)}°C to ${correctedTemp.toFixed(1)}°C ` +\n                    `(${(coolingData.confidence * 100).toFixed(0)}% confident, ${estimatedCoolingTime}min needed)`;\n            } else {\n                // Use fallback: aim for target + buffer\n                correctedTemp = desiredBedtimeTemp + 0.5;\n                reason = `Predictive: insufficient data - conservative cooling to ${correctedTemp.toFixed(1)}°C`;\n            }\n            \n            // Set fan speed based on urgency\n            if (tempDiff > CONFIG.FAN_BOOST_THRESHOLD) {\n                fanSpeed = 'medium_high';\n                reason += ' [high urgency - fan boost]';\n            } else if (tempDiff > 1.0) {\n                fanSpeed = 'medium';\n            } else {\n                fanSpeed = 'low';\n            }\n            \n        } else if (estimatedCoolingTime > timeToBedtime) {\n            // Not enough time to reach target - go as aggressive as possible\n            shouldStartCooling = true;\n            correctedTemp = desiredBedtimeTemp;\n            fanSpeed = 'high';\n            reason = `Urgent: not enough time (${estimatedCoolingTime}min needed, ${Math.round(timeToBedtime)}min available) - max cooling`;\n        } else {\n            shouldStartCooling = false;\n            reason = `Too late to start cooling (${estimatedCoolingTime}min still needed)`;\n        }\n    } else {\n        shouldStartCooling = false;\n        reason = `Already at target (${downstairsTemp.toFixed(1)}°C ≤ ${desiredBedtimeTemp}°C)`;\n    }\n} else if (timeToBedtime <= 0) {\n    // Bedtime has started or passed - maintain target\n    if (downstairsTemp > desiredBedtimeTemp + 0.3) {\n        shouldStartCooling = true;\n        correctedTemp = desiredBedtimeTemp;\n        fanSpeed = 'low';\n        reason = `Bedtime active: maintaining ${desiredBedtimeTemp}°C`;\n    } else {\n        shouldStartCooling = false;\n        reason = `Bedtime active: comfortable`;\n    }\n} else {\n    shouldStartCooling = false;\n    reason = `Not yet time to cool (${Math.round(timeToBedtime)}min until bedtime)`;\n}\n\n// Store state for next cycle\nflow.set('bedtimePredictiveState', {\n    shouldCool: shouldStartCooling,\n    correctedTemp: correctedTemp,\n    fanSpeed: fanSpeed,\n    lastUpdate: now.toISOString()\n});\n\n// Output\nreturn {\n    payload: {\n        shouldStartCooling: shouldStartCooling,\n        correctedTemp: Math.round(correctedTemp * 10) / 10,  // Round to 0.1°C\n        fanSpeed: fanSpeed,\n        targetTemp: desiredBedtimeTemp,\n        currentTemp: downstairsTemp.toFixed(1),\n        outsideTemp: outsideTemp.toFixed(1),\n        timeToBedtime: Math.round(timeToBedtime),\n        reason: reason,\n        diagnostics: {\n            coolingHistoryPoints: coolingHistory.length,\n            estimateData: estimateData,\n            timestamp: now.toISOString()\n        }\n    }\n};\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 640,
        "y": 340,
        "wires": [
            [
                "e913dbd1e212267a"
            ]
        ]
    },
    {
        "id": "22ac35501eb0a501",
        "type": "subflow:05933d2d8abb4be7",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "x": 570,
        "y": 280,
        "wires": [
            [
                "7daefb76d5cc8611"
            ],
            []
        ]
    },
    {
        "id": "e913dbd1e212267a",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "name": "shouldStartCooling",
        "property": "payload.shouldStartCooling",
        "propertyType": "msg",
        "rules": [
            {
                "t": "false"
            },
            {
                "t": "true"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 790,
        "y": 440,
        "wires": [
            [
                "653ee69479574493"
            ],
            [
                "c5cd5bee95af09ac"
            ]
        ]
    },
    {
        "id": "c5cd5bee95af09ac",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "Heatpump Data",
        "rules": [
            {
                "t": "set",
                "p": "correctedTemp",
                "pt": "flow",
                "to": "payload.correctedTemp",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "mode",
                "pt": "flow",
                "to": "cool",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "swing",
                "pt": "msg",
                "to": "fixedBottom",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "fanlevel",
                "pt": "flow",
                "to": "payload.fanSpeed",
                "tot": "msg"
            },
            {
                "t": "delete",
                "p": "topic",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_msgid",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "_event",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "on",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1020,
        "y": 520,
        "wires": [
            [
                "384a380adf0a8201"
            ]
        ]
    },
    {
        "id": "8d44a78565146474",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "fanlevel",
                "pt": "flow",
                "to": "low",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 560,
        "wires": [
            [
                "021c1b9412191388"
            ]
        ]
    },
    {
        "id": "021c1b9412191388",
        "type": "rbe",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": false,
        "property": "payload.fanSpeed",
        "topi": "topic",
        "x": 1540,
        "y": 560,
        "wires": [
            [
                "d7e26204bfd0191f"
            ]
        ]
    },
    {
        "id": "eafd3eb92b7d559c",
        "type": "change",
        "z": "5f6e89b4b8794e08",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "reset",
                "pt": "msg",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1500,
        "y": 480,
        "wires": [
            [
                "021c1b9412191388"
            ]
        ]
    },
    {
        "id": "384a380adf0a8201",
        "type": "switch",
        "z": "5f6e89b4b8794e08",
        "name": "isStandBy",
        "property": "isStandBy",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1190,
        "y": 520,
        "wires": [
            [
                "021c1b9412191388"
            ],
            [
                "8d44a78565146474"
            ]
        ]
    }
]