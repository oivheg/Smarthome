[{"id":"1c11632f.f206fd","type":"tab","label":"Smarthus","disabled":false,"info":""},{"id":"85114e25.ae2ad","type":"tab","label":"1 ETG: Bevegelse","disabled":false,"info":""},{"id":"8b99f8fe.7b27b8","type":"tab","label":"Smarthome_MODE","disabled":false,"info":""},{"id":"9318493b.8ed8b8","type":"tab","label":"KJELLER: Bevegelse","disabled":false,"info":""},{"id":"1b14ec1b.20ab54","type":"tab","label":"Happy","disabled":false,"info":""},{"id":"bc3b2c68.b35f6","type":"tab","label":"Garbage Collector","disabled":false,"info":""},{"id":"605ae98f.8a9998","type":"tab","label":"Bedroom","disabled":false,"info":""},{"id":"f487aa99.386108","type":"tab","label":"Data","disabled":false,"info":""},{"id":"e3737c94.fd59f","type":"tab","label":"FH Connections","disabled":false,"info":""},{"id":"26b1c83f.906118","type":"tab","label":"Deconz Connections","disabled":false,"info":""},{"id":"5a99bc39.0df864","type":"subflow","name":"Movement","info":"","category":"","in":[{"x":200,"y":220,"wires":[{"id":"92cb7ac8.418b68"}]}],"out":[{"x":1220,"y":260,"wires":[{"id":"8aada546.742878","port":0},{"id":"1329ab14.42ed25","port":0}]}],"env":[{"name":"Floor","type":"str","value":"upstairs"}],"color":"#DDAA99","status":{"x":840,"y":100,"wires":[{"id":"67f4df0c.005ff","port":0}]}},{"id":"f6aee802.f74bc8","type":"mqtt-broker","z":"","name":"Homeseer","broker":"192.168.1.103","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"homeseer","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"dccbff74.2769","type":"node-hue-bridge","z":"","name":"Hue Bridge","address":"192.168.1.53","key":"VBGb8l3baRWQyLpSQK2-GAB6H0UsRj37n3e51l3O","interval":"10000"},{"id":"c40d1711.7fd448","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"8d9ae12b.2a6f5","type":"ui_tab","z":"","name":"Home","icon":"dashboard","disabled":false,"hidden":false},{"id":"8a264f87.d9145","type":"ui_group","z":"","name":"Floorplan","tab":"8d9ae12b.2a6f5","order":1,"disp":true,"width":"18","collapse":false},{"id":"530528aa.2006c8","type":"pushbullet-config","z":"","name":"Øivind"},{"id":"d1934670.897a88","type":"googlehome-config-node","z":"","ipaddress":"192.168.1.89","name":"Kjeller: Norsk","language":"no"},{"id":"a967d384.f5115","type":"googlehome-config-node","z":"","ipaddress":"192.168.1.89","name":"Kjeller: RU","language":"ru"},{"id":"35cb409b.4a073","type":"googlehome-config-node","z":"","ipaddress":"192.168.1.89","name":"Kjeller: ENG","language":"en"},{"id":"5ee6b185.35f2d","type":"googlehome-config-node","z":"","ipaddress":"192.168.1.44","name":"Stue: RU","language":"ru"},{"id":"354eb0bd.91999","type":"googlehome-config-node","z":"","ipaddress":"192.168.1.44","name":"Stue: ENG","language":"en"},{"id":"429b8253.24d1dc","type":"googlehome-config-node","z":"","ipaddress":"192.168.1.44","name":"Stue: NO","language":"no"},{"id":"ca3eef.3da5b11","type":"ui_group","z":"","name":"Kjeller","tab":"8d9ae12b.2a6f5","order":2,"disp":true,"width":"6","collapse":false},{"id":"56a8be2a.9b9eb","type":"ui_group","z":"","name":"House","tab":"8d9ae12b.2a6f5","order":3,"disp":true,"width":"6","collapse":false},{"id":"efd0ae.1a06bf5","type":"ui_group","z":"","name":"1 Etg","tab":"8d9ae12b.2a6f5","order":4,"disp":true,"width":"6","collapse":false},{"id":"12895ae7.9c6bf5","type":"deconz-server","z":"","name":"Zigbee","ip":"192.168.1.103","port":"80","apikey":"864A633FD5","ws_port":"8088","secure":false,"polling":"15"},{"id":"3fb4f73e.f3cd38","type":"futurehome-login","z":"","displayName":"Øivind","site_name":"Hegglunds","base_uri":"futurehome.no/","username":"oivheg@gmail.com"},{"id":"83ed609b.13959","type":"homekit-bridge","z":"","bridgeName":"Hegglunds","pinCode":"111-11-111","port":"","allowInsecureRequest":false,"manufacturer":"Default Manufacturer","model":"Default Model","serialNo":"Default Serial Number","customMdnsConfig":false,"mdnsMulticast":true,"mdnsInterface":"","mdnsPort":"","mdnsIp":"","mdnsTtl":"","mdnsLoopback":true,"mdnsReuseAddr":true,"allowMessagePassthrough":true},{"id":"1f05e387.5d527c","type":"ui_tab","z":"","name":"List","icon":"dashboard"},{"id":"54f6a8ea.957eb8","type":"nora-config","z":"","name":"hegglunds","group":"","notify":false},{"id":"99977a8c.c02588","type":"influxdb","z":"","hostname":"127.0.0.1","port":"8086","protocol":"http","database":"movement","name":"","usetls":false,"tls":""},{"id":"583fffe9.e7d8f","type":"ui_group","z":"","name":"Bevegelse","tab":"1f05e387.5d527c","order":1,"disp":true,"width":24,"collapse":false},{"id":"6708f2f6.06829c","type":"miio-roborock-server","z":"","name":"Mr Robot","ip":"192.168.1.90","token":"4e765244557a37537139316f77595245","polling":"30"},{"id":"a1a5c8b5.9b4ac8","type":"ui_tab","z":"","name":"SVG","icon":"dashboard","disabled":false,"hidden":false},{"id":"4948e514.cca17c","type":"ui_group","z":"","name":"SVG","tab":"a1a5c8b5.9b4ac8","order":1,"disp":true,"width":"6","collapse":false},{"id":"d448afc7.37911","type":"ui_group","z":"","name":"Floorplan test","tab":"cb71358d.66cf98","order":1,"disp":true,"width":"30","collapse":false},{"id":"cb71358d.66cf98","type":"ui_tab","z":"","name":"SVG","icon":"dashboard","disabled":false,"hidden":false},{"id":"ec345eaf.fe438","type":"ui_group","z":"","name":"Floorplan test","tab":"51142797.a12518","order":1,"disp":true,"width":"14","collapse":false},{"id":"51142797.a12518","type":"ui_tab","z":"","name":"SVG","icon":"dashboard","disabled":false,"hidden":false},{"id":"df244380.041ae","type":"ui_group","z":"","name":"Floorplan test","tab":"c0c8666e.f5b2d8","order":1,"disp":true,"width":"14","collapse":false},{"id":"c0c8666e.f5b2d8","type":"ui_tab","z":"","name":"SVG","icon":"dashboard","disabled":false,"hidden":false},{"id":"d2f48d8d.a9582","type":"light-scheduler-settings","z":"","name":"Gravarsveien 57","latitude":"58.851299","longitude":"5.748830"},{"id":"c93d9ccb.30d74","type":"function","z":"1c11632f.f206fd","name":"On\\Off","func":"msg.payload;\n//msg.payload.on =  msg.payload.power === \"on\" ? true : false \nreturn msg;","outputs":1,"noerr":0,"x":1430,"y":1200,"wires":[["2552d668.c01cea","8f119d5d.e9645","bb47679e.49ecb8"]]},{"id":"b60e383f.f82dc8","type":"function","z":"1c11632f.f206fd","name":"Set Karinas Office","func":"let msg2 = {id: \"karina\",name:\"Karinas office\", power : msg.payload.on === true ? \"on\" : \"off\"}\nreturn msg2;","outputs":1,"noerr":0,"x":450,"y":1040,"wires":[["66d9f1c.785941"]]},{"id":"2552d668.c01cea","type":"switch","z":"1c11632f.f206fd","name":"Hue Lights","property":"payload.name","propertyType":"msg","rules":[{"t":"eq","v":"Karinas office","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":1670,"y":1160,"wires":[["d937e7f8.315d88"]]},{"id":"10016b07.ab9885","type":"comment","z":"8b99f8fe.7b27b8","name":"Presence","info":"","x":120,"y":100,"wires":[]},{"id":"7c348293.52162c","type":"inject","z":"8b99f8fe.7b27b8","name":"Every 30 seconds","topic":"","payload":"","payloadType":"date","repeat":"30","crontab":"","once":false,"onceDelay":"","x":210,"y":180,"wires":[["f44e1823.867bc8"]]},{"id":"6cef8202.47cb9c","type":"function","z":"8b99f8fe.7b27b8","name":"Determine device presence","func":"const lastSeenSeconds = 70;\nlet presenceCutoff = (new Date() - (lastSeenSeconds * 1000)) / 1000; \nconst people = {\n    \"presence/heggland\": \"heggland\",\n    \"presence/karina\": \"karina\",\n    \"presence/person3\": \"stian\"\n};\n\nreturn Object.keys(people).map(function(topic) {\n    let devices = msg.payload[0].filter(device => device.name === people[topic] && device.last_seen > presenceCutoff);\n    return {\n        topic: topic,\n        retain: true,\n        payload: devices.length > 0\n    };\n});","outputs":3,"noerr":0,"x":680,"y":240,"wires":[["d5a9cb0d.738118","394f6d15.3c43e2","772b0560.6b8bcc"],["d5a9cb0d.738118","394f6d15.3c43e2","47763aff.5ff334"],["394f6d15.3c43e2"]],"outputLabels":["oivheg ","Karina ","Stian"]},{"id":"f0615fd.9f26ba","type":"function","z":"8b99f8fe.7b27b8","name":"Home","func":"msg.payload = {\"mode\":\"home\"};\nglobal.set(\"Mode\", \"home\")\nreturn msg;","outputs":1,"noerr":0,"x":1650,"y":240,"wires":[["247260f.c82dca","5e0f66ea.3848a8"]]},{"id":"e4c32eed.12537","type":"function","z":"8b99f8fe.7b27b8","name":"Away","func":"msg.payload = {\"mode\":\"away\"};\nglobal.set(\"Mode\", \"away\")\nreturn msg;","outputs":1,"noerr":0,"x":1650,"y":280,"wires":[["fc4fe81e.444628","77d1d4b3.4641ec"]]},{"id":"9c18ec5f.f9594","type":"inject","z":"bc3b2c68.b35f6","name":"INFORM","topic":"","payload":"","payloadType":"date","repeat":"3600","crontab":"","once":true,"onceDelay":0.1,"x":100,"y":40,"wires":[["47a496d1.bcac18","6a421ae3.f71ae4"]]},{"id":"ae47dd19.04f86","type":"inject","z":"bc3b2c68.b35f6","name":"GO","topic":"","payload":"GO","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"","x":70,"y":340,"wires":[["47a496d1.bcac18"]]},{"id":"38b19a16.a4b306","type":"inject","z":"bc3b2c68.b35f6","name":"","topic":"","payload":"STOP","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"","x":70,"y":380,"wires":[["47a496d1.bcac18"]]},{"id":"3b05335c.ab790c","type":"function","z":"bc3b2c68.b35f6","name":"Text: English","func":"msg.payload = \"Please Remember to Take out the TRASH\";\nmsg.emitVolume = 50;\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":260,"wires":[["7db434df.a3db2c"]]},{"id":"9430e52f.746a78","type":"function","z":"bc3b2c68.b35f6","name":"Text: English","func":"msg.payload = \"Please Remember to Take out the TRASH\";\nmsg.topic = \"Remember Garbage\";\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":220,"wires":[["c0005e0c.a1014"]]},{"id":"37115d31.12a892","type":"switch","z":"bc3b2c68.b35f6","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":290,"y":20,"wires":[["584db3f7.80672c"],["757cb634.cb61d8"]]},{"id":"584db3f7.80672c","type":"change","z":"bc3b2c68.b35f6","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"GO","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":20,"wires":[["47a496d1.bcac18"]]},{"id":"757cb634.cb61d8","type":"change","z":"bc3b2c68.b35f6","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"STOP","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":440,"y":60,"wires":[["47a496d1.bcac18"]]},{"id":"d97a92f4.627f3","type":"link out","z":"9318493b.8ed8b8","name":"","links":["1329b56.bea634b"],"x":1635,"y":120,"wires":[]},{"id":"1329b56.bea634b","type":"link in","z":"8b99f8fe.7b27b8","name":"","links":["d97a92f4.627f3","7297b009.f403c"],"x":175,"y":460,"wires":[["61ee7057.5df1f"]]},{"id":"55a1471c.7ca3e8","type":"trigger","z":"8b99f8fe.7b27b8","op1":"","op2":"true","op1type":"nul","op2type":"bool","duration":"30","extend":true,"units":"min","reset":"","bytopic":"all","name":"","x":610,"y":520,"wires":[["a085a6f7.ae8698","d1068875.e54d18"]]},{"id":"c0a1cf4a.15698","type":"comment","z":"85114e25.ae2ad","name":"Stue","info":"","x":590,"y":40,"wires":[]},{"id":"cab5d077.abb8d","type":"comment","z":"85114e25.ae2ad","name":"Gangen","info":"","x":250,"y":320,"wires":[]},{"id":"2183112b.d9b2ee","type":"json","z":"9318493b.8ed8b8","name":"","property":"payload","action":"","pretty":false,"x":310,"y":200,"wires":[["bde23867.90b558"]]},{"id":"bde23867.90b558","type":"switch","z":"9318493b.8ed8b8","name":"","property":"guestmode","propertyType":"global","rules":[{"t":"false"}],"checkall":"true","repair":true,"outputs":1,"x":430,"y":200,"wires":[["14d4c15d.0b6a7f"]]},{"id":"7433eb5f.c4b754","type":"device","z":"9318493b.8ed8b8","user":"3fb4f73e.f3cd38","device":"19","device_id":"19","name":"Kjeller: Eye","x":150,"y":200,"wires":[["2183112b.d9b2ee"]]},{"id":"28f59771.b88068","type":"ui_button","z":"bc3b2c68.b35f6","name":"STOP","group":"56a8be2a.9b9eb","order":5,"width":0,"height":0,"passthru":false,"label":"Søppel","tooltip":"Trykk når søppel tatt ut","color":"","bgcolor":"","icon":"","payload":"STOP","payloadType":"str","topic":"FALSE","x":70,"y":300,"wires":[["47a496d1.bcac18"]]},{"id":"e24d6f6a.515a6","type":"ui_toast","z":"bc3b2c68.b35f6","position":"top right","displayTime":"10","highlight":"","outputs":0,"ok":"OK","cancel":"","topic":"Husk SÃ¸ppel","name":"Husk SÃ¸ppel","x":490,"y":180,"wires":[]},{"id":"343547fd.e77fb8","type":"ui_template","z":"1c11632f.f206fd","group":"8a264f87.d9145","name":"1 ETG","order":1,"width":9,"height":11,"format":"<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js\"></script>\n</head>\n<body style=\"margin: 0px;\">\n\n<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"450\" height=\"800\"  xml:space=\"preserve\" id=\"i02XXX\">\n    <!-- Generated by PaintCode - http://www.paintcodeapp.com -->\n    <defs>\n        <pattern id=\"i1floorPlan\" patternUnits=\"userSpaceOnUse\" width=\"450\" height=\"600\" align=\"middle\">\n            <image xlink:href=\"http://toyotacarina.net/SmartHome/1stFloor.jpg\" x=\"0\" y=\"0\" width=\"450\" height=\"600\" align=\"middle\"></image>\n        </pattern>\n    </defs>\n    <rect id=\"i02XXX-floorPlan\" stroke=\"none\" fill=\"url(#i1floorPlan)\" x=\"0\" y=\"0\" width=\"450\" height=\"600\" align=\"middle\"></rect>\n    <g id=\"i02XXX-allSensors\">\n        <g id=\"i02XXX-motionSensors\" opacity=\"0.5\">\n            \n            <g id=\"Livingroom\" transform=\"translate(430,408) rotate(90)\">\n                <svg class=\"svg-rect\" width=\"149\" height=\"67\">\n                    <rect id=\"Stue\" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Lys i stue</text>\n                </svg>\n            </g>\n               <g id=\"KarinasOffice\" transform=\"translate(430,40) rotate(90)\">\n                <svg class=\"svg-rect\" width=\"149\" height=\"67\">\n                    <rect id=\"Karinas office\" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Karinas office</text>\n                </svg>\n            </g>\n            <g id=\"Kitchen\" transform=\"translate(0,510)\">\n                <svg class=\"svg-rect\" width=\"221\" height=\"75\">\n                    <rect id=\"Kjøkken\" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Kjøkken lys</text>\n                </svg>  \n            </g>\n             <g id=\"Gusetroom\" transform=\"translate(0,170)\">\n                <svg class=\"svg-rect\" width=\"150\" height=\"75\">\n                    <rect id=\"Kontor: Lys\" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Guestroom lys</text>\n                </svg>                \n            </g>\n             <g id=\"Gang\" transform=\"translate(170,50)\">\n                <svg class=\"svg-rect\" width=\"150\" height=\"75\">\n                    <rect id=\"Gangen\" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Gang</text>\n                </svg>                \n            </g>\n        </g>\n    </g>\n</svg>\n\n<script>\nvar light = \"on\";\nvar name = \"lys\";\nvar retur = \"mothing\";\nfunction myFunction(clicked_id) {\n    \n    //  document.getElementById(clicked_id).style.fill=\"yellow\";\n   var fill = document.getElementById(clicked_id).style.fill;\n    if (fill ==  \"yellow\")  {\n    document.getElementById(clicked_id).style.fill=\"white\";\n    light = \"off\";\n    name = clicked_id;\n  } else {\n    document.getElementById(clicked_id).style.fill=\"yellow\";\n    light = \"on\";\n     name = clicked_id;\n    \n  }\n \n}\n\nthis.scope.action = function() { return {\"power\" :light, \"name\": name }; }\n\n</script>\n<script>\n  (function(scope){ \n\tscope.$watch('msg', function(msg) {\n\t\tif (msg){\n\t\t    console.log(msg.payload.jquerySelector);\n\t\t    console.log(document.getElementById(String(msg.payload.jquerySelector)));\n\t\t\tif (msg.payload.status ==  \"off\")  {\n\t\t\t\tdocument.getElementById(String(msg.payload.jquerySelector)).style.fill=\"white\";\n\t\t\t} else {\n\t\t\t\tdocument.getElementById(String(msg.payload.jquerySelector)).style.fill=\"yellow\";\n\t\t\t}                     \n\t\t}\n\t});\n})(scope);\n</script>\n</body>\n</html>\n","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","x":1290,"y":1160,"wires":[["c93d9ccb.30d74"]]},{"id":"db00bb8.82e0148","type":"ui_template","z":"1c11632f.f206fd","group":"8a264f87.d9145","name":"Basement","order":2,"width":9,"height":11,"format":"<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js\"></script>\n</head>\n<body style=\"margin: 0px;\">\n\n<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"450\" height=\"800\"  xml:space=\"preserve\" id=\"i01XXX\">\n    <!-- Generated by PaintCode - http://www.paintcodeapp.com -->\n    <defs>\n        <pattern id=\"basementPattern\" patternUnits=\"userSpaceOnUse\" width=\"450\" height=\"600\" align=\"middle\">\n            <image xlink:href=\"http://toyotacarina.net/SmartHome/Basement.jpg\" x=\"0\" y=\"0\" width=\"450\" height=\"600\" align=\"middle\"></image>\n        </pattern>\n    </defs>\n    <rect id=\"i01XXX-floorPlan\" stroke=\"none\" fill=\"url(#basementPattern)\" x=\"0\" y=\"0\" width=\"450\" height=\"600\" align=\"middle\"></rect>\n      <g id=\"i01XXX-allSensors\">\n        <g id=\"i01XXX-motionSensors\" opacity=\"0.5\">\n     <g id=\"Basement\" transform=\"translate(430,390) rotate(90)\">\n                <svg class=\"svg-rect\" width=\"200\" height=\"60\">\n                    <rect id=\"Kjeller Gang\" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Kjeller Lys</text>\n                </svg>                \n            </g>\n\t <g id=\"Vaskerom1\" transform=\"translate(170,20)\">\n                <svg class=\"svg-rect\" width=\"120\" height=\"100\">\n                    <rect id=\"Vaskerom: Lys\" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Vaskerom</text>\n                </svg>                \n            </g>\n\t<g id=\"Closet1\" transform=\"translate(310,20)\">\n                <svg class=\"svg-rect\" width=\"110\" height=\"170\">\n                    <rect id=\"Closet\" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Garderobe</text>\n                </svg>                \n            </g>\n    <g id=\"Soverommet\" transform=\"translate(20,400)\">\n                <svg class=\"svg-rect\" width=\"110\" height=\"130\">\n                    <rect id=\"Karina \" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Soverom</text>\n                </svg>                \n            </g>\n    <g id=\"Gardin\" transform=\"translate(60,550)\">\n                <svg class=\"svg-rect\" width=\"110\" height=\"40\">\n                    <rect id=\"Sov_Gardin\" onclick=\"myFunction(this.id)\" ng-click=\"send({payload: action()})\" width=\"100%\" height=\"100%\" stroke=\"none\" fill=\"white\" rx=\"13\" ></rect>\n                    <text x=\"50%\" y=\"50%\" text-anchor=\"middle\" stroke=\"black\" font-family=\"HelveticaNeue-Bold, 'Helvetica Neue', Helvetica, Arial, sans-serif\" font-weight=\"bold\" font-size=\"20\">Gardin</text>\n                </svg>                \n            </g>\n        </g>   \n    </g>  \n</svg>\n<script>\nvar light = \"on\";\nvar name = \"lys\";\nvar retur = \"mothing\";\nfunction myFunction(clicked_id) {\n    \n    //  document.getElementById(clicked_id).style.fill=\"yellow\";\n   var fill = document.getElementById(clicked_id).style.fill;\n    if (fill ==  \"yellow\")  {\n    document.getElementById(clicked_id).style.fill=\"white\";\n    light = \"off\";\n    name = clicked_id;\n  } else {\n    document.getElementById(clicked_id).style.fill=\"yellow\";\n    light = \"on\";\n     name = clicked_id;\n    \n  }\n \n}\n\nthis.scope.action = function() { return {\"power\" :light, \"name\": name }; }\n\n</script>\n<script>\n  (function(scope){ \n\tscope.$watch('msg', function(msg) {\n\t\tif (msg){\n\t\t    console.log(msg.payload.jquerySelector);\n\t\t    console.log(document.getElementById(String(msg.payload.jquerySelector)));\n\t\t\tif (msg.payload.status ==  \"off\")  {\n\t\t\t\tdocument.getElementById(String(msg.payload.jquerySelector)).style.fill=\"white\";\n\t\t\t} else {\n\t\t\t\tdocument.getElementById(String(msg.payload.jquerySelector)).style.fill=\"yellow\";\n\t\t\t}                     \n\t\t}\n\t});\n})(scope);\n</script>\n</body>\n</html>\n","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","x":1280,"y":1240,"wires":[["c93d9ccb.30d74"]]},{"id":"c2c55e51.42bd2","type":"node-hue-out","z":"1c11632f.f206fd","server":"dccbff74.2769","lightID":"light8","name":"Karinas Office","x":250,"y":1040,"wires":[["b60e383f.f82dc8"]]},{"id":"d937e7f8.315d88","type":"node-hue-in","z":"1c11632f.f206fd","server":"dccbff74.2769","lightID":"light8","name":"Karinas Office","x":1880,"y":1160,"wires":[]},{"id":"6a421ae3.f71ae4","type":"bigtimer","z":"bc3b2c68.b35f6","outtopic":"","outpayload1":"","outpayload2":"","name":"Big Timer","comment":"","lat":"58.851299","lon":"5.748830","starttime":"1035","endtime":"1320","starttime2":0,"endtime2":0,"startoff":0,"endoff":0,"startoff2":0,"endoff2":0,"offs":0,"outtext1":"GO","outtext2":"STOP","timeout":1440,"sun":false,"mon":false,"tue":true,"wed":false,"thu":false,"fri":false,"sat":false,"jan":true,"feb":false,"mar":false,"apr":false,"may":true,"jun":false,"jul":false,"aug":false,"sep":true,"oct":false,"nov":false,"dec":false,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":"","month7":"","day8":"","month8":"","day9":"","month9":"","day10":"","month10":"","day11":"","month11":"","day12":"","month12":"","d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"repeat":false,"atstart":true,"odd":false,"even":false,"x":100,"y":120,"wires":[["47a496d1.bcac18"],["47a496d1.bcac18","37115d31.12a892"],[]]},{"id":"394f6d15.3c43e2","type":"and-gate","z":"8b99f8fe.7b27b8","name":"Er Borte","rules":[{"t":"false","propertyType":"msg","property":"payload","topic":"presence/heggland"},{"t":"false","propertyType":"msg","property":"payload","topic":"presence/person3"},{"t":"false","propertyType":"msg","property":"payload","topic":"presence/karina"}],"outputTopic":"Gone","gateType":"and","emitOnlyIfTrue":true,"x":1000,"y":280,"wires":[["fc71e441.058a48"]]},{"id":"d5a9cb0d.738118","type":"or-gate","z":"8b99f8fe.7b27b8","name":"Er Hjemme","rules":[{"t":"true","propertyType":"msg","property":"payload","topic":"presence/heggland"},{"t":"true","propertyType":"msg","property":"payload","topic":"presence/karina"},{"t":"true","propertyType":"msg","property":"payload","topic":"presence/person3"}],"outputTopic":"Home","gateType":"or","emitOnlyIfTrue":true,"x":1010,"y":240,"wires":[["16e01a0.bfa88e6"]]},{"id":"47a496d1.bcac18","type":"traffic","z":"bc3b2c68.b35f6","name":"Traffic sample","property_allow":"payload","filter_allow":"GO","ignore_case_allow":false,"negate_allow":false,"send_allow":false,"property_stop":"payload","filter_stop":"stop","ignore_case_stop":true,"negate_stop":false,"send_stop":false,"default_start":false,"differ":false,"x":280,"y":220,"wires":[["e24d6f6a.515a6","9430e52f.746a78","3b05335c.ab790c"]]},{"id":"e2460a6c.579118","type":"Unifi","z":"8b99f8fe.7b27b8","name":"Heggland","ip":"178.128.169.181","port":8443,"site":"7vyhbfa5","command":"20","unifios":false,"x":740,"y":180,"wires":[["6cef8202.47cb9c"]]},{"id":"813f45c0.8ed288","type":"time-range-switch","z":"9318493b.8ed8b8","name":"","lat":"58.851468","lon":"5.748852","startTime":"06:45","endTime":"22:00","startOffset":0,"endOffset":0,"x":1690,"y":80,"wires":[["56c00304.d99d1c"],[]]},{"id":"61ee7057.5df1f","type":"time-range-switch","z":"8b99f8fe.7b27b8","name":"","lat":"58.851468","lon":"5.748852","startTime":"06:00","endTime":"22:00","startOffset":0,"endOffset":0,"x":310,"y":460,"wires":[[],["ebfc5adc.7672f8"]]},{"id":"f9c32e8a.e6559","type":"link out","z":"9318493b.8ed8b8","name":"","links":["c44627f4.c21ff8"],"x":2055,"y":280,"wires":[]},{"id":"ea100c04.f677b","type":"googlehome-notify","z":"1c11632f.f206fd","server":"d1934670.897a88","name":"Kjeller: Norsk","x":2050,"y":60,"wires":[]},{"id":"1dd6721c.ecdc0e","type":"googlehome-notify","z":"1c11632f.f206fd","server":"a967d384.f5115","name":"Kjeller:RU","x":2040,"y":100,"wires":[]},{"id":"e938ee3e.149e9","type":"googlehome-notify","z":"1c11632f.f206fd","server":"5ee6b185.35f2d","name":"Stue:RU","x":2040,"y":200,"wires":[]},{"id":"f8249219.9cc45","type":"googlehome-notify","z":"1c11632f.f206fd","server":"35cb409b.4a073","name":"Kjeller:english","x":2060,"y":140,"wires":[]},{"id":"2bfd1c76.96d4a4","type":"googlehome-notify","z":"1c11632f.f206fd","server":"354eb0bd.91999","name":"Stue:English","x":2070,"y":240,"wires":[]},{"id":"d09cfa06.b99e18","type":"googlehome-notify","z":"1c11632f.f206fd","server":"429b8253.24d1dc","name":"Stue: NO","x":2040,"y":280,"wires":[]},{"id":"e239cc32.ce75b","type":"link in","z":"1c11632f.f206fd","name":"GH: Kjeller: NO","links":[],"x":1775,"y":60,"wires":[["ea100c04.f677b"]]},{"id":"be178b19.a730f8","type":"link in","z":"1c11632f.f206fd","name":"GH: Kjeller:  RU","links":[],"x":1775,"y":100,"wires":[["1dd6721c.ecdc0e"]]},{"id":"c9b1af2b.75dac","type":"link in","z":"1c11632f.f206fd","name":"GH: Kjeller: ENG","links":[],"x":1775,"y":140,"wires":[["f8249219.9cc45"]]},{"id":"342f3c87.de1764","type":"link in","z":"1c11632f.f206fd","name":"GH: Stue: RU","links":[],"x":1775,"y":200,"wires":[["e938ee3e.149e9"]]},{"id":"fee9f406.ef48d8","type":"link in","z":"1c11632f.f206fd","name":"GH: Stue: ENG","links":["6c568696.26a908","7db434df.a3db2c","976db23e.1f8ba","64758e77.619e7"],"x":1775,"y":240,"wires":[["9702e016.0991d"]]},{"id":"d8761e25.88f1d","type":"link in","z":"1c11632f.f206fd","name":"GH: Stue: NO","links":["eb9070bf.75d39","9dde96a4.f1d6d8"],"x":1775,"y":280,"wires":[["d09cfa06.b99e18"]]},{"id":"7db434df.a3db2c","type":"link out","z":"bc3b2c68.b35f6","name":"","links":["fee9f406.ef48d8"],"x":615,"y":260,"wires":[]},{"id":"662a4780.2e8b58","type":"inject","z":"1c11632f.f206fd","name":"Set Button value False","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":true,"onceDelay":"1","x":240,"y":1540,"wires":[["27fdfe44.08c092","4b175a54.957e04"]]},{"id":"abc919e5.247498","type":"change","z":"1c11632f.f206fd","name":"","rules":[{"t":"set","p":"guestmode","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":1560,"wires":[[]]},{"id":"27fdfe44.08c092","type":"ui_switch","z":"1c11632f.f206fd","name":"","label":"Gjestemodus","tooltip":"","group":"56a8be2a.9b9eb","order":2,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":470,"y":1560,"wires":[["abc919e5.247498"]]},{"id":"b37115c7.7aec28","type":"mqtt out","z":"1c11632f.f206fd","name":"IdLock","topic":"door","qos":"0","retain":"true","broker":"f6aee802.f74bc8","x":750,"y":1740,"wires":[]},{"id":"180d4919.ebc497","type":"mqtt in","z":"1c11632f.f206fd","name":"IdLock","topic":"door","qos":"0","datatype":"auto","broker":"f6aee802.f74bc8","x":210,"y":1760,"wires":[["70c2d3e0.6beb1c","5516d3d1.7b5a5c"]]},{"id":"65aebf9e.3fbf3","type":"ui_switch","z":"1c11632f.f206fd","name":"Door","label":"{{label}}","tooltip":"","group":"56a8be2a.9b9eb","order":3,"width":0,"height":0,"passthru":false,"decouple":"true","topic":"","style":"","onvalue":"0","onvalueType":"str","onicon":"lock_open","oncolor":"red","offvalue":"255","offvalueType":"str","officon":"lock","offcolor":"Green","x":550,"y":1740,"wires":[["d6443c6.56eebc","b37115c7.7aec28"]]},{"id":"2144d2ba.acf10e","type":"trigger","z":"1c11632f.f206fd","op1":"","op2":"Døren er Åpen","op1type":"nul","op2type":"str","duration":"10","extend":true,"units":"min","reset":"","bytopic":"all","name":"","x":570,"y":1780,"wires":[["e7746f47.54cbc"]]},{"id":"e7746f47.54cbc","type":"link out","z":"1c11632f.f206fd","name":"Door_Notification","links":["9d6f976b.5d59f8"],"x":775,"y":1780,"wires":[]},{"id":"c0005e0c.a1014","type":"link out","z":"bc3b2c68.b35f6","name":"SÃ¸ppel_Push","links":["9d6f976b.5d59f8"],"x":615,"y":220,"wires":[]},{"id":"e812b99e.e523f8","type":"pushbullet","z":"1c11632f.f206fd","config":"530528aa.2006c8","pushtype":"note","title":"","chan":"","name":"Notification","x":2030,"y":340,"wires":[]},{"id":"9d6f976b.5d59f8","type":"link in","z":"1c11632f.f206fd","name":"Pushbullet","links":["e7746f47.54cbc","c0005e0c.a1014","976db23e.1f8ba"],"x":1775,"y":340,"wires":[["e812b99e.e523f8"]]},{"id":"7c801509.abaafc","type":"comment","z":"1c11632f.f206fd","name":"Åpne / Sjekk døren","info":"","x":210,"y":1660,"wires":[]},{"id":"70c2d3e0.6beb1c","type":"function","z":"1c11632f.f206fd","name":"Status","func":"if (msg.payload === \"0\"){\n   msg.label = \"Dør¸r åpen\" \n   return [msg]\n} else {\n     msg.label = \"Dør Lukket\" \n     msg.reset = true;\n     return [msg,msg]\n}\n\n","outputs":2,"noerr":0,"x":370,"y":1760,"wires":[["65aebf9e.3fbf3","2144d2ba.acf10e"],["2144d2ba.acf10e"]]},{"id":"8d968981.156258","type":"comment","z":"1c11632f.f206fd","name":"Knapper","info":"","x":180,"y":1440,"wires":[]},{"id":"8cb7a4a6.a97738","type":"trigger","z":"9318493b.8ed8b8","op1":"","op2":"{ \"power\": \"off\"}","op1type":"nul","op2type":"json","duration":"15","extend":true,"units":"min","reset":"A","bytopic":"all","name":"Turn OFF:DAY","x":1720,"y":160,"wires":[["f9c32e8a.e6559"]]},{"id":"12c8afec.724da","type":"link in","z":"8b99f8fe.7b27b8","name":"","links":["15f11a5d.7f2bb6","c6040a53.209f58"],"x":175,"y":520,"wires":[["fdbf838e.f9e58","e1dcab5a.66f5f8"]]},{"id":"fdbf838e.f9e58","type":"change","z":"8b99f8fe.7b27b8","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":320,"y":520,"wires":[["55a1471c.7ca3e8"]]},{"id":"15f11a5d.7f2bb6","type":"link out","z":"9318493b.8ed8b8","name":"kjller:  Movement","links":["12c8afec.724da"],"x":1635,"y":40,"wires":[]},{"id":"ddc8b687.374538","type":"deconz-input","z":"1b14ec1b.20ab54","name":"","server":"12895ae7.9c6bf5","device":"00:15:8d:00:01:4a:08:f7-01-0006","device_name":"Happy sulten : ZHASwitch","state":"buttonevent","output":"always","outputAtStartup":false,"x":270,"y":80,"wires":[["547e3ce0.793284"],[]]},{"id":"547e3ce0.793284","type":"function","z":"1b14ec1b.20ab54","name":"Happy outside ","func":"msg.payload = \"Happy wants to go outside\";\nmsg.emitVolume =50;\nlet msg2 = {};\nmsg2.payload = [ {\n        \"title\": \"Outside\",\n        \"description\": \"Happy wants to go Outside\",\n        \"icon\": \"https://lh3.googleusercontent.com/F7dHEApWlOufIKF5NX7EHtx1VTPfKWRIN-bOMch2Mi5eixq7cASp-Jh4kr2T4u5l5OUwkhZgowOD6HSOvnnSDi14oaDkREKSmejYnyOujkuSUw5mkIr_AqgIkZro25qWezWl3jxMwv-yTNCzPGV_ABugX9malJX4ZMEumc0cz5wQHsJxfh334ayq_yAslDd7cRzVytebggUPZ7kzxiWYtNAPZLzuOhZLu831adN6OM91wD7glPQoticU3Lh97Hzi1bHI55CEsMuY0DI4jIGlHCkhziI7Xm3FoZCjqX467O5uqKxHzdsamQ9FLGPquo7xr5FBaFUlrwtYoliH1kfSLEVF5C2b_zwErbcjQPCmKyPWQiUthDLvtcatWZ-zC7XmZb3knlSdb_ecwFmbm5lyn0krvtDU123uynS_xLK2C8uXhUP_A3r2msHBEIqrQoDP3HCHlJl2rOQ77Mxgh1uqUCZTT2EUGs67B-beYgbVcd_8wydZfHl6Pn4LP04yilrP3yCZtPT9zC_j-XM4AH_5kunbXytenZHLteaI4ppe4u9lnRCjX5nq8vshrXfOJINr_XvBbUQRHb1uUxQ9N0R_a8i7McUanKl06SX967PMOl9mxSC4LrisMzTj4KoWATsVCU8oXeo6DEsx-l0ICLeLven98hfoAFZym6jPVhBbUmZF7c_IGuqEgUvDw0HI1jc5uATSRxz-7YDELuDpAz4DKQBMMToV-yZdpNQXsM3zpu1Je7j9nA=w563-h545-no\"\n    }];\n\nreturn [msg, msg2];","outputs":2,"noerr":0,"x":520,"y":80,"wires":[["976db23e.1f8ba"],["9ab1a383.0f88b"]]},{"id":"976db23e.1f8ba","type":"link out","z":"1b14ec1b.20ab54","name":"","links":["9d6f976b.5d59f8","fee9f406.ef48d8"],"x":760,"y":80,"wires":[]},{"id":"eb90ae51.1af18","type":"deconz-input","z":"1b14ec1b.20ab54","name":"","server":"12895ae7.9c6bf5","device":"00:15:8d:00:01:9d:e5:2c-01-0006","device_name":"Happy vil ut : ZHASwitch","state":"buttonevent","output":"always","outputAtStartup":false,"x":270,"y":140,"wires":[["4f048068.a4401"],[]]},{"id":"4f048068.a4401","type":"function","z":"1b14ec1b.20ab54","name":"Happy hungry","func":"msg.payload = \"Happy is hungry\";\nmsg.emitVolume =50;\n\n\nlet msg2 = {};\nmsg2.payload = [ {\n        \"title\": \"Eat\",\n        \"description\": \"Happy wants to eat\",\n        \"icon\": \"https://lh3.googleusercontent.com/F7dHEApWlOufIKF5NX7EHtx1VTPfKWRIN-bOMch2Mi5eixq7cASp-Jh4kr2T4u5l5OUwkhZgowOD6HSOvnnSDi14oaDkREKSmejYnyOujkuSUw5mkIr_AqgIkZro25qWezWl3jxMwv-yTNCzPGV_ABugX9malJX4ZMEumc0cz5wQHsJxfh334ayq_yAslDd7cRzVytebggUPZ7kzxiWYtNAPZLzuOhZLu831adN6OM91wD7glPQoticU3Lh97Hzi1bHI55CEsMuY0DI4jIGlHCkhziI7Xm3FoZCjqX467O5uqKxHzdsamQ9FLGPquo7xr5FBaFUlrwtYoliH1kfSLEVF5C2b_zwErbcjQPCmKyPWQiUthDLvtcatWZ-zC7XmZb3knlSdb_ecwFmbm5lyn0krvtDU123uynS_xLK2C8uXhUP_A3r2msHBEIqrQoDP3HCHlJl2rOQ77Mxgh1uqUCZTT2EUGs67B-beYgbVcd_8wydZfHl6Pn4LP04yilrP3yCZtPT9zC_j-XM4AH_5kunbXytenZHLteaI4ppe4u9lnRCjX5nq8vshrXfOJINr_XvBbUQRHb1uUxQ9N0R_a8i7McUanKl06SX967PMOl9mxSC4LrisMzTj4KoWATsVCU8oXeo6DEsx-l0ICLeLven98hfoAFZym6jPVhBbUmZF7c_IGuqEgUvDw0HI1jc5uATSRxz-7YDELuDpAz4DKQBMMToV-yZdpNQXsM3zpu1Je7j9nA=w563-h545-no\"\n    }];\n\nreturn [msg, msg2];","outputs":2,"noerr":0,"x":520,"y":140,"wires":[["976db23e.1f8ba"],["9ab1a383.0f88b"]]},{"id":"14d4c15d.0b6a7f","type":"switch","z":"9318493b.8ed8b8","name":"Mode","property":"Mode","propertyType":"global","rules":[{"t":"neq","v":"away","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":550,"y":200,"wires":[["81065b1a.33fb78"]]},{"id":"ebfc5adc.7672f8","type":"switch","z":"8b99f8fe.7b27b8","name":"Mode","property":"Mode","propertyType":"global","rules":[{"t":"eq","v":"home","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":490,"y":460,"wires":[["55a1471c.7ca3e8"]]},{"id":"3de649e9.5c9be6","type":"link out","z":"8b99f8fe.7b27b8","name":"to bedroom","links":[],"x":975,"y":480,"wires":[]},{"id":"a085a6f7.ae8698","type":"change","z":"8b99f8fe.7b27b8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":480,"wires":[["3de649e9.5c9be6"]]},{"id":"66d9f1c.785941","type":"function","z":"1c11632f.f206fd","name":"Update State_1_floor","func":"let systemState = global.get(\"State_1_floor\") || {};\n\n        let name = msg.name;\n        let power = msg.power ;\n        let pay = { name,power}\n        let id = msg.id;\n        systemState[id] = pay;\n    \n\nglobal.set(\"State_1_floor\", systemState);\n\n\nreturn msg;\n\n\n\n\n\n","outputs":1,"noerr":0,"x":760,"y":1160,"wires":[["389edf89.60cfe"]]},{"id":"389edf89.60cfe","type":"function","z":"1c11632f.f206fd","name":"Set State_1_floor","func":"let systemState = global.get(\"State_1_floor\") || {};\n\n\n\n    for(var k in systemState)\n    {\n        name = systemState[k].name\n        status = systemState[k].power \n        pay = {jquerySelector: name, status}\n        msg.payload = pay\n        node.send(msg)\n    }\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"x":1070,"y":1160,"wires":[["343547fd.e77fb8"]]},{"id":"3573446a.e843bc","type":"deconz-input","z":"605ae98f.8a9998","name":"","server":"12895ae7.9c6bf5","device":"cc:cc:cc:ff:fe:08:18:a1-01-1000","device_name":"TRADFRI open/close remote  : ZHASwitch","topic":"","state":0,"output":"always","outputAtStartup":true,"x":520,"y":420,"wires":[["a4770dbb.04eff"],[]]},{"id":"a4770dbb.04eff","type":"switch","z":"605ae98f.8a9998","name":"button press","property":"payload.buttonevent","propertyType":"msg","rules":[{"t":"eq","v":"2002","vt":"str"},{"t":"eq","v":"1002","vt":"num"}],"checkall":"false","repair":false,"outputs":2,"x":770,"y":420,"wires":[["4182b18c.6b705"],["20238790.e84df8"]]},{"id":"20238790.e84df8","type":"change","z":"605ae98f.8a9998","name":"Open","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1010,"y":440,"wires":[["f2a2928e.e1b4f","1bb57f45.872e71","26caebff.0ab3c4"]]},{"id":"4182b18c.6b705","type":"change","z":"605ae98f.8a9998","name":"CLOSE","rules":[{"t":"set","p":"payload","pt":"msg","to":"255","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":1020,"y":400,"wires":[["f2a2928e.e1b4f","1bb57f45.872e71","112531d1.56298e"]]},{"id":"f2a2928e.e1b4f","type":"deconz-output","z":"605ae98f.8a9998","name":"","server":"12895ae7.9c6bf5","device":"cc:cc:cc:ff:fe:02:96:c6-01","device_name":"Window covering device 5 : Window covering device","command":"bri","commandType":"deconz_cmd","payload":"payload","payloadType":"msg","transitionTime":"","x":1400,"y":400,"wires":[]},{"id":"6c1d6758.428808","type":"link in","z":"605ae98f.8a9998","name":"IK: Sov","links":["fd49ca1d.879ac8","b630d8c.cb7f128"],"x":515,"y":380,"wires":[["cec0f8cb.33f1b8"]]},{"id":"cec0f8cb.33f1b8","type":"switch","z":"605ae98f.8a9998","name":"open/close","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":false,"outputs":2,"x":770,"y":380,"wires":[["4182b18c.6b705"],["20238790.e84df8"]]},{"id":"247260f.c82dca","type":"link out","z":"8b99f8fe.7b27b8","name":"SH: HOME","links":["3072aa8d.fc3b66","8456ad2c.7b492"],"x":1775,"y":240,"wires":[]},{"id":"d6443c6.56eebc","type":"homekit-service","z":"1c11632f.f206fd","isParent":true,"bridge":"83ed609b.13959","parentService":"","name":"IdLock","serviceName":"LockManagement","topic":"","filter":false,"manufacturer":"Default Manufacturer","model":"Default Model","serialNo":"Default Serial Number","cameraConfigVideoProcessor":"ffmpeg","cameraConfigSource":"","cameraConfigStillImageSource":"","cameraConfigMaxStreams":2,"cameraConfigMaxWidth":1280,"cameraConfigMaxHeight":720,"cameraConfigMaxFPS":10,"cameraConfigMaxBitrate":300,"cameraConfigVideoCodec":"libx264","cameraConfigAudioCodec":"libfdk_aac","cameraConfigAudio":false,"cameraConfigPacketSize":1316,"cameraConfigVerticalFlip":false,"cameraConfigHorizontalFlip":false,"cameraConfigMapVideo":"0:0","cameraConfigMapAudio":"0:1","cameraConfigVideoFilter":"scale=1280:720","cameraConfigAdditionalCommandLine":"-tune zerolatency","cameraConfigDebug":false,"cameraConfigSnapshotOutput":"disabled","characteristicProperties":"{}","x":750,"y":1700,"wires":[[],[]]},{"id":"fc4fe81e.444628","type":"link out","z":"8b99f8fe.7b27b8","name":"SH: Away","links":["3072aa8d.fc3b66","8456ad2c.7b492"],"x":1775,"y":280,"wires":[]},{"id":"79007779.8a0088","type":"function","z":"1c11632f.f206fd","name":"Update State_basement","func":"let systemState = global.get(\"State_basement\") || {};\n\n     let name = msg.name;\n        let power = msg.power ;\n        let pay = { name,power}\n        let id = msg.id;\n        systemState[id] = pay;\nglobal.set(\"State_basement\", systemState);\n\nreturn msg;\n\n\n\n\n\n\n","outputs":1,"noerr":0,"x":770,"y":1240,"wires":[["3054be45.205a62"]]},{"id":"3054be45.205a62","type":"function","z":"1c11632f.f206fd","name":"Set State_basement","func":"let systemState = global.get(\"State_basement\") || {};\n\n\n\n    for(var k in systemState)\n    {\n        name = systemState[k].name\n        status = systemState[k].power \n        pay = {jquerySelector: name, status}\n        msg.payload = pay\n        node.send(msg)\n    }\n\n\n\n\n\n\n\n\n","outputs":1,"noerr":0,"x":1060,"y":1240,"wires":[["db00bb8.82e0148"]]},{"id":"b1e4c558.fb5618","type":"ui_ui_control","z":"1c11632f.f206fd","name":"","events":"all","x":720,"y":1200,"wires":[["389edf89.60cfe","3054be45.205a62","8a2b5b04.944b38"]]},{"id":"9702e016.0991d","type":"delay","z":"1c11632f.f206fd","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"2","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":1900,"y":240,"wires":[["2bfd1c76.96d4a4"]]},{"id":"74a70908.bd50d8","type":"inject","z":"605ae98f.8a9998","name":"Åpne Gardin 07 00","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":310,"y":320,"wires":[["8818e486.2765d8"]]},{"id":"8f119d5d.e9645","type":"switch","z":"1c11632f.f206fd","name":"Gardiner","property":"payload.name","propertyType":"msg","rules":[{"t":"eq","v":"Sov_Gardin","vt":"str"}],"checkall":"false","repair":false,"outputs":1,"x":1660,"y":1240,"wires":[["e2e0325d.993a1"]]},{"id":"e2e0325d.993a1","type":"change","z":"1c11632f.f206fd","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.on","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1840,"y":1240,"wires":[["b630d8c.cb7f128"]]},{"id":"b630d8c.cb7f128","type":"link out","z":"1c11632f.f206fd","name":"Ikea: Gardin SOV","links":["6c1d6758.428808"],"x":1955,"y":1240,"wires":[]},{"id":"7f15ef4a.ce4ca","type":"rbe","z":"1c11632f.f206fd","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload.devices.power","x":490,"y":1300,"wires":[["79007779.8a0088"]]},{"id":"d8a4e608.f39898","type":"link in","z":"1c11632f.f206fd","name":"Sm: Gardin","links":["bb45bf3b.5ab5f"],"x":295,"y":1300,"wires":[["7f15ef4a.ce4ca"]]},{"id":"bb45bf3b.5ab5f","type":"link out","z":"605ae98f.8a9998","name":"","links":["d8a4e608.f39898"],"x":1515,"y":440,"wires":[]},{"id":"9ab1a383.0f88b","type":"ui_list","z":"1b14ec1b.20ab54","group":"56a8be2a.9b9eb","name":"Happy","order":4,"width":"6","height":"5","lineType":"three","actionType":"none","allowHTML":false,"outputs":0,"topic":"Happy","x":790,"y":140,"wires":[]},{"id":"3a030b43.080134","type":"inject","z":"bc3b2c68.b35f6","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":300,"y":320,"wires":[["9430e52f.746a78"]]},{"id":"6fce2655.029658","type":"trigger","z":"8b99f8fe.7b27b8","op1":"","op2":"","op1type":"nul","op2type":"date","duration":"10","extend":true,"units":"min","reset":"","bytopic":"all","name":"","x":1470,"y":280,"wires":[["e4c32eed.12537"]]},{"id":"3e0910d1.7d582","type":"change","z":"8b99f8fe.7b27b8","name":"Reset Away","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1470,"y":240,"wires":[["6fce2655.029658","f0615fd.9f26ba"]]},{"id":"e1dcab5a.66f5f8","type":"time-range-switch","z":"8b99f8fe.7b27b8","name":"","lat":"58.851468","lon":"5.748852","startTime":"06:00","endTime":"11:00","startOffset":0,"endOffset":0,"x":310,"y":560,"wires":[["2e0d79f5.69a796"],[]]},{"id":"2e0d79f5.69a796","type":"link out","z":"8b99f8fe.7b27b8","name":"FH: Movement Morning","links":["1d2eacde.d050c3"],"x":555,"y":560,"wires":[]},{"id":"1d2eacde.d050c3","type":"link in","z":"8b99f8fe.7b27b8","name":"FH: Home Mode","links":["2e0d79f5.69a796"],"x":1195,"y":200,"wires":[["3e6914e6.deefec"]]},{"id":"3e6914e6.deefec","type":"switch","z":"8b99f8fe.7b27b8","name":"Mode","property":"Mode","propertyType":"global","rules":[{"t":"eq","v":"away","vt":"str"},{"t":"eq","v":"sleep","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1490,"y":200,"wires":[["f0615fd.9f26ba"],["f0615fd.9f26ba"]]},{"id":"432f9819.985b38","type":"switch","z":"9318493b.8ed8b8","name":"Presence","property":"payload.devices.presence","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"false","repair":true,"outputs":2,"x":1460,"y":80,"wires":[["6199c3a6.b2c1ec","15f11a5d.7f2bb6","813f45c0.8ed288"],["d97a92f4.627f3","8cb7a4a6.a97738"]]},{"id":"6199c3a6.b2c1ec","type":"function","z":"9318493b.8ed8b8","name":"msg.reset","func":"msg.reset = true;\nreturn msg;","outputs":1,"noerr":0,"x":1480,"y":160,"wires":[["8cb7a4a6.a97738"]]},{"id":"ae161303.28f11","type":"switch","z":"9318493b.8ed8b8","name":"Lux NivÃ¥","property":"lux","propertyType":"flow","rules":[{"t":"lte","v":"200","vt":"num"},{"t":"else"}],"checkall":"false","repair":true,"outputs":2,"x":910,"y":200,"wires":[["74d16771.1acde8","ab66b8d2.d8bb88"],[]]},{"id":"56c00304.d99d1c","type":"change","z":"9318493b.8ed8b8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"power\":\"on\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1880,"y":80,"wires":[["f9c32e8a.e6559"]]},{"id":"525d4b6.a82efb4","type":"nora-blinds","z":"605ae98f.8a9998","devicename":"Blinds","roomhint":"Bedroom","name":"","passthru":false,"invert":false,"nora":"54f6a8ea.957eb8","topic":"rullegardin","x":610,"y":460,"wires":[["d6717b22.f0d1e8"]]},{"id":"26caebff.0ab3c4","type":"function","z":"605ae98f.8a9998","name":"Open","func":"msg.payload = {openPercent : 100};\nreturn msg;","outputs":1,"noerr":0,"x":1170,"y":580,"wires":[["525d4b6.a82efb4"]]},{"id":"112531d1.56298e","type":"function","z":"605ae98f.8a9998","name":"Close","func":"msg.payload = {openPercent : 0};\nreturn msg;","outputs":1,"noerr":0,"x":1170,"y":540,"wires":[["525d4b6.a82efb4"]]},{"id":"d6717b22.f0d1e8","type":"switch","z":"605ae98f.8a9998","name":"open/close","property":"payload.openPercent","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"100","vt":"str"}],"checkall":"false","repair":true,"outputs":2,"x":770,"y":460,"wires":[["4182b18c.6b705"],["20238790.e84df8"]]},{"id":"1bb57f45.872e71","type":"function","z":"605ae98f.8a9998","name":"","func":"        msg.payload = {devices:{id: \"id\",name: \"Sov_Gardin\", power: (msg.payload === 0) ? \"off\" : \"on\"}};\n      \n        \n   \nreturn msg;","outputs":1,"noerr":0,"x":1250,"y":440,"wires":[["bb45bf3b.5ab5f"]]},{"id":"2603c373.b06f0c","type":"switch","z":"605ae98f.8a9998","name":"","property":"guestmode","propertyType":"global","rules":[{"t":"false"}],"checkall":"true","repair":true,"outputs":1,"x":630,"y":300,"wires":[["cec0f8cb.33f1b8"]]},{"id":"74d16771.1acde8","type":"function","z":"9318493b.8ed8b8","name":"Override ny","func":"var overridebase = global.get('overridebase');\nlet topic = msg.topic || \"nothing\"\n//if(msg.topic !== null){\nif (topic.includes(\"OVERRIDE\"))  {\n    if (msg.payload==\"1\") overridebase=\"ON\";\n    if (msg.payload==\"0\") overridebase=\"OFF\";\n    if (msg.payload==\"A\") overridebase=\"AUTO\";\n//}\n}\nglobal.set('overridebase',overridebase);\n\nnode.status({fill:\"blue\",shape:\"ring\",text:\"Override: \"+ overridebase});    \n\nif (msg.payload==\"A\"){\n   return null; \n} \nif (overridebase==\"ON\"){\n     msg.payload={ \"power\": \"on\"};\n     return [null, msg];\n}\nif (overridebase==\"OFF\") {\n     msg.payload={ \"power\": \"off\"};\n     return [null, msg];\n}\n\nreturn msg;","outputs":2,"noerr":0,"x":1270,"y":200,"wires":[["432f9819.985b38"],["6199c3a6.b2c1ec","f9c32e8a.e6559"]]},{"id":"817f1df1.c5f98","type":"exec","z":"1c11632f.f206fd","command":"node-red-restart","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":1340,"y":100,"wires":[[],[],[]]},{"id":"aecb8d48.af66f","type":"inject","z":"1c11632f.f206fd","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":1140,"y":100,"wires":[["817f1df1.c5f98"]]},{"id":"c7d21fe9.5236b","type":"inject","z":"8b99f8fe.7b27b8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":1270,"y":120,"wires":[["25a02385.599d9c"]]},{"id":"25a02385.599d9c","type":"change","z":"8b99f8fe.7b27b8","name":"Set at Startup","rules":[{"t":"set","p":"payload","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1460,"y":120,"wires":[["f0615fd.9f26ba"]]},{"id":"81065b1a.33fb78","type":"change","z":"9318493b.8ed8b8","name":"","rules":[{"t":"set","p":"lux","pt":"flow","to":"payload.devices.illuminance","tot":"msg"},{"t":"set","p":"topic","pt":"msg","to":"basement","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":200,"wires":[["ae161303.28f11"]]},{"id":"772b0560.6b8bcc","type":"link out","z":"8b99f8fe.7b27b8","name":"heggland","links":["63c7ba61.3e3df4","d871d736.d19838"],"x":955,"y":200,"wires":[]},{"id":"47763aff.5ff334","type":"link out","z":"8b99f8fe.7b27b8","name":"karina","links":["b9ab5a15.2f2aa8","84abded8.462ac"],"x":955,"y":320,"wires":[]},{"id":"8a2b5b04.944b38","type":"change","z":"1c11632f.f206fd","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"date"}],"action":"","property":"","from":"","to":"","reg":false,"x":1080,"y":1200,"wires":[["3054be45.205a62","389edf89.60cfe"]]},{"id":"16e01a0.bfa88e6","type":"trigger","z":"8b99f8fe.7b27b8","op1":"home","op2":"0","op1type":"str","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"away","bytopic":"all","name":"","x":1260,"y":240,"wires":[["fc71e441.058a48","3e0910d1.7d582"]]},{"id":"fc71e441.058a48","type":"trigger","z":"8b99f8fe.7b27b8","op1":"away","op2":"0","op1type":"str","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"home","bytopic":"all","name":"","x":1260,"y":280,"wires":[["16e01a0.bfa88e6","6fce2655.029658"]]},{"id":"4c6b976d.5fb918","type":"inject","z":"f487aa99.386108","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":460,"y":160,"wires":[["602fce3c.7d792"]]},{"id":"602fce3c.7d792","type":"influxdb in","z":"f487aa99.386108","influxdb":"99977a8c.c02588","name":"Get Motion ","query":"select * from Motion ORDER BY time DESC limit 10 ","rawOutput":false,"precision":"","retentionPolicy":"","x":670,"y":160,"wires":[["4c3aea37.34b724"]]},{"id":"991ef94.bba8508","type":"ui_list","z":"f487aa99.386108","group":"583fffe9.e7d8f","name":"Movement","order":1,"width":"7","height":15,"lineType":"three","actionType":"none","allowHTML":false,"outputs":0,"topic":"Movement","x":1050,"y":160,"wires":[]},{"id":"8f9dc82d.0e7b28","type":"trigger","z":"f487aa99.386108","op1":"","op2":"","op1type":"nul","op2type":"payl","duration":"10","extend":false,"units":"ms","reset":"","bytopic":"all","name":"","x":850,"y":120,"wires":[["4c3aea37.34b724"]]},{"id":"fc896ae2.2631d8","type":"function","z":"f487aa99.386108","name":"Iterate","func":"//Node has 2 outputs - 1 for itteration and 1 for completion\nvar nextObj, out;\nvar itt = msg.iterationInfo;\n\n\n//If the iterating has not yet begun set up the iteration metadata in the msg\nif (typeof itt === 'undefined') {\n    //Make sure payload is an array\n    if( Object.prototype.toString.call(msg.payload) !== '[object Array]' ) {\n       msg.payload = [msg.payload];\n    }\n\n    msg.iterationInfo = itt = {};\n    itt.index = -1;\n    itt.inArray = msg.payload;\n    itt.outArray = [];\n\n//Otherwise just push the input to the output array\n} else {\n    \n    var listdata = {};\n     listdata.title = msg.payload.mode\n    listdata.icon_name = \"fa-home\";\n    if(listdata.title == \"away\"){\n         listdata.icon_name = \"fa-sign-out\";\n    }else if (listdata.title == \"sleep\"){\n         listdata.icon_name = \"fa-bed\";\n    }\n    \n    listdata.title = msg.payload.mode + \": \" + msg.payload.time.toLocaleTimeString();\n    listdata.description = msg.payload.time.toDateString()  ;\n    itt.outArray.push(listdata)\n}\n\n//Goto next object\nitt.index ++;\n\n//If there are stil objects left to iterate goto the next one in the original array\nif (itt.index < itt.inArray.length) {\n    nextObj = msg;\n    msg.payload = itt.inArray[itt.index];\n\n//otherwise pass the out array as the payload\n} else {\n    out = msg;\n    msg.payload = itt.outArray;\n    delete msg.iterationInfo;\n}\n\nreturn [nextObj, out];","outputs":"2","noerr":0,"x":850,"y":280,"wires":[["9525b6d6.0d24b8"],["3f602c1d.afdeb4"]]},{"id":"cac92042.f5d51","type":"inject","z":"f487aa99.386108","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":460,"y":280,"wires":[["fbde8b9b.41d5c8"]]},{"id":"fbde8b9b.41d5c8","type":"influxdb in","z":"f487aa99.386108","influxdb":"99977a8c.c02588","name":"Get Mode","query":"select * from Mode ORDER BY time DESC limit 10 ","rawOutput":false,"precision":"","retentionPolicy":"","x":660,"y":280,"wires":[["fc896ae2.2631d8"]]},{"id":"3f602c1d.afdeb4","type":"ui_list","z":"f487aa99.386108","group":"583fffe9.e7d8f","name":"Mode","order":2,"width":"7","height":15,"lineType":"three","actionType":"none","allowHTML":false,"outputs":0,"topic":"Mode","x":1010,"y":280,"wires":[]},{"id":"9525b6d6.0d24b8","type":"trigger","z":"f487aa99.386108","op1":"","op2":"","op1type":"nul","op2type":"payl","duration":"10","extend":false,"units":"ms","reset":"","bytopic":"all","name":"","x":850,"y":240,"wires":[["fc896ae2.2631d8"]]},{"id":"4c3aea37.34b724","type":"function","z":"f487aa99.386108","name":"Iterate","func":"//Node has 2 outputs - 1 for itteration and 1 for completion\nvar nextObj, out;\nvar itt = msg.iterationInfo;\n\n\n//If the iterating has not yet begun set up the iteration metadata in the msg\nif (typeof itt === 'undefined') {\n    //Make sure payload is an array\n    if( Object.prototype.toString.call(msg.payload) !== '[object Array]' ) {\n       msg.payload = [msg.payload];\n    }\n\n    msg.iterationInfo = itt = {};\n    itt.index = -1;\n    itt.inArray = msg.payload;\n    itt.outArray = [];\n\n//Otherwise just push the input to the output array\n} else {\n    \n    var listdata = {};\n     listdata.title = msg.payload.name + \": \" + msg.payload.time.toLocaleTimeString();\n    listdata.icon_name =  \"fa-stop\";\n    if(msg.payload.movement === true){\n           listdata.icon_name = \"fa-play\";\n    }\n    \n    \n    listdata.description =  msg.payload.time.toDateString()  ;\n    itt.outArray.push(listdata)\n}\n\n//Goto next object\nitt.index ++;\n\n//If there are stil objects left to iterate goto the next one in the original array\nif (itt.index < itt.inArray.length) {\n    nextObj = msg;\n    msg.payload = itt.inArray[itt.index];\n\n//otherwise pass the out array as the payload\n} else {\n    out = msg;\n    msg.payload = itt.outArray;\n    delete msg.iterationInfo;\n}\n\nreturn [nextObj, out];","outputs":"2","noerr":0,"x":849,"y":163,"wires":[["8f9dc82d.0e7b28"],["991ef94.bba8508"]]},{"id":"3d1162d0.861b9e","type":"function","z":"f487aa99.386108","name":"Iterate","func":"//Node has 2 outputs - 1 for itteration and 1 for completion\nvar nextObj, out;\nvar itt = msg.iterationInfo;\n\n\n//If the iterating has not yet begun set up the iteration metadata in the msg\nif (typeof itt === 'undefined') {\n    //Make sure payload is an array\n    if( Object.prototype.toString.call(msg.payload) !== '[object Array]' ) {\n       msg.payload = [msg.payload];\n    }\n\n    msg.iterationInfo = itt = {};\n    itt.index = -1;\n    itt.inArray = msg.payload;\n    itt.outArray = [];\n\n//Otherwise just push the input to the output array\n} else {\n    \n    var listdata = {};\n     listdata.title = msg.payload.name\n    listdata.icon_name = \"fa-home\";\n    if(msg.payload.Status === false){\n         listdata.icon_name = \"fa-sign-out\";\n    }\n    \n    listdata.title = msg.payload.name + \": \" + msg.payload.Status;\n    listdata.description = \"KL:  \" + msg.payload.time.toLocaleTimeString() + \" \" + msg.payload.time.toDateString()  ;\n    itt.outArray.push(listdata)\n}\n\n//Goto next object\nitt.index ++;\n\n//If there are stil objects left to iterate goto the next one in the original array\nif (itt.index < itt.inArray.length) {\n    nextObj = msg;\n    msg.payload = itt.inArray[itt.index];\n\n//otherwise pass the out array as the payload\n} else {\n    out = msg;\n    msg.payload = itt.outArray;\n    delete msg.iterationInfo;\n}\n\nreturn [nextObj, out];","outputs":"2","noerr":0,"x":850,"y":380,"wires":[["13992971.9f5ad7"],["7867cbfa.2c5394"]]},{"id":"57121958.385898","type":"inject","z":"f487aa99.386108","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":460,"y":380,"wires":[["d3a7cd73.75602"]]},{"id":"d3a7cd73.75602","type":"influxdb in","z":"f487aa99.386108","influxdb":"99977a8c.c02588","name":"Get UserState","query":"select * from UserState ORDER BY time DESC limit 10 ","rawOutput":false,"precision":"","retentionPolicy":"","x":680,"y":380,"wires":[["3d1162d0.861b9e"]]},{"id":"7867cbfa.2c5394","type":"ui_list","z":"f487aa99.386108","group":"583fffe9.e7d8f","name":"userState","order":2,"width":"7","height":15,"lineType":"three","actionType":"none","allowHTML":false,"outputs":0,"topic":"Mode","x":1020,"y":380,"wires":[]},{"id":"13992971.9f5ad7","type":"trigger","z":"f487aa99.386108","op1":"","op2":"","op1type":"nul","op2type":"payl","duration":"10","extend":false,"units":"ms","reset":"","bytopic":"all","name":"","x":850,"y":340,"wires":[["3d1162d0.861b9e"]]},{"id":"1f582a21.663076","type":"ui_ui_control","z":"f487aa99.386108","name":"","events":"connect","x":240,"y":260,"wires":[["602fce3c.7d792","fbde8b9b.41d5c8","d3a7cd73.75602"]]},{"id":"8818e486.2765d8","type":"switch","z":"605ae98f.8a9998","name":"","property":"sleepLonger","propertyType":"global","rules":[{"t":"false"}],"checkall":"true","repair":false,"outputs":1,"x":490,"y":320,"wires":[["2603c373.b06f0c"]]},{"id":"57af7185.ee32f","type":"change","z":"1c11632f.f206fd","name":"","rules":[{"t":"set","p":"sleepLonger","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":1520,"wires":[[]]},{"id":"4b175a54.957e04","type":"ui_switch","z":"1c11632f.f206fd","name":"SleepLonger","label":"SleepLonger","tooltip":"","group":"56a8be2a.9b9eb","order":2,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"hotel","oncolor":"green","offvalue":"false","offvalueType":"bool","officon":"fa-sun-o","offcolor":"orange","x":470,"y":1520,"wires":[["3c3caacd.eb8986","57af7185.ee32f"]]},{"id":"3c3caacd.eb8986","type":"trigger","z":"1c11632f.f206fd","op1":"","op2":"false","op1type":"nul","op2type":"bool","duration":"15","extend":false,"units":"hr","reset":"false","bytopic":"all","name":"Reset","x":470,"y":1480,"wires":[["4b175a54.957e04"]]},{"id":"ab66b8d2.d8bb88","type":"rbe","z":"9318493b.8ed8b8","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload.devices.presence","x":1070,"y":260,"wires":[["b6bc1feb.434cf"]]},{"id":"77ccbb67.9f0614","type":"influxdb out","z":"f487aa99.386108","influxdb":"99977a8c.c02588","name":"Motion","measurement":"Motion","precision":"","retentionPolicy":"","x":850,"y":620,"wires":[]},{"id":"6c66c8c9.ee9c18","type":"function","z":"f487aa99.386108","name":"Store Movement","func":"var d = new Date();\nvar n = d.getTime();\n\nmsg.payload = {\n    name:msg.topic,\n    movement: msg.presence\n    \n}\nreturn msg;","outputs":1,"noerr":0,"x":680,"y":620,"wires":[["77ccbb67.9f0614"]]},{"id":"93ef5d70.0130e","type":"link in","z":"f487aa99.386108","name":"Movement Status","links":["b6bc1feb.434cf","96c7928d.91306"],"x":515,"y":620,"wires":[["6c66c8c9.ee9c18"]]},{"id":"b6bc1feb.434cf","type":"link out","z":"9318493b.8ed8b8","name":"Data Out","links":["93ef5d70.0130e"],"x":1175,"y":260,"wires":[]},{"id":"fdbcb7b8.ece208","type":"function","z":"f487aa99.386108","name":"Store Mode","func":"var d = new Date();\nvar n = d.getTime();\n\nmsg.payload = {\n    mode:global.get(\"Mode\")\n    \n}\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":660,"wires":[["5da10e65.4ab27"]]},{"id":"5da10e65.4ab27","type":"influxdb out","z":"f487aa99.386108","influxdb":"99977a8c.c02588","name":"Mode","measurement":"Mode","precision":"","retentionPolicy":"","x":850,"y":660,"wires":[]},{"id":"5b63eaae.4cbcf4","type":"link in","z":"f487aa99.386108","name":"Mode Status","links":["973fda0d.893748","47e242b5.0edd6c"],"x":515,"y":660,"wires":[["fdbcb7b8.ece208"]]},{"id":"e665b73a.350dd8","type":"influxdb out","z":"f487aa99.386108","influxdb":"99977a8c.c02588","name":"Users","measurement":"UserState","precision":"","retentionPolicy":"","x":850,"y":700,"wires":[]},{"id":"1ad64b95.49d574","type":"function","z":"f487aa99.386108","name":"Store Person","func":"var d = new Date();\nvar n = d.getTime();\n\nmsg.payload = {\n    name:msg.topic,\n    Status: msg.payload\n    \n}\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":700,"wires":[["e665b73a.350dd8"]]},{"id":"e3ae9576.18be48","type":"link in","z":"f487aa99.386108","name":"Person Status","links":["3220b5b9.05cd2a","19836afb.acbac5"],"x":515,"y":700,"wires":[["1ad64b95.49d574"]]},{"id":"8ea3f755.e68d88","type":"miio-roborock-command","z":"8b99f8fe.7b27b8","name":"Mr Robot Start","server":"6708f2f6.06829c","command_name":"► Start","command":"app_start","commandType":"vacuum_cmd","payload":"payload","payloadType":"msg","coordinates":"","fan_speed":100,"voice_pack":null,"homekit_stop_to_dock":true,"x":2220,"y":280,"wires":[[]]},{"id":"5e0f66ea.3848a8","type":"miio-roborock-command","z":"8b99f8fe.7b27b8","name":"Mr Robot STOP","server":"6708f2f6.06829c","command_name":"◼ Stop & dock","command":"app_stop_dock","commandType":"vacuum_cmd","payload":"payload","payloadType":"msg","coordinates":"","fan_speed":100,"voice_pack":null,"homekit_stop_to_dock":true,"x":2220,"y":240,"wires":[[]]},{"id":"3572fdf5.48cc62","type":"miio-roborock-event","z":"1c11632f.f206fd","name":"Mr Robot","server":"6708f2f6.06829c","eventTypes":["state"],"outputAtStartup":true,"x":220,"y":80,"wires":[["9ae92a2b.99c9c8"]]},{"id":"704455a7.c3d2ec","type":"ui_switch","z":"1c11632f.f206fd","name":"Mr Robot","label":"Mr Robot is {{label}}","tooltip":"","group":"56a8be2a.9b9eb","order":1,"width":0,"height":0,"passthru":false,"decouple":"true","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"fa-bolt","oncolor":"orange","offvalue":"false","offvalueType":"bool","officon":"fa-sign-out","offcolor":"red","x":740,"y":80,"wires":[[]]},{"id":"9ae92a2b.99c9c8","type":"function","z":"1c11632f.f206fd","name":"Convert Data","func":"     msg.label = msg.status.state;\n     //msg.payload = global.get(\"Mode\");\n     msg.payload = false;\n     if(msg.label === \"charging\"){\n         msg.payload = true;\n     }\n     \n \nreturn msg;\n","outputs":1,"noerr":0,"x":490,"y":80,"wires":[["704455a7.c3d2ec"]]},{"id":"b8864aca.286918","type":"time-range-switch","z":"605ae98f.8a9998","name":"","lat":"58.851468","lon":"5.748852","startTime":"20","endTime":"23:59","startOffset":0,"endOffset":0,"x":340,"y":140,"wires":[["fcc1dd3e.6655c"],["1936c958.eeea77"]]},{"id":"fcc1dd3e.6655c","type":"trigger","z":"605ae98f.8a9998","op1":"true","op2":"0","op1type":"bool","op2type":"str","duration":"0","extend":false,"units":"ms","reset":"","bytopic":"all","name":"Close & block","x":560,"y":180,"wires":[["2603c373.b06f0c"]]},{"id":"1936c958.eeea77","type":"change","z":"605ae98f.8a9998","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":200,"wires":[["fcc1dd3e.6655c"]]},{"id":"f44e1823.867bc8","type":"switch","z":"8b99f8fe.7b27b8","name":"Guestmode?","property":"guestmode","propertyType":"global","rules":[{"t":"false"}],"checkall":"true","repair":true,"outputs":1,"x":410,"y":180,"wires":[["a4626cbe.2a6a4"]]},{"id":"a4626cbe.2a6a4","type":"switch","z":"8b99f8fe.7b27b8","name":"!vacation","property":"Mode","propertyType":"global","rules":[{"t":"neq","v":"vacation","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":580,"y":180,"wires":[["e2460a6c.579118"]]},{"id":"77d1d4b3.4641ec","type":"time-range-switch","z":"8b99f8fe.7b27b8","name":"","lat":"58.851468","lon":"5.748852","startTime":"08:00","endTime":"21:00","startOffset":0,"endOffset":0,"x":1890,"y":280,"wires":[["accd6d3d.10c09"],[]]},{"id":"accd6d3d.10c09","type":"trigger","z":"8b99f8fe.7b27b8","op1":"true","op2":"","op1type":"bool","op2type":"nul","duration":"6","extend":false,"units":"hr","reset":"","bytopic":"all","name":"","x":2050,"y":280,"wires":[["8ea3f755.e68d88"]]},{"id":"aeb922d5.4c923","type":"site","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","name":"Hegglunds","x":160,"y":140,"wires":[["a76ee99e.e4d718"]]},{"id":"a76ee99e.e4d718","type":"json","z":"e3737c94.fd59f","name":"","property":"payload","action":"","pretty":false,"x":310,"y":140,"wires":[["b5e80927.5f5348","c45627f1.7688b8"]]},{"id":"84ab604.32a85a","type":"change","z":"e3737c94.fd59f","name":"","rules":[{"t":"set","p":"Mode","pt":"global","to":"payload.site.mode","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1120,"y":60,"wires":[["47e242b5.0edd6c"]]},{"id":"39dd072e.b84138","type":"switch","z":"e3737c94.fd59f","name":"","property":"Mode","propertyType":"global","rules":[{"t":"eq","v":"sleep","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":970,"y":60,"wires":[["84ab604.32a85a"],["84ab604.32a85a"]]},{"id":"8e07c57f.92d158","type":"rbe","z":"e3737c94.fd59f","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload.site.mode","x":830,"y":60,"wires":[["39dd072e.b84138"]]},{"id":"77d4a580.a4a38c","type":"function","z":"e3737c94.fd59f","name":"","func":"\n\nif(typeof  msg.payload.site !== \"undefined\")\n{\n    var Mode = msg.payload.site.mode\n return msg; \n} \n\nif(typeof  msg.payload.devices[0].functionality !== \"undefined\" && msg.payload.devices[0].functionality !== null )\n{\n \n    if (msg.payload.devices[0].functionality == \"lighting\") {\n        var Light = {};\n        Light.name = msg.payload.devices[0].name;\n        Light.power = msg.payload.devices[0].power;\n        Light.Room = msg.payload.devices[0].room;\n        Light.id = msg.payload.devices[0].id;\n       return [null,Light];  \n    }\n     if (msg.payload.devices[0].functionality == \"heating\") {\n        var Heat = {};\n        Heat.name = msg.payload.devices[0].name;\n        Heat.power = msg.payload.devices[0].power;\n        Heat.Room = msg.payload.devices[0].room;\n        Heat.id = msg.payload.devices[0].id;\n       return [null,null,Light];  \n    }\n \n} else if (msg.payload.devices[0].functionality === null){\n   \n    var mvmnt = {};\n        mvmnt.name = msg.payload.devices[0].name;\n        mvmnt.topic = mvmnt.name;\n        mvmnt.temperature = msg.payload.devices[0].temperature;\n        mvmnt.room = msg.payload.devices[0].room;\n        mvmnt.id = msg.payload.devices[0].id;\n        mvmnt.illuminance = msg.payload.devices[0].illuminance;\n        mvmnt.presence = msg.payload.devices[0].presence;\n        \n    return [null,null,null,mvmnt];  \n}\n\n  \n","outputs":4,"noerr":0,"x":670,"y":140,"wires":[["8e07c57f.92d158"],["8ad3e3c1.ae8ea"],["f2e0b439.cfe148"],["8d3b028a.588a3","15614be5.000534"]],"outputLabels":["Mode","Light","Heat","Movement"]},{"id":"47e242b5.0edd6c","type":"link out","z":"e3737c94.fd59f","name":"Mode Out","links":["5b63eaae.4cbcf4"],"x":1275,"y":60,"wires":[]},{"id":"8ad3e3c1.ae8ea","type":"link out","z":"e3737c94.fd59f","name":"Light_OUT","links":["babcae54.9d1a9"],"x":795,"y":120,"wires":[]},{"id":"babcae54.9d1a9","type":"link in","z":"1c11632f.f206fd","name":"Light IN","links":["8ad3e3c1.ae8ea"],"x":295,"y":1200,"wires":[["598481d4.859ad"]]},{"id":"598481d4.859ad","type":"switch","z":"1c11632f.f206fd","name":"","property":"name","propertyType":"msg","rules":[{"t":"eq","v":"Gangen","vt":"str"},{"t":"eq","v":"Kjøkken","vt":"str"},{"t":"eq","v":"Stue","vt":"str"},{"t":"eq","v":"Kontor: Lys","vt":"str"},{"t":"eq","v":"Kjeller Gang","vt":"str"},{"t":"eq","v":"Karina","vt":"str"},{"t":"eq","v":"Closet","vt":"str"},{"t":"eq","v":"Vaskerom: Lys","vt":"str"}],"checkall":"false","repair":true,"outputs":8,"x":490,"y":1200,"wires":[["66d9f1c.785941"],["66d9f1c.785941"],["66d9f1c.785941"],["66d9f1c.785941"],["79007779.8a0088"],["79007779.8a0088"],["79007779.8a0088"],["79007779.8a0088"]]},{"id":"7422f190.1aacf","type":"change-device","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","device":"11","device_id":"11","name":"Stue","x":1090,"y":480,"wires":[]},{"id":"ae05daf4.f22088","type":"change-device","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","device":"10","device_id":"10","name":"Kjøkken","x":1100,"y":520,"wires":[]},{"id":"57f7d91c.4946d8","type":"change-device","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","device":"17","device_id":"17","name":"Kjeller Gang","x":1110,"y":560,"wires":[]},{"id":"a60ec8c0.5360a8","type":"change-device","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","device":"15","device_id":"15","name":"Vaskerom: Lys","x":1120,"y":600,"wires":[]},{"id":"9d11c4da.344988","type":"change-device","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","device":"9","device_id":"9","name":"Closet","x":1090,"y":640,"wires":[]},{"id":"472600f9.2afc6","type":"change-device","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","device":"20","device_id":"20","name":"Karina ","x":1090,"y":680,"wires":[]},{"id":"78b65f45.8b367","type":"change-device","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","device":"5","device_id":"5","name":"Kontor: Lys","x":1110,"y":760,"wires":[]},{"id":"3de67605.ae865a","type":"change-device","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","device":"21","device_id":"21","name":"Gangen","x":1100,"y":720,"wires":[]},{"id":"4bc3c84.d3b2838","type":"switch","z":"e3737c94.fd59f","name":"FH:What Light","property":"payload.name","propertyType":"msg","rules":[{"t":"eq","v":"Stue","vt":"str"},{"t":"eq","v":"Kjøkken","vt":"str"},{"t":"eq","v":"Kjeller Gang","vt":"str"},{"t":"eq","v":"Vaskerom: Lys","vt":"str"},{"t":"eq","v":"Closet","vt":"str"},{"t":"eq","v":"Karina ","vt":"str"},{"t":"eq","v":"Gangen","vt":"str"},{"t":"eq","v":"Kontor: Lys","vt":"str"}],"checkall":"false","repair":false,"outputs":8,"x":840,"y":600,"wires":[["7422f190.1aacf"],["ae05daf4.f22088"],["57f7d91c.4946d8"],["a60ec8c0.5360a8"],["9d11c4da.344988"],["472600f9.2afc6"],["3de67605.ae865a"],["78b65f45.8b367"]]},{"id":"aebee55b.78c578","type":"comment","z":"e3737c94.fd59f","name":"Status ","info":"","x":130,"y":80,"wires":[]},{"id":"84619273.5b4a6","type":"comment","z":"e3737c94.fd59f","name":"Lights","info":"","x":1070,"y":440,"wires":[]},{"id":"93258667.8e8568","type":"link in","z":"e3737c94.fd59f","name":"Lights","links":["bb47679e.49ecb8"],"x":600,"y":600,"wires":[["4bc3c84.d3b2838"]]},{"id":"bb47679e.49ecb8","type":"link out","z":"1c11632f.f206fd","name":"Lights_Out","links":["93258667.8e8568"],"x":1955,"y":1200,"wires":[]},{"id":"bb42f486.70c538","type":"comment","z":"1c11632f.f206fd","name":"Phillips Hue","info":"","x":250,"y":1000,"wires":[]},{"id":"3fe65b32.abf894","type":"comment","z":"1c11632f.f206fd","name":"Futurehome","info":"","x":250,"y":1160,"wires":[]},{"id":"3224de96.1f5772","type":"comment","z":"1c11632f.f206fd","name":"Deconz","info":"","x":230,"y":1260,"wires":[]},{"id":"316049d.5ab63b6","type":"comment","z":"1c11632f.f206fd","name":"FloorPlan","info":"","x":180,"y":940,"wires":[]},{"id":"128705ae.2e87ba","type":"comment","z":"1c11632f.f206fd","name":"Status / INFO","info":"","x":150,"y":40,"wires":[]},{"id":"1ecef1db.323e0e","type":"ui_switch","z":"1c11632f.f206fd","name":"Status","label":"{{label}}","tooltip":"","group":"56a8be2a.9b9eb","order":1,"width":0,"height":0,"passthru":false,"decouple":"true","topic":"","style":"","onvalue":"home","onvalueType":"str","onicon":"fa-home","oncolor":"Green","offvalue":"away","offvalueType":"str","officon":"fa-sign-out","offcolor":"red","x":730,"y":120,"wires":[[]]},{"id":"f679bcb.a33044","type":"function","z":"1c11632f.f206fd","name":"Convert Data","func":"     msg.label = global.get(\"Mode\");\n     msg.payload = global.get(\"Mode\");\n \nreturn msg;\n","outputs":1,"noerr":0,"x":490,"y":120,"wires":[["1ecef1db.323e0e"]]},{"id":"8456ad2c.7b492","type":"link in","z":"1c11632f.f206fd","name":"","links":["247260f.c82dca","fc4fe81e.444628"],"x":175,"y":120,"wires":[["f679bcb.a33044"]]},{"id":"e45c34de.f632c8","type":"ui_switch","z":"1c11632f.f206fd","name":"heggland","label":"Øivind","tooltip":"","group":"56a8be2a.9b9eb","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"fa-user","oncolor":"Green","offvalue":"false","offvalueType":"bool","officon":"fa-user","offcolor":"orange","x":300,"y":160,"wires":[["b670eaa0.8e6998"]]},{"id":"741be682.621ef8","type":"ui_switch","z":"1c11632f.f206fd","name":"karina","label":"Karina","tooltip":"","group":"56a8be2a.9b9eb","order":1,"width":0,"height":0,"passthru":false,"decouple":"true","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"fa-user","oncolor":"Green","offvalue":"false","offvalueType":"bool","officon":"fa-user","offcolor":"orange","x":290,"y":200,"wires":[["b670eaa0.8e6998"]]},{"id":"d871d736.d19838","type":"link in","z":"1c11632f.f206fd","name":"","links":["772b0560.6b8bcc"],"x":175,"y":160,"wires":[["e45c34de.f632c8"]]},{"id":"84abded8.462ac","type":"link in","z":"1c11632f.f206fd","name":"","links":["47763aff.5ff334"],"x":175,"y":200,"wires":[["741be682.621ef8"]]},{"id":"19836afb.acbac5","type":"link out","z":"1c11632f.f206fd","name":"Person Out","links":["e3ae9576.18be48"],"x":695,"y":180,"wires":[]},{"id":"f530a672.6d7088","type":"mode","z":"e3737c94.fd59f","user":"3fb4f73e.f3cd38","name":"Home mode","mode":"home","x":330,"y":340,"wires":[]},{"id":"3072aa8d.fc3b66","type":"link in","z":"e3737c94.fd59f","name":"Mode","links":["247260f.c82dca","fc4fe81e.444628","c9b7d9c6.2c46e8"],"x":135,"y":340,"wires":[["f530a672.6d7088"]]},{"id":"80fca135.106b7","type":"comment","z":"e3737c94.fd59f","name":"Change Mode","info":"","x":150,"y":300,"wires":[]},{"id":"820037b0.c8cac8","type":"function","z":"1c11632f.f206fd","name":"Text: English","func":"msg.payload = \"Welcome Home Karina\";\nmsg.emitVolume = 50;\nreturn msg;","outputs":1,"noerr":0,"x":1590,"y":320,"wires":[[]]},{"id":"f4fa0e6f.b6cf2","type":"function","z":"1c11632f.f206fd","name":"Text: Norsk","func":"msg.payload = \"Velkommen Hjem Karina\";\nmsg.emitVolume = 50;\nreturn msg;","outputs":1,"noerr":0,"x":1590,"y":360,"wires":[[]]},{"id":"abeca5ba.816198","type":"function","z":"1c11632f.f206fd","name":"Text: Russisk","func":"msg.payload = \"Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð´Ð¾Ð¼Ð¾Ð¹ ÐšÐ°Ñ€Ð¸Ð½Ð°\";\nmsg.emitVolume = 50;\nreturn msg;","outputs":1,"noerr":0,"x":1590,"y":400,"wires":[[]]},{"id":"d1068875.e54d18","type":"function","z":"8b99f8fe.7b27b8","name":"Sleep","func":"msg.payload = {\"mode\":\"sleep\"};\nglobal.set(\"Mode\", \"sleep\")\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":520,"wires":[["c9b7d9c6.2c46e8"]]},{"id":"c9b7d9c6.2c46e8","type":"link out","z":"8b99f8fe.7b27b8","name":"","links":["3072aa8d.fc3b66"],"x":975,"y":520,"wires":[]},{"id":"52999902.dc1b78","type":"comment","z":"8b99f8fe.7b27b8","name":"Set Sleep status","info":"","x":140,"y":400,"wires":[]},{"id":"b670eaa0.8e6998","type":"change","z":"1c11632f.f206fd","name":"","rules":[{"t":"change","p":"topic","pt":"msg","from":"presence/","fromt":"str","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":180,"wires":[["19836afb.acbac5"]]},{"id":"b5e80927.5f5348","type":"debug","z":"e3737c94.fd59f","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.devices[0]","targetType":"msg","x":400,"y":280,"wires":[]},{"id":"f2e0b439.cfe148","type":"link out","z":"e3737c94.fd59f","name":"Heating","links":[],"x":795,"y":160,"wires":[]},{"id":"d4cd1de.82711e","type":"link out","z":"e3737c94.fd59f","name":"Movement oppe","links":["5483e66f.781f18"],"x":935,"y":180,"wires":[]},{"id":"5483e66f.781f18","type":"link in","z":"1c11632f.f206fd","name":"Movement oppe","links":["aa1c2f8c.0391d","d4cd1de.82711e"],"x":175,"y":300,"wires":[["978bb00a.e7a5e"]]},{"id":"8d3b028a.588a3","type":"switch","z":"e3737c94.fd59f","name":"","property":"room","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"num"},{"t":"eq","v":"9","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":810,"y":200,"wires":[["d4cd1de.82711e"],["b951c7f1.f25428"]]},{"id":"6a44834f.a649fc","type":"ui_switch","z":"1c11632f.f206fd","name":"Bevegelse oppe","label":"bevegelse oppe","tooltip":"","group":"56a8be2a.9b9eb","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"remove_red_eye","oncolor":"orange","offvalue":"false","offvalueType":"bool","officon":"remove_red_eye","offcolor":"grey","x":820,"y":280,"wires":[["ce10d658.9a55e8"]]},{"id":"15614be5.000534","type":"debug","z":"e3737c94.fd59f","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":800,"y":240,"wires":[]},{"id":"978bb00a.e7a5e","type":"change","z":"1c11632f.f206fd","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presence","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":300,"wires":[["4fa54eb6.115c3","cb7cc1c2.b8862","96c7928d.91306"]]},{"id":"a575a24f.3f6a","type":"link in","z":"1c11632f.f206fd","name":"Movement Nede","links":["b951c7f1.f25428"],"x":175,"y":440,"wires":[["b747bde7.12247"]]},{"id":"e1568b9c.db9628","type":"ui_switch","z":"1c11632f.f206fd","name":"Bevegelse nede","label":"bevegelse nede","tooltip":"","group":"56a8be2a.9b9eb","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"remove_red_eye","oncolor":"orange","offvalue":"false","offvalueType":"bool","officon":"remove_red_eye","offcolor":"grey","x":820,"y":440,"wires":[["f6e7b4ae.e67e68"]]},{"id":"b747bde7.12247","type":"change","z":"1c11632f.f206fd","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"presence","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":440,"wires":[["6f041031.c9256"]]},{"id":"b951c7f1.f25428","type":"link out","z":"e3737c94.fd59f","name":"Movement Nede","links":["a575a24f.3f6a"],"x":940,"y":220,"wires":[]},{"id":"f908c91a.32a168","type":"deconz-input","z":"26b1c83f.906118","name":"Bevegelse Trapp","server":"12895ae7.9c6bf5","device":"ec:1b:bd:ff:fe:3f:85:d8-01-0006","device_name":"TRÅDFRI Motion sensor : ZHAPresence","topic":"","state":0,"output":"always","outputAtStartup":true,"x":180,"y":100,"wires":[["955fc69.aaf7638"],[]]},{"id":"3cff4b55.0b08a4","type":"function","z":"26b1c83f.906118","name":"","func":"let status = flow.get(\"status\") || false;\nlet presense = msg.payload.devices.presence;\nif (presense === status){\n    return null;\n}\nflow.set(\"status\", presense) \nreturn msg;","outputs":1,"noerr":0,"x":950,"y":100,"wires":[[]]},{"id":"955fc69.aaf7638","type":"function","z":"26b1c83f.906118","name":"Convert","func":"  var mvmnt = {};\n        mvmnt.name = \"Trapp\";\n        mvmnt.topic = mvmnt.name;\n       // mvmnt.temperature = msg.payload.devices[0].temperature;\n        mvmnt.room = 2;\n       // mvmnt.id = msg.payload.devices[0].id;\n       // mvmnt.illuminance = msg.payload.devices[0].illuminance;\n        mvmnt.presence = msg.payload.presence;\n        mvmnt.dark = msg.payload.dark;\nreturn mvmnt;","outputs":1,"noerr":0,"x":540,"y":100,"wires":[["aa1c2f8c.0391d"]]},{"id":"aa1c2f8c.0391d","type":"link out","z":"26b1c83f.906118","name":"Bevegelse Trapp","links":["5483e66f.781f18"],"x":700,"y":100,"wires":[]},{"id":"4fa54eb6.115c3","type":"and-gate","z":"1c11632f.f206fd","name":"False","rules":[{"t":"false","propertyType":"msg","property":"payload","topic":"Trapp"},{"t":"false","propertyType":"msg","property":"payload","topic":"Kitchen: eye"}],"outputTopic":"false","gateType":"and","emitOnlyIfTrue":true,"x":490,"y":320,"wires":[["c7c0b2b.dd2cd5"]]},{"id":"cb7cc1c2.b8862","type":"switch","z":"1c11632f.f206fd","name":"True","property":"presence","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":490,"y":280,"wires":[["6a44834f.a649fc"]]},{"id":"57ba7f31.9cd56","type":"ui_button","z":"1c11632f.f206fd","name":"Off","group":"efd0ae.1a06bf5","order":1,"width":0,"height":0,"passthru":false,"label":"OFF","tooltip":"","color":"","bgcolor":"","icon":"","payload":"false","payloadType":"bool","topic":"yes","x":410,"y":620,"wires":[["e47aed6e.91552"]]},{"id":"ed7a3ab.c4f31c8","type":"ui_button","z":"1c11632f.f206fd","name":"On","group":"efd0ae.1a06bf5","order":3,"width":0,"height":0,"passthru":false,"label":"ON","tooltip":"","color":"","bgcolor":"","icon":"","payload":"true","payloadType":"bool","topic":"yes","x":410,"y":580,"wires":[["e47aed6e.91552"]]},{"id":"d2142d17.21a64","type":"ui_button","z":"1c11632f.f206fd","name":"Auto","group":"efd0ae.1a06bf5","order":2,"width":0,"height":0,"passthru":true,"label":"AUTO","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"date","topic":"no","x":410,"y":660,"wires":[["22d50ecc.987be2"]]},{"id":"7f7ea747.fb10a8","type":"inject","z":"1c11632f.f206fd","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"2","x":230,"y":680,"wires":[["d2142d17.21a64","80ef18fb.d3bc48"]]},{"id":"c45627f1.7688b8","type":"switch","z":"e3737c94.fd59f","name":"","property":"guestmode","propertyType":"global","rules":[{"t":"false"}],"checkall":"true","repair":true,"outputs":1,"x":490,"y":140,"wires":[["77d4a580.a4a38c"]]},{"id":"22d50ecc.987be2","type":"change","z":"1c11632f.f206fd","name":"Set BlockMovementU","rules":[{"t":"set","p":"BlockMovementU","pt":"flow","to":"topic","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":660,"wires":[["117c7706.e9e429"]]},{"id":"ce10d658.9a55e8","type":"switch","z":"1c11632f.f206fd","name":"BlockMovementU","property":"BlockMovementU","propertyType":"flow","rules":[{"t":"eq","v":"no","vt":"str"}],"checkall":"false","repair":true,"outputs":1,"x":1030,"y":280,"wires":[["555dd900.71afd8"]]},{"id":"f6e7b4ae.e67e68","type":"switch","z":"1c11632f.f206fd","name":"BlockMovementD","property":"BlockMovementD","propertyType":"flow","rules":[{"t":"eq","v":"no","vt":"str"}],"checkall":"true","repair":true,"outputs":1,"x":1030,"y":440,"wires":[["8b48cdb9.93e75"]]},{"id":"71871582.621a2c","type":"ui_button","z":"1c11632f.f206fd","name":"Off","group":"ca3eef.3da5b11","order":1,"width":0,"height":0,"passthru":true,"label":"OFF","tooltip":"","color":"","bgcolor":"","icon":"","payload":"false","payloadType":"bool","topic":"yes","x":410,"y":760,"wires":[["3e3d7f92.ce6b7"]]},{"id":"8cc2264a.376548","type":"ui_button","z":"1c11632f.f206fd","name":"On","group":"ca3eef.3da5b11","order":3,"width":0,"height":0,"passthru":true,"label":"ON","tooltip":"","color":"","bgcolor":"","icon":"","payload":"true","payloadType":"bool","topic":"yes","x":410,"y":800,"wires":[["3e3d7f92.ce6b7"]]},{"id":"80ef18fb.d3bc48","type":"ui_button","z":"1c11632f.f206fd","name":"Auto","group":"ca3eef.3da5b11","order":2,"width":0,"height":0,"passthru":true,"label":"AUTO","tooltip":"","color":"","bgcolor":"","icon":"","payload":"false","payloadType":"bool","topic":"no","x":410,"y":720,"wires":[["a5e9a69.b159d58"]]},{"id":"3e3d7f92.ce6b7","type":"change","z":"1c11632f.f206fd","name":"Set BlockMovementD","rules":[{"t":"set","p":"BlockMovementD","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"room","pt":"msg","to":"basement","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":780,"wires":[["c1c45106.da7ab"]]},{"id":"c7c0b2b.dd2cd5","type":"change","z":"1c11632f.f206fd","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":320,"wires":[["6a44834f.a649fc"]]},{"id":"99e025be.972808","type":"light-scheduler-filter","z":"5a99bc39.0df864","settings":"d2f48d8d.a9582","events":"[{\"start\":{\"dow\":1,\"mod\":420},\"end\":{\"dow\":1,\"mod\":480}},{\"start\":{\"dow\":1,\"mod\":960},\"end\":{\"dow\":1,\"mod\":1320}},{\"start\":{\"dow\":2,\"mod\":960},\"end\":{\"dow\":2,\"mod\":1320}},{\"start\":{\"dow\":3,\"mod\":960},\"end\":{\"dow\":3,\"mod\":1320}},{\"start\":{\"dow\":4,\"mod\":960},\"end\":{\"dow\":4,\"mod\":1320}},{\"start\":{\"dow\":5,\"mod\":960},\"end\":{\"dow\":5,\"mod\":1320}},{\"start\":{\"dow\":6,\"mod\":480},\"end\":{\"dow\":6,\"mod\":1380}},{\"start\":{\"dow\":0,\"mod\":480},\"end\":{\"dow\":0,\"mod\":1320}},{\"start\":{\"dow\":2,\"mod\":420},\"end\":{\"dow\":2,\"mod\":480}},{\"start\":{\"dow\":3,\"mod\":420},\"end\":{\"dow\":3,\"mod\":480}},{\"start\":{\"dow\":4,\"mod\":420},\"end\":{\"dow\":4,\"mod\":480}},{\"start\":{\"dow\":5,\"mod\":420},\"end\":{\"dow\":5,\"mod\":480}}]","name":"","onlyWhenDark":true,"scheduleRndMax":0,"sunElevationThreshold":6,"sunShowElevationInStatus":false,"x":720,"y":220,"wires":[["8aada546.742878"],[]]},{"id":"de24db30.aa72a8","type":"switch","z":"5a99bc39.0df864","name":"At Home","property":"AtHome","propertyType":"global","rules":[{"t":"eq","v":"","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":680,"y":180,"wires":[["8aada546.742878"]]},{"id":"54bf5eae.c8ef3","type":"switch","z":"e3737c94.fd59f","name":"","property":"room","propertyType":"msg","rules":[{"t":"eq","v":"upstairs","vt":"str"},{"t":"eq","v":"basement","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":870,"y":400,"wires":[["7422f190.1aacf","ae05daf4.f22088","d050ec84.7d3fe"],["57f7d91c.4946d8"]]},{"id":"64bc6db.9a90194","type":"link in","z":"e3737c94.fd59f","name":"Room","links":["d7ddc374.33edb","c1c45106.da7ab","117c7706.e9e429","c1069822.fa4578"],"x":400,"y":460,"wires":[["5da7627f.49119c"]]},{"id":"d050ec84.7d3fe","type":"debug","z":"e3737c94.fd59f","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1070,"y":380,"wires":[]},{"id":"5da7627f.49119c","type":"function","z":"e3737c94.fd59f","name":"","func":"var msg2 = {payload:{power: msg.power === true ? \"on\" : \"off\" }};\nmsg2.room = msg.room;\nreturn msg2;","outputs":1,"noerr":0,"x":510,"y":460,"wires":[["54bf5eae.c8ef3"]]},{"id":"8aada546.742878","type":"change","z":"5a99bc39.0df864","name":"ON","rules":[{"t":"set","p":"power","pt":"msg","to":"true","tot":"bool"},{"t":"set","p":"room","pt":"msg","to":"Floor","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1030,"y":260,"wires":[[]]},{"id":"1329ab14.42ed25","type":"change","z":"5a99bc39.0df864","name":"OFF","rules":[{"t":"set","p":"power","pt":"msg","to":"false","tot":"bool"},{"t":"set","p":"room","pt":"msg","to":"Floor","tot":"env"}],"action":"","property":"","from":"","to":"","reg":false,"x":1030,"y":300,"wires":[[]]},{"id":"8a6789ac.c237d8","type":"trigger","z":"5a99bc39.0df864","op1":"","op2":"","op1type":"nul","op2type":"payl","duration":"15","extend":true,"units":"min","reset":"","bytopic":"all","name":"","x":690,"y":300,"wires":[["1329ab14.42ed25"]]},{"id":"555dd900.71afd8","type":"subflow:5a99bc39.0df864","z":"1c11632f.f206fd","name":"Kjøkken/Stue","env":[],"x":1250,"y":280,"wires":[["d7ddc374.33edb"]]},{"id":"d7ddc374.33edb","type":"link out","z":"1c11632f.f206fd","name":"","links":["64bc6db.9a90194"],"x":1415,"y":340,"wires":[]},{"id":"96c7928d.91306","type":"link out","z":"1c11632f.f206fd","name":"","links":["93ef5d70.0130e"],"x":455,"y":240,"wires":[]},{"id":"8b48cdb9.93e75","type":"subflow:5a99bc39.0df864","z":"1c11632f.f206fd","name":"Basement","env":[{"name":"Floor","value":"basement","type":"str"}],"x":1240,"y":440,"wires":[["d7ddc374.33edb"]]},{"id":"67f4df0c.005ff","type":"status","z":"5a99bc39.0df864","name":"","scope":["99e025be.972808","8a6789ac.c237d8"],"x":680,"y":100,"wires":[[]]},{"id":"6f041031.c9256","type":"switch","z":"1c11632f.f206fd","name":"True","property":"presence","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":490,"y":400,"wires":[["e1568b9c.db9628"],["55288eb2.0c6d"]]},{"id":"55288eb2.0c6d","type":"change","z":"1c11632f.f206fd","name":"False","rules":[{"t":"set","p":"topic","pt":"msg","to":"false","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":440,"wires":[["e1568b9c.db9628"]]},{"id":"92cb7ac8.418b68","type":"function","z":"5a99bc39.0df864","name":"Set illuminance","func":"if(typeof  msg.illuminance !== \"undefined\" && msg.illuminance !== null )\n{\n    flow.set(\"illuminance\", msg.illuminance);\n}\n\nif (msg.topic === 'reset') {\n     msg.reset = true;\n     return [null, msg];\n}\n\nif (msg.topic === 'false') {\n \n     return [null, msg];\n}\n    \n\nif(flow.get(\"illuminance\") <= 230){\n    flow.set(\"lights\", \"YES\")\n       msg.reset = true;\n    return [msg, msg];\n}else {\n     flow.set(\"lights\", \"NO\")\n}\n\n","outputs":2,"noerr":0,"x":420,"y":220,"wires":[["99e025be.972808","de24db30.aa72a8"],["8a6789ac.c237d8"]],"outputLabels":["True","False"]},{"id":"ffb91c4a.2fcd3","type":"link in","z":"1c11632f.f206fd","name":"Upstairs Reset","links":["117c7706.e9e429","c1069822.fa4578"],"x":955,"y":320,"wires":[["a14f5f10.49cf4"]]},{"id":"4ca4adb3.a95524","type":"link in","z":"1c11632f.f206fd","name":"Basement Reset","links":["c1c45106.da7ab"],"x":955,"y":400,"wires":[["ea152559.a8e148"]]},{"id":"ea152559.a8e148","type":"change","z":"1c11632f.f206fd","name":"Reset","rules":[{"t":"set","p":"topic","pt":"msg","to":"reset","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1070,"y":400,"wires":[["8b48cdb9.93e75"]]},{"id":"a14f5f10.49cf4","type":"change","z":"1c11632f.f206fd","name":"Reset","rules":[{"t":"set","p":"topic","pt":"msg","to":"reset","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1070,"y":320,"wires":[["555dd900.71afd8"]]},{"id":"117c7706.e9e429","type":"link out","z":"1c11632f.f206fd","name":"Upstairs Reset","links":["64bc6db.9a90194","ffb91c4a.2fcd3"],"x":795,"y":620,"wires":[]},{"id":"c1c45106.da7ab","type":"link out","z":"1c11632f.f206fd","name":"Basemet Reset","links":["4ca4adb3.a95524","64bc6db.9a90194"],"x":795,"y":740,"wires":[]},{"id":"e47aed6e.91552","type":"change","z":"1c11632f.f206fd","name":"Set BlockMovementU","rules":[{"t":"set","p":"BlockMovementU","pt":"flow","to":"topic","tot":"msg"},{"t":"set","p":"room","pt":"msg","to":"upstairs","tot":"str"},{"t":"set","p":"power","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":580,"wires":[["117c7706.e9e429"]]},{"id":"a5e9a69.b159d58","type":"change","z":"1c11632f.f206fd","name":"Set BlockMovementU","rules":[{"t":"set","p":"BlockMovementD","pt":"flow","to":"topic","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":720,"wires":[["c1c45106.da7ab"]]},{"id":"5516d3d1.7b5a5c","type":"debug","z":"1c11632f.f206fd","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":560,"y":1680,"wires":[]}]